var underscore=angular.module("underscore",[]);underscore.factory("_",["$window",function(a){return a._}]),angular.module("WsClient",["ngWebSocket","ngCookies","underscore"]).provider("wsClient",function(){var a=this,b="wss://api.scriptrapps.io/",c=null,d=null,e=null,f=null,g=null,h=100,i={},j={},k=0,l={},m=[];this.setQueueingInterval=function(a){h=a},this.setBaseUrl=function(a){b=a},this.setPublishChannel=function(a){c=a},this.setSubscribeChannel=function(a){console.log(a),d=a},this.getSubscribeChannel=function(){return d},this.setToken=function(a){e=a},this.setCookies=function(a,b){i[a]=b};var n=function(){f=b+(e?"/"+e:"")},o=function(a){return k+=1,k>1e4&&(k=0),k},p=function(a,b){return g+"-"+(b?b+"_"+a:a)},q=function(a,b){return b?b+"_"+a:a},r=function(a,b){return b?b+"_"+a:a};this.$get=["$websocket","$cookies","$q","$rootScope","_","$interval","$http","httpClient",function(b,i,k,s,t,u,v,w){i.get("token")&&this.setToken(i.get("token")),i.get("user")&&this.setCookies("user",i.get("user")),i.get("lang")&&this.setCookies("lang",i.get("lang")),n();var x=!1,y=null;u(function(){if(B.promise&&m.length>0){var a=m[0];if(w&&(w.renewToken().then(function(a,b){J(a),console.log("[wsProvider] Renewed token data initiated by wsClient: ",a)},function(a){1==a?console.log("[wsProvider] A renew token is in progress."):console.log("[wsProvider] No need to renew token.")}),w.isTokenAboutToExpire()||w.isRenewInProgress()||x))return void console.log("[wsProvider] Pause sending requests over socket. A renew token is in progress.");z.send(a),y=m.shift()}},h);var z=b(f),A={},B=k.defer(),C=k.defer(),D=k.defer(),E=k.defer();z.onOpen(function(){F(d)}),z.onMessage(function(a){try{var b=JSON.parse(a.data);console.log("Received message data from websocket: ",b),"connected."==b.result&&(g=b.id,B&&B.resolve()),"failure"==b.status&&"429"==b.statusCode&&(0==$("body").find(".alert-transport").length&&$("body").append('<div class="alert alert-danger alert-dismissable alert-transport" style="position: absolute; z-index: 1000; top: 0; width: 600px; left: 30%; text-align: center">You have reached you requests rate limit. For more info check the <a href="https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting" target="blank">documentation.</a><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button></div>'),console.error("You have reached your requests rate limit. For more info check the documentation. https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting")),A.data=b,H(b),I(b)}catch(b){console.log("Error when parsing message received over socket",a,b)}}),z.onClose(function(a){console.log("Socket on close ",a),D.resolve(a);var b=a.currentTarget.url,c=b.substring(b.lastIndexOf("/")+1,b.length);"4000"==a.code||"4010"==a.code?(console.log("Cookie token "+i.get("token")+" currentSocketToken "+c),i.get("token")==c||x?E.resolve(a):(J({token:i.get("token")}),y&&(m.unshift(y),y=null))):(console.log("Trying to reconnect closed socket."),z.reconnect())}),z.onError(function(a){console.log("Socket Error",a),C.resolve()});var F=function(a){if(a)if("string"==typeof a)z.send(JSON.stringify({method:"Subscribe",params:{channel:a}}));else if("Array"==a.constructor.name)for(var b=0;b<a.length;b++)z.send(JSON.stringify({method:"Subscribe",params:{channel:a[b]}}))},G=function(a){if(a)if("string"==typeof a)z.send(JSON.stringify({method:"Unsubscribe",params:{channel:a}}));else if("Array"==a.constructor.name)for(var b=0;b<a.length;b++)z.send(JSON.stringify({method:"Unscubscribe",params:{channel:a[b]}}))},H=function(a){var b=a.id,b=b.split(/-(.+)/)[1];b&&j.hasOwnProperty(b)?(console.log("Execute registered call back for received socket message.",j[b]),"failure"==a.status?s.$apply(j[b].cb.reject(a)):s.$apply(j[b].cb.resolve(a.result)),delete j[b]):console.log("No callbacks registerd for received socket message.")},I=function(a){var b=a.id;if(b&&l.hasOwnProperty("subscribeToAll")){console.log("Execute registered call back for received socket message.",l.subscribeToAll);for(var c=l.subscribeToAll,d=0;d<c.length;d++)c[d].cb(a.result)}else if(b&&l.hasOwnProperty(b)){console.log("Execute registered call back for received socket message.",l[b]);for(var c=l[b],d=0;d<c.length;d++)c[d].cb(a.result)}else console.log("No subscribers registerd for received socket message.")},J=function(b){x=!0,B=k.defer(),B.promise.then(function(){console.log("[updateTokenAndReconnect] token was renewed and soket reconnected."),x=!1}),a.setToken(b.token),n(),z.url=f,z.close()};return{getMessage:function(){return A},getStatus:function(){return z.readyState},subscribe:function(a,b,c){if(d){var b={time:new Date,cb:b};c&&(b.id=c),l[a]?l[a].push(b):l[a]=[b]}},unsubscribe:function(a,b,c){if(!a)return void console.log("prefix is mandatory to unsubscribe.");if(console.log("---",l[a]),d)if(!a||b||c){var e={};b&&(e.cb=b),c&&(e.id=c),l[a]=t.difference(l[a],t.where(l[a],e))}else l[a]=[];console.log("+++",l[a])},publish:function(a,b,d){var e=c;if(d&&(e=d),e){var f=k.defer(),g=o(),h=p(g,b);return j[h]={time:new Date,cb:f},a.id=h,console.log("Sending publish message  over socket.",a),m.push({method:"Publish",params:{channel:e,message:JSON.stringify(a)}}),f.promise}console.log("No channel is defined, message won't be sent.",a)},call:function(a,b,c){i.get("token")&&(e=i.get("token"));var d=k.defer(),f={method:a,params:{body:JSON.stringify(b)}},g=o(),h=r(g,c);return j[h]={time:new Date,cb:d},f.id=q(g,c),console.log("Sending call api request over socket.",f),m.push(f),d.promise},updateSubscriptionChannel:function(b){a.getSubscribeChannel()&&G(a.getSubscribeChannel()),a.setSubscribeChannel(b),F(b)},updatePublishingChannel:function(b){a.setPublishChannel(b)},closeSocket:function(a){a?z.close(a):z.close(!1)},updateTokenAndReconnect:function(){J({token:i.get("token")})},updateCookies:function(b,c){a.setCookies(b,c)},onReady:B.promise,onError:C.promise,onClose:D.promise,onInvalidAuthentication:E.promise}}]}),angular.module("HttpClient",["ngCookies"]).provider("httpClient",function(){var a="",b=null,c="",d="login/api/renewToken",f=null,g=15e5,h=!1,i={},j=this;this.setBaseUrl=function(b){a=b,console.log(a)},this.setToken=function(a){b=a,console.log(b)},this.setRenewTokenApi=function(a){a&&""!=a&&(d=a)},this.getRenewTokenApi=function(){return d},this.setTokenExpiry=function(a){f=a},this.setTokenRenewInterval=function(a){g=a},this.setCookies=function(a,b){i[a]=b};var k=function(b){c=a+"/"+b,console.log(c)},l=function(){var a=!1;if(f){var b=new Date(f),c=new Date;b.getTime()-c.getTime()<=g&&(a=!0)}return a};this.$get=["$cookies","$q","$http",function(a,d,f){var g=d.defer();a.get("token")&&(b=a.get("token")),a.get("tokenExpiry")&&this.setTokenExpiry(a.get("tokenExpiry")),a.get("user")&&this.setCookies("user",a.get("user")),a.get("lang")&&this.setCookies("lang",a.get("lang"));var m=function(a,b,c){return a&&a[b]?a[b]=c:(a||(a={}),a[b]=c),a};j._renewToken=function(){var e=d.defer();if(l()&&!h){var f={method:"GET"};h=!0,k(j.getRenewTokenApi()),f.url=c,b&&(f.headers=m(f.headers,"Authorization","Bearer "+b)),f.params={token:b};var g=d.defer();n(g,f).promise.then(function(b,c){h=!1;var d=new Date;d.setTime(d.getTime()+1e3*parseInt(b.expiry)),a.put("token",b.token,{path:"/",secure:!0,expires:d.toUTCString()}),a.put("tokenExpiry",d.toUTCString(),{path:"/",secure:!0,expires:d.toUTCString()}),i.user&&a.put("user",i.user,{path:"/",secure:!0,expires:d.toUTCString()}),i.lang&&a.put("lang",i.lang,{path:"/",secure:!0,expires:d.toUTCString()}),j.setToken(b.token),j.setTokenExpiry(d.toUTCString()),e.resolve(b,c)},function(a,b){h=!1,e.reject(a,b)})}else e.reject(h);return e.promise};var n=function(a,b){return f(b).then(function(b){if(b.data&&b.data.response){var c=b.data.response;"200"==c.metadata.statusCode&&"success"==c.metadata.status?c.result&&c.result.metadata?"success"==c.result.metadata.status?a.resolve(c.result.result,b):("INVALID_TOKEN"==c.result.metadata.errorCode&&g.resolve(e),a.reject(c.result.metadata,b)):a.resolve(c.result,b):("INVALID_TOKEN"==c.metadata.errorCode&&g.resolve(c.metadata),a.reject(c.metadata,b))}else console.debug("Not the excpected scriptr response format",b),a.resolve(b)},function(b){console.log("ERROR",b),"429"==b.status&&(0==$("body").find(".alert-transport").length&&$("body").append('<div class="alert alert-danger alert-dismissable alert-transport" style="position: absolute; z-index: 1000; top: 0; width: 600px; left: 30%; text-align: center">You have reached you requests rate limit. For more info check the <a href="https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting" target="blank">documentation.</a><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button></div>'),console.error("You have reached your requests rate limit. For more info check the documentation. https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting")),"400"==b.status&&b.data&&b.data.response&&b.data.response.metadata&&"INVALID_TOKEN"==b.data.response.metadata.errorCode&&g.resolve(b.data.response.metadata),b.data&&b.data.response&&b.data.response.metadata?a.reject(b.data.response.metadata):a.reject(b)}),a},o=function(e,f){a.get("token")&&(b=a.get("token")),a.get("tokenExpiry")&&j.setTokenExpiry(a.get("tokenExpiry"));var g=d.defer();return k(e),f.url=c,b&&(f.headers=m(f.headers,"Authorization","Bearer "+b)),g=n(g,f),j._renewToken().then(function(a,b){console.log("https renew token data: ",a)},function(a){1==a?console.log("A renew token is in progress."):console.log("No need to renew token.")}),g.promise};return{get:function(a,b){var c={method:"GET"};return c.params=b,o(a,c)},post:function(a,b,c,d){var e={method:"POST"};return e.data=b,c&&(e.headers=c),c&&c["Content-Type"]||(e.headers=m(e.headers,"Content-Type","application/json")),d&&(e.headers["Content-Type"]=void 0,e.transformRequest=angular.identity),o(a,e)},updateToken:function(a){j.setToken(a)},isTokenAboutToExpire:function(){return l()},isRenewInProgress:function(){return h},renewToken:function(){return j._renewToken()},updateCookies:function(a,b){j.setCookies(a,b)},onInvalidAuthentication:g.promise}}]}),angular.module("DataService",["ngRoute"]).provider("dataService",function(){var a=this;this._sendRequestApi=function(a,b,c,d,e,f){var g={},h=e.apiParams?e.apiParams:{};g=e.useWindowParams&&"true"==e.useWindowParams?angular.merge(h,d):angular.copy(h),"wss"==e.transport?c.onReady.then(function(){e.msgTag&&c.subscribe(e.msgTag,f,e.widgetId),e.api&&c.call(e.api,g,e.msgTag).then(function(a,b){f(a)},function(a){console.log("Reject wss call",a),f(a)})}):"https"==e.transport&&e.api&&("POST"==e.httpMethod?b.post(e.api,g).then(function(a,b){"function"==typeof f&&f(a)},function(a){"function"==typeof f&&f(a)}):b.get(e.api,g).then(function(a,b){f(a)},function(a){f(a),console.log("Reject http call",a)}))},this.$get=["$q","httpClient","wsClient","$routeParams",function(b,c,d,e){return{scriptrRequest:function(f,g){a._sendRequestApi(b,c,d,e,f,g)}}}]}),angular.module("Chart",["angular.morris","ComponentsCommon","DataService"]),angular.element(document).ready(function(){Morris.Line.prototype.resizeHandler=function(){clearTimeout(this.timeoutId);var a=this;return this.timeoutId=setTimeout(function(){a.el&&a.el.width()>0&&a.el.height()>0&&(a.raphael.setSize(a.el.width(),a.el.height()-8),a.redraw())},600),this},Morris.Donut.prototype.resizeHandler=function(){return this.timeoutId=null,this.el&&this.el.width()>0&&this.el.height()>0?(this.raphael.setSize(this.el.width(),this.el.height()),this.redraw()):null},Morris.Donut.prototype.setData=function(a){var b;return this.data=a,this.values=function(){var a,c,d,e;for(d=this.data,e=[],a=0,c=d.length;a<c;a++)b=d[a],e.push(parseFloat(b.value));return e}.call(this),this.el&&this.el.width()>0&&this.el.height()>0?this.redraw():null}}),angular.module("Chart").component("scriptrChart",{bindings:{onLoad:"&onLoad",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",delta:"<?",resize:"<?",icon:"@",data:"<?",type:"@",xkey:"@",yconfig:"<?",ykeys:"<?",stacked:"<?",labels:"<?",colors:"<?",lineWidth:"@",pointSize:"@",pointFillColors:"@",pointStrokeColors:"@",ymax:"@",ymin:"@",smooth:"@",hideHover:"@",parseTime:"<?",units:"@",postUnits:"@",preUnits:"@",barSize:"<?",barSizeRatio:"<?",barGap:"<?",barOpacity:"<?",barRadius:"<?",xlabels:"@",xlabelAngle:"<?",goals:"@",goalStrokeWidth:"@",goalLineColors:"@",goalsconfig:"<?",events:"@",eventStrokeWidth:"@",eventsLineColors:"@",eventsconfig:"<?",dataFailureMessage:"@",stalledDataMessage:"@",invalidData:"@",continuousLine:"@",axes:"@",grid:"@",gridTextColor:"@",gridTextSize:"@",gridTextFamily:"@",gridTextWeight:"@",fillOpacity:"@",resize:"@",behaveLikeLine:"@",labelColor:"@",donutFormatter:"&",backgroundColor:"@",hoverCallback:"&?",dateFormat:"&?",xlabelFormat:"&?",ylabelFormat:"&?",xdateMomentFormat:"@",legendDateMomentFormat:"@",timeZone:"@",showLegend:"@",legendType:"@",horizontal:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/chart/chart.html",controller:["$translate","httpClient","$rootScope","wsClient","$scope","$element","$timeout","$window","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.$onInit=function(){if(a.use(c.lang),this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/"+this.type+"-chart-bg.svg",this.hasData=!!(this.datas&&this.datas.length>0),k.yconfig){var b=[],d=[],f=[];k.yconfig.forEach(function(a){b.push(a.key),d.push(a.label),f.push(a.color)}),k.ykeys=b,k.labels=d,k.colors=f}if(k.goalsconfig&&(k.goals=[],k.goalLineColors=[],k.goalsconfig.forEach(function(a){k.goals.push(a.goal),k.goalLineColors.push(a.lineColor)})),k.eventsconfig&&(k.events=[],k.eventLineColors=[],k.eventsconfig.forEach(function(a){k.events.push(a.event),k.eventLineColors.push(a.lineColor)})),this.colors=this.colors?this.colors:["#CC5464","#FCC717","#38B9D6","#1DBC68","#E90088"],this.stacked=!!this.stacked&&this.stacked,this.resize=!this.resize||this.resize,this.labelColor=this.labelColor?this.labelColor:"#eee",this.backgroundColor=this.backgroundColor?this.backgroundColor:"#fff",this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.showLegend=this.showLegend?this.showLegend:"true",this.legendType=this.legendType?this.legendType:"hover",this.horizontal=this.horizontal?this.horizontal:"false",this.hoverCallback&&(this.onHoverCallback=function(a,b,c,d){return k.hoverCallback()(a,b,c,d)}),this.showLegend&&"true"==this.showLegend)if(this.legendType&&"right"==this.legendType){this._hideHover="auto",this.ref=e.$id,this.legendStructure=[];for(var g=0;g<this.ykeys.length;g++){var h={};h.key=this.ykeys[g],this.labels&&this.labels[g]?h.label=this.labels[g]:h.label=this.ykeys[g],this.colors&&this.colors[g]&&(h.color=this.colors[g]),this.legendStructure.push(h)}this.onHoverCallback=function(a,b,c,d){k.datas&&(d&&d[e.$ctrl.xkey]&&(k.parseTime?e.$ctrl.legendDate=k.dateFormat(d[k.xkey]):e.$ctrl.legendDate=d[k.xkey]),_.mapObject(d,function(a,b){var d=_.findIndex(e.$ctrl.legendStructure,{key:"donut"!=k.type?b:a});if(-1!=d){e.$ctrl.legendStructure[d].value="donut"==k.type?c:a;var f=document.getElementById("value_"+d+"_"+k.ref);f&&(f.innerHTML="donut"==k.type?c:a)}}))}}else this.legendType&&"hover"==this.legendType&&(this._hideHover=this.hideHover?this.hideHover:"auto");else this._hideHover="always";this.dateFormat&&(this.onDateFormat=function(a){return k.dateFormat()(a)}),this.xlabelFormat&&(this.onXlabelFormat=function(a){return k.xlabelFormat()(a)}),this.ylabelFormat&&(this.onYlabelFormat=function(a){return k.ylabelFormat()(a)}),this.parseTime&&(this.onDateFormat=function(a){try{return k.timeZone?moment(a).utcOffset(k.timeZone).format(k.xdateMomentFormat):moment(a).format(k.xdateMomentFormat)}catch(b){return console.error("Invalid date format passed",k.xdateMomentFormat),k.timeZone?moment(a).utcOffset(k.timeZone).format("DD-MM-YYYY HH:mm:ss"):moment(a).format("DD-MM-YYYY HH:mm:ss")}},this.onXlabelFormat=function(a){try{return k.timeZone?moment(a).utcOffset(k.timeZone).format(k.xdateMomentFormat):moment(a).format(k.xdateMomentFormat)}catch(b){return console.error("Invalid date format passed",k.xdateMomentFormat),k.timeZone?moment(a).utcOffset(k.timeZone).format("DD-MM-YYYY HH:mm:ss"):moment(a).format("DD-MM-YYYY HH:mm:ss")}})},this.$postLink=function(){k.timeoutId=g(k.resize.bind(k),100),angular.element(h).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?e.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(e.$on("update-data",function(a,b){null==b?k.datas&&0!=k.datas.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),e.$emit("waiting-for-data"))},this.onResize=function(){null!=k.timeoutId&&g.cancel(k.timeoutId),k.timeoutId=g(k.resize.bind(k),100)},this.resize=function(){f.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$onDestroy=function(){k.msgTag&&d.unsubscribe(k.msgTag,null,e.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&g.cancel(k.timeoutId),angular.element(h).off("resize",k.onResize)};var l=function(a){var b={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:e.$id};j.scriptrRequest(b,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(b,c){b.status&&"failure"==b.status?(this.noResults=!0,k.dataFailureMessage=a.instant(this.dataFailureMessage),this.datas&&this.datas.length>0&&(this.stalledData=!0,k.stalledDataMessage=a.instant(this.stalledDataMessage))):("function"==typeof k.onFormatData()&&(b=k.onFormatData()(b,k)),null!=b&&"object"==typeof b&&Array.isArray(b)?b.length>0?(null!=this.datas&&this.delta?this.datas=this.datas.concat(b):this.datas=b,k.hasData=!0,k.noResults=!1,k.stalledData=!1):(k.noResults=!0,null!=k.datas&&k.datas.length>0&&(k.stalledData=!0),k.stalledDataMessage=a.instant(this.stalledDataMessage)):(k.noResults=!0,null!=k.datas&&k.datas.length>0&&(k.stalledData=!0),k.invalidData=a.instant(this.invalidData)))}}]}),angular.module("Odometer",["ui.odometer","ComponentsCommon","DataService"]),angular.module("Odometer").component("scriptrOdometer",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",enableResize:"<?",theme:"@",icon:"@",duration:"@",animation:"@",odometerValue:"<?",data:"<?",size:"<?",loadingMessage:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/odometer/odometer.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","dataService",function(a,b,c,d,f,g,h,i){var j=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/odometer-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=!(isNaN(parseFloat(this.odometerValue))||!isFinite(this.odometerValue)),this.config={duration:this.duration?this.duration:1e3,animation:this.animation?this.animation:"count",theme:this.theme?this.theme:"car"},this.odometerOptions=this.config,this.size=this.size?this.size:1,this.enableResize=void 0===this.enableResize||this.enableResize,this.style={},this.style["font-size"]=this.size+"em",this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true"},this.onResize=function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(j.resize.bind(j),300)},j.resize=function(){j.timeoutId=null,j.enableResize&&(j.style["margin-top"]=d.parent().outerHeight()/2-d.outerHeight()/2),j.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1},this.$postLink=function(){j.timeoutId=g(j.resize.bind(j),300),angular.element(f).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null==j.odometerValue&&(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),a.$emit("waiting-for-data"))},this.$onDestroy=function(){j.msgTag&&c.unsubscribe(j.msgTag,null,a.$id),j.refreshTimer&&h.cancel(j.refreshTimer),null!=j.timeoutId&&g.cancel(j.timeoutId),angular.element(f).off("resize",j.onResize)};var k=function(b){var c={api:j.api,transport:b,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:a.$id};i.scriptrRequest(c,j.consumeData.bind(j)),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=h(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(j.noResults=!0,j.dataFailureMessage="Failed to fetch data.",j.odometerValue&&(j.stalledData=!0,j.dataFailureMessage="Failed to update data.")):("function"==typeof j.onFormatData()&&(a=j.onFormatData()(a,j)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(j.odometerValue=a,j.hasData=!0,j.noResults=!1,j.stalledData=!1):(j.noResults=!0,null!=j.odometerValue&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.")):(j.noResults=!0,null!=j.odometerValue&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.",console.log(e)))}}]}),angular.module("Speedometer",["meterGauge","ComponentsCommon","DataService"]),angular.module("Speedometer").component("scriptrSpeedometer",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",gaugeRadius:"<?",icon:"@",loadingMessage:"@",theme:"@",minValue:"<?",maxValue:"<?",needleVal:"<?",data:"<?",tickSpaceMinVal:"<?",tickSpaceMajVal:"<?",gaugeUnits:"@",tickColMaj:"@",tickColMin:"@",outerEdgeCol:"@",pivotCol:"@",innerCol:"@",unitsLabelCol:"@",tickLabelCol:"@",needleCol:"@",defaultFonts:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/speedometer/speedometer.html",controller:["httpClient","wsClient","$element","$window","$scope","$compile","$timeout","$interval","dataService",function(a,b,c,d,e,f,g,h,i){var j=this;this.$onInit=function(){this.speedoConfig={},this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/speedometer-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=!(isNaN(parseFloat(this.speedoConfig.needleVal))||!isFinite(this.speedoConfig.needleVal)),"speed"==this.theme||void 0===this.theme?(this.speedoConfig.gaugeRadius=this.gaugeRadius?this.gaugeRadius:150,this.speedoConfig.minVal=this.minValue?this.minValue:0,this.speedoConfig.maxVal=this.maxValue?this.maxValue:220,this.speedoConfig.tickSpaceMinVal=this.tickSpaceMinVal?this.tickSpaceMinVal:10,this.speedoConfig.tickSpaceMajVal=this.tickSpaceMajVal?this.tickSpaceMajVal:20,this.speedoConfig.gaugeUnits=this.gaugeUnits?this.gaugeUnits:"kmh",this.speedoConfig.tickColMaj=this.tickColMaj?this.tickColMaj:"#C64DFF",this.speedoConfig.tickColMin=this.tickColMin?this.tickColMin:"#999999",this.speedoConfig.outerEdgeCol=this.outerEdgeCol?this.outerEdgeCol:"#f4f4f4",this.speedoConfig.pivotCol=this.pivotCol?this.pivotCol:"#434a54",this.speedoConfig.innerCol=this.innerCol?this.innerCol:"#ffffff",this.speedoConfig.unitsLabelCol=this.unitsLabelCol?this.unitsLabelCol:"#C64DFF",this.speedoConfig.tickLabelCol=this.tickLabelCol?this.tickLabelCol:"#656D78",this.speedoConfig.needleCol=this.needleCol?this.needleCol:"#C64DFF",this.speedoConfig.defaultFonts=this.defaultFonts?this.defaultFonts:""):"rpm"==this.theme&&(this.speedoConfig.gaugeRadius=this.gaugeRadius?this.gaugeRadius:120,this.speedoConfig.minVal=this.minValue?this.minValue:0,this.speedoConfig.maxVal=this.maxValue?this.maxValue:1e3,this.speedoConfig.needleVal=this.needleVal?Math.round(this.needleVal):this.data?Math.round(this.data):0,this.speedoConfig.tickSpaceMinVal=this.tickSpaceMinVal?this.tickSpaceMinVal:10,this.speedoConfig.tickSpaceMajVal=this.tickSpaceMajVal?this.tickSpaceMajVal:100,this.speedoConfig.gaugeUnits=this.gaugeUnits?this.gaugeUnits:"kmh",this.speedoConfig.tickColMaj=this.tickColMaj?this.tickColMaj:"#0194D9",this.speedoConfig.tickColMin=this.tickColMin?this.tickColMin:"#999999",this.speedoConfig.outerEdgeCol=this.outerEdgeCol?this.outerEdgeCol:"#ffffff",this.speedoConfig.pivotCol=this.pivotCol?this.pivotCol:"#434A54",this.speedoConfig.innerCol=this.innerCol?this.innerCol:"#ffffff",this.speedoConfig.unitsLabelCol=this.unitsLabelCol?this.unitsLabelCol:"#0194d9",this.speedoConfig.tickLabelCol=this.tickLabelCol?this.tickLabelCol:"#656D78",this.speedoConfig.needleCol=this.needleCol?this.needleCol:"#0194d9",this.speedoConfig.defaultFonts=this.defaultFonts?this.defaultFonts:""),this.speedoConfig.speedoTag=e.$id,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",angular.element(d).on("resize",function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(function(){j.renderGauge()},100)})},this.calculateGaugeRadius=function(){var a=c.parent().height(),b=c.parent().width();j.speedoConfig.gaugeRadius=0==a?b/2:b>=a?a/2:b/2},this.calculateNotificationsDisplay=function(){c.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1},this.renderGauge=function(){angular.element(c).find(".speedometer-wrapper").html(""),j.speedo=angular.element(document.createElement("meter-gauge")),j.calculateGaugeRadius(),j.speedo.attr("gaugeconfig",JSON.stringify(j.speedoConfig)),this.el=f(j.speedo)(e),angular.element(c).find(".speedometer-wrapper").append(this.el)},this.onResize=function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(j.resize.bind(j),100)},this.resize=function(){this.speedoConfig.needleVal&&j.renderGauge(),j.calculateNotificationsDisplay()},this.$postLink=function(){j.timeoutId=g(j.resize.bind(j),100),angular.element(d).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?e.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(e.$on("update-data",function(a,b){null==b?null==j.speedoConfig.needleVal&&(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),e.$emit("waiting-for-data"))},this.$onDestroy=function(){j.msgTag&&b.unsubscribe(j.msgTag,null,e.$id),j.refreshTimer&&h.cancel(j.refreshTimer),null!=j.timeoutId&&g.cancel(j.timeoutId),angular.element(d).off("resize",j.onResize)};var k=function(a){var b={api:j.api,transport:a,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:e.$id};i.scriptrRequest(b,j.consumeData.bind(j)),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=h(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(j.noResults=!0,j.dataFailureMessage="Failed to fetch data.",j.speedoConfig.needleVal&&(j.stalledData=!0,j.dataFailureMessage="Failed to update data.")):("function"==typeof j.onFormatData()&&(a=j.onFormatData()(a,j)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(j.speedoConfig.needleVal=Math.round(a),j.hasData=!0,j.noResults=!1,j.stalledData=!1,j.renderGauge()):(j.noResults=!0,null!=j.speedoConfig.needleVal&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.")):(j.noResults=!0,null!=j.speedoConfig.needleVal&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format."))}}]}),angular.module("Gauge",["frapontillo.gage","ComponentsCommon","DataService"]),angular.module("Gauge").component("scriptrGauge",{bindings:{onLoad:"&onLoad",icon:"@",dataFailureMessage:"@",stalledDataMessage:"@",invalidData:"@",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",valueFontColor:"@",min:"@",max:"@",hideMinMax:"@",hideValue:"@",showInnerShadow:"<?",gaugeColor:"@",gaugeValue:"<?",data:"<?",customSectors:"<?",shadowSize:"@",shadowOpacity:"@",label:"@",labelFontColor:"@",startAnimationType:"@",refreshAnimationType:"@",title:"@",titleFontColor:"@",titleBackgroundColor:"@",titleMargin:"@",titleFontWeight:"@",titleShadow:"@",titleFontFamily:"@",titlePosition:"@",titleFontSize:"@",titleTextTransform:"@",titlePadding:"@",titleHeight:"@",valueFontFamily:"@",relativeGaugeSize:"@",valueMinFontSize:"@",hideMinMax:"@",labelMinFontSize:"@",minLabelMinFontSize:"@",maxLabelMinFontSize:"@",gaugeWidthScale:"@",shadowVerticalOffset:"@",levelColors:"@",noGradient:"@",startAnimationTime:"@",refreshAnimationTime:"@",donut:"@",donutStartAngle:"@",reverse:"@",decimals:"@",symbol:"@",formatNumber:"@",humanFriendly:"@",humanFriendlyDecimal:"@",textRenderer:"&",onAnimationEnd:"&",pointer:"<?",counter:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/gauge/gauge.html",controller:["$translate","$rootScope","$scope","httpClient","wsClient","$interval","dataService","$timeout","$window","$element",function(a,b,c,d,f,g,h,i,j,k){var l=this;this.$onInit=function(){a.use(b.lang),this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/gauge-bg.svg",this.hasData=!(isNaN(parseFloat(this.gaugeValue))||!isFinite(this.gaugeValue)),this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.customSectors=this.customSectors?this.customSectors:{percents:!0,ranges:[]},this.valueFontColor=this.valueFontColor?this.valueFontColor:"#999",this.min=this.min?this.min:0,this.max=this.max?this.max:100,this.hideMinMax=!!this.hideMinMax&&this.hideMinMax,this.hideValue=!!this.hideValue&&this.hideValue,this.gaugeColor=this.gaugeColor?this.gaugeColor:"#e9e9e9",this.shadowSize=this.shadowSize?this.shadowSize:0,this.label=a.instant(this.label)?a.instant(this.label):"",this.labelFontColor=this.labelFontColor?this.labelFontColor:"#666",this.startAnimationType=this.startAnimationType?this.startAnimationType:"linear",this.refreshAnimationType=this.refreshAnimationType?this.refreshAnimationType:"linear",this.counter=!this.counter||this.counter,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.relativeGaugeSize=!0,this.titleFontSize=this.titleFontSize?this.titleFontSize:"17px",this.titlePosition=this.titlePosition?this.titlePosition:"center",this.titleFontFamily=this.titleFontFamily?this.titleFontFamily:"",this.titleFontColor=this.titleFontColor?this.titleFontColor:"#000",this.titleShadow=this.titleShadow?this.titleShadow:"",this.titleFontWeight=this.titleFontWeight?this.titleFontWeight:"bold",this.titleBackgroundColor=this.titleBackgroundColor?this.titleBackgroundColor:"",this.titleTextTransform=this.titleTextTransform?this.titleTextTransform:"capitalize",this.titlePadding=this.titlePadding?this.titlePadding:"10px",this.titleHeight=this.titleHeight?this.titleHeight:"40px",this.titleMargin=this.titleMargin?this.titleMargin:"0"},this.$postLink=function(){l.timeoutId=i(l.resize.bind(l),100),angular.element(j).on("resize",l.onResize),
"wss"==l.transport&&(l.api||l.msgTag)||"https"==l.transport&&l.api?m(this.transport):null!=l.data?c.$watch(function(a){return a.$ctrl.data},function(a,b){JSON.stringify(a)&&l.consumeData(a)}):(c.$on("update-data",function(a,b){null==b?null==l.gaugeValue&&(l.noResults=!0):b[l.serviceTag]?l.consumeData(b[l.serviceTag]):l.consumeData(b)}),c.$emit("waiting-for-data"))},this.onResize=function(){null!=l.timeoutId&&i.cancel(l.timeoutId),l.timeoutId=i(l.resize.bind(l),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){k.parent()&&k.parent().innerWidth()<240?l.usePopover=!0:l.usePopover=!1},this.$onDestroy=function(){l.msgTag&&f.unsubscribe(l.msgTag,null,c.$id),l.refreshTimer&&g.cancel(l.refreshTimer),null!=l.timeoutId&&i.cancel(l.timeoutId),angular.element(j).off("resize",l.onResize)};var m=function(a){var b={api:l.api,transport:a,msgTag:l.msgTag,apiParams:l.apiParams,useWindowParams:l.useWindowParams,httpMethod:l.httpMethod,widgetId:c.$id};h.scriptrRequest(b,l.consumeData.bind(l)),l.fetchDataInterval&&!l.refreshTimer&&(l.refreshTimer=g(function(){m(l.transport)},1e3*l.fetchDataInterval))};this.consumeData=function(b,c){b.status&&"failure"==b.status?(l.noResults=!0,l.dataFailureMessage=a.instant(this.dataFailureMessage),l.gaugeValue&&(l.stalledData=!0,l.stalledDataMessage=a.instant(this.stalledDataMessage))):("function"==typeof l.onFormatData()&&(b=l.onFormatData()(b,l)),null!=b?(b=parseFloat(b),!isNaN(b)&&isFinite(b)?(l.gaugeValue=b,l.hasData=!0,l.noResults=!1,l.stalledData=!1):(l.noResults=!0,null!=l.gaugeValue&&(l.stalledData=!0),l.invalidData=a.instant(this.invalidData))):(l.noResults=!0,null!=l.gaugeValue&&(l.stalledData=!0),l.invalidData=a.instant(this.invalidData),console.log(e)))}}]}),angular.module("angular-scriptrui",[]).directive("ngScriptrAlert",function(){return{restrict:"E",require:"ngModel",scope:{msg:"=ngModel",type:"@"},template:'<div class="alert alert-{{type}} scriptr-alert" role="alert"><span ng-bind="msg"></span></div>',replace:!0}}),angular.module("Alert",["angular-scriptrui","ComponentsCommon","DataService"]),angular.module("Alert").component("scriptrAlert",{bindings:{data:"<?",type:"@",icon:"@",transport:"@",loadingMessage:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/alert/alert.html",controller:["httpClient","wsClient","dataService","$scope","$interval","$window","$element","$timeout",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/alert-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=null!=this.message&&""!=this.message,this.type=this.type?this.type:"info"},this.$postLink=function(){i.timeoutId=h(i.resize.bind(i),100),angular.element(f).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?d.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(d.$on("update-data",function(a,b){null==b?null!=i.message&&""!=i.message||(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),d.$emit("waiting-for-data"))},this.calculateNotificationsDisplay=function(){g.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1},this.onResize=function(){null!=i.timeoutId&&h.cancel(i.timeoutId),i.timeoutId=h(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.$onDestroy=function(){console.log("destory alert",i.msgTag,d.$id),i.msgTag&&b.unsubscribe(i.msgTag,null,d.$id),i.refreshTimer&&e.cancel(i.refreshTimer),null!=i.timeoutId&&h.cancel(i.timeoutId),angular.element(f).off("resize",i.onResize)};var j=function(a){var b={api:i.api,transport:a,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:d.$id};c.scriptrRequest(b,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=e(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(i.noResults=!0,i.dataFailureMessage="Failed to fetch data.",i.message&&(i.stalledData=!0,i.dataFailureMessage="Failed to update data.")):("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a?"object"==typeof a?(a&&a.value&&null!=typeof a.value?(i.message=a.value,i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.message&&""!=i.message&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."),a&&a.type&&(i.type=a.type)):(i.message=a,i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.message&&""!=i.message&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."))}}]}),angular.module("Thermometer",["angularThermometer","ComponentsCommon","DataService"]),angular.module("Thermometer").component("scriptrThermometer",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",data:"<?",step:"<?",loadingMessage:"@",customSectors:"<?",outOfRangeColor:"@",ticks:"<?",icon:"@",percent:"@",unit:"@",height:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/thermometer/thermometer.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;k.showSelectStream=!k.api,this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/thermometer-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=!(isNaN(parseFloat(this.value))||!isFinite(this.value)),this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.customSectors=this.customSectors&&this.customSectors.length>0?this.customSectors:[{color:"#CC5464",lo:0,hi:30},{color:"#FCC717",lo:30,hi:60},{color:"#38B9D6",lo:60,hi:90}],this.customSectors&&(this.customSectors=h.reject(this.customSectors,h.isEmpty)),this.outOfRangeColor=this.outOfRangeColor?this.outOfRangeColor:"#E90088",this.thermoUnit=this.unit?this.unit:"Â°C",this.height=this.height?this.height:"100",this.mercuryColor=this.evaluateColor(this.value),this.step=this.step?this.step:"30";var a=this.getLowestTick(),b=this.getHighestTick(),c=parseInt(a);for(this.sectors=[],this.sectors.push(c);c<b;)c+=parseInt(this.step),this.sectors.push(c);this.sectors=this.sectors?this.sectors:[0,30,60,90],this.mercuryMax=h.max(this.sectors),this.minSectorValue=h.min(this.sectors),this.ticks=[];for(var d=0;d<this.sectors.length;d++){var e={};e.tick=this.sectors[d],e.percent=(this.sectors[d]-this.minSectorValue)*this.height/(this.mercuryMax-this.minSectorValue),this.ticks.push(e)}this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.style={}},this.onResize=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize.bind(k),100)},k.resize=function(){k.timeoutId=null,k.style["margin-left"]=d.parent().outerWidth(!0)/2-50,k.calculateNotificationsDisplay()},this.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null==k.value&&(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&(console.log("timeout inside destroy"),e.cancel(k.timeoutId)),angular.element(c).off("resize",k.onResize)};var l=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(this.noResults=!0,k.dataFailureMessage="Failed to fetch data.",null!=k.value&&(k.stalledData=!0,k.dataFailureMessage="Failed to update data.")):("function"==typeof this.onFormatData()&&(a=k.onFormatData()(a,k)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(k.mercuryColor=k.evaluateColor(a),k.value=a>k.mercuryMax?k.mercuryMax:a,k.percent=parseInt((a-k.minSectorValue)*k.height/(k.mercuryMax-k.minSectorValue)),k.hasData=!0,k.noResults=!1,k.stalledData=!1,k.timeout=!0):(k.noResults=!0,null!=k.value&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format.")):(k.noResults=!0,null!=k.value&&(k.stalledData=!0)))},this.evaluateColor=function(a){var b=k.outOfRangeColor;return h.some(k.customSectors,function(c){if(c.lo<=a&&a<=c.hi)return b=c.color,!0}),b},this.getLowestTick=function(){return h.min(h.pluck(this.customSectors,"lo"))},this.getHighestTick=function(){return h.max(h.pluck(this.customSectors,"hi"))}}]}),angular.module("Map",["ngMap","ToggleSwitch","ui.bootstrap","schemaForm","ngAnimate","ngSanitize","angular-underscore/filters","pascalprecht.translate","ngMessages","ComponentsCommon","DataService"]),angular.module("Map").constant("geofenceDetails",{form:[{type:"section",htmlClass:"col-xs-12",items:[{key:"identifier",validationMessage:{unique:"Identifier already taken"},$validators:{unique:function(a,b,c,d){return-1==c.inUseIdentifiers.indexOf(a)}}}]},{type:"section",htmlClass:"col-xs-12",items:[{key:"properties",title:"Geofence Properties",startEmpty:!0,items:[{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-xs-6",items:[{key:"properties[].key"}]},{type:"section",htmlClass:"col-xs-6",items:[{key:"properties[].value"}]}]}]}]}],schema:{type:"object",title:"Schema",properties:{identifier:{title:"Identifier",type:"string"},properties:{type:"array",default:[],items:{type:"object",properties:{key:{title:"Key",type:"string"},value:{title:"Value",type:"string"}}}}},required:[]}}).component("scriptrMap",{transclude:!0,bindings:{sourcesInfo:"<?",clusteredView:"<?",clusteredZoomMax:"<?",clusterZoom:"<?",detailedZoomMin:"<?",focusedMarkerZoom:"<?",pathStrokeOpacity:"@",pathStrokeWeight:"@",maxAssetPoints:"<?",defaultCenter:"@",trackedAsset:"@",selectedTrackedAsset:"@",summaryIcons:"<?",assetsData:"<?",heatMapWeight:"@",heatMapRadius:"@",heatMapOpacity:"@",heatMapGradient:"<?",setMarkerIcon:"&",onSelectAsset:"&",clusterStyles:"<?",geofenceManager:"<?",geofenceData:"<?",heatmap:"<?",bounce:"<?",markerInfoWindow:"<?",markerHoverWindow:"<?",customDefaultInfoWindow:"@",clickOutsideCloseInfoWindow:"<?",mapFitBounds:"<?",data:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",useWindowParams:"@",serviceTag:"@",fetchDataInterval:"@",renderOnlyClickedAsset:"<?",onBuildAssetTitle:"&?"},templateUrl:"/UIComponents/dashboard/frontend/components/map/map.html",controller:["$scope","$rootElement","$location","$sce","$compile","$timeout","$interval","$controller","NgMap","defaultConstants","wsClient","httpClient","dataService","$uibModal","$element","geofenceDetails",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this;q.$onInit=function(){var b=this;b._renderOnlyClickedAsset=void 0===b.renderOnlyClickedAsset||b.renderOnlyClickedAsset,b.transport=b.transport?b.transport:"wss",b.$wdgid=a.$id,b.pathStrokeOpacity=b.pathStrokeOpacity?b.pathStrokeOpacity:0,b.pathStrokeWeight=b.pathStrokeWeight?b.pathStrokeWeight:5,b.maxAssetPoints=b.maxAssetPoints?b.maxAssetPoints:100,b.defaultcenter=b.defaultCenter?b.defaultCenter:null,b.trackedAsset=b.trackedAsset?b.trackedAsset:null,b.clusterStyles=b.clusterStyles?b.clusterStyles:[],b.geofenceManager=!!b.geofenceManager&&b.geofenceManager,a.$parent.summaryIcons={},b.summaryIcons&&angular.forEach(b.summaryIcons,function(b,c){a.$parent.summaryIcons[c]=d.trustAsHtml(b)}),b.trackedAsset?(b.showDetailedMap=!0,b.clusteredView=!1):b.showDetailedMap=!1,b.clusteredView?(b.clusteredZoomMax||(b.clusteredZoomMax=11),b.detailedZoomMin=b.clusteredZoomMax<20?b.clusteredZoomMax+1:b.clusteredZoomMax,b.clusterZoom||(b.clusterZoom=3)):(b.detailedZoomMin||(b.detailedZoomMin=0),b.detailedmapzoom=b.detailedZoomMin),(!b.focusedMarkerZoom||b.clusteredView&&b.focusedMarkerZoom<b.clusteredZoomMax)&&(b.focusedMarkerZoom=b.detailedZoomMin<18?b.detailedZoomMin+3:b.detailedZoomMin),b.selectedTrackedAsset&&(b.showDetailedMap=!0,b.detailedmapzoom=b.detailedZoomMin),r(),b.sourcesInfo=b.sourcesInfo,b.markerInfoWindow=void 0===b.markerInfoWindow||b.markerInfoWindow,b.markerHoverWindow=void 0!==b.markerHoverWindow&&b.markerHoverWindow,b.clickOutsideCloseInfoWindow=void 0!==b.clickOutsideCloseInfoWindow&&b.clickOutsideCloseInfoWindow,b.mapFitBounds=void 0===b.mapFitBounds||b.mapFitBounds,b.bounds=null,b.mapFitBounds&&(b.bounds=new google.maps.LatLngBounds),a.$on("mapFoucsOnMarker",function(a,c){b.focusOnAsset(c)}),a.$on("mapRemoveAssets",function(a,c){b.removeAssets(c)}),a.$on("mapShowInfoWindowOnMarker",function(a,c){var d=b.assets[c].latestMarker;b.showAssetInfo(null,null,d,c,null,d.id)}),a.$on("mapRerender",function(a){t(),b.clusteredView?(b.showDetailedMap=!1,b.clusterZoom=b.clusteredZoomMax,i.getMap({id:"clustered-"+b.$wdgid}).then(function(a){a.setCenter(b.bounds.getCenter()),a.fitBounds(b.bounds)},function(a){})):i.getMap({id:"detailed-"+b.$wdgid}).then(function(a){a.setCenter(b.bounds.getCenter()),a.fitBounds(b.bounds)},function(a){})}),b.switchStatus=(!1===b.heatmap||!0===b.heatmap)&&b.heatmap,a.$on("mapInitialized",function(a,c){b.map=c,1==b.switchStatus&&b.heatmap?(heatmap=new google.maps.visualization.HeatmapLayer({data:_.toArray(b.heatMap),radius:b.heatMapRadius,gradient:b.heatMapGradient,opacity:b.heatMapOpacity}),heatmap.setMap(b.map)):"undefined"!=typeof heatmap&&heatmap.setMap(null),b.geofenceManager&&b.attachGeofencesToMap(c),b.selectedTrackedAsset&&1==b.showDetailedMap&&f(function(){b.selectedTrackedMarker&&b.showAssetInfo(null,null,b.selectedTrackedMarker,b.selectedTrackedMarker.assetKey,b.selectedTrackedMarker.tripKey,b.selectedTrackedMarker.id)},1e3)}),b.geofenceManager&&(b.geofencesIncrement=0,b.geofenceMenuDisplayed=!1,b.geofencesLoaded||b.loadGeofences(),google.maps.event.addDomListener(document,"click",function(a){1==b.geofenceMenuDisplayed&&(menuBox=o.find(".geofence-menu")[0],menuBox.style.display="none",b.geofenceMenuDisplayed=!1)}))},this.$onDestroy=function(){q.msgTag&&k.unsubscribe(q.msgTag,null,a.$id),q.refreshTimer&&g.cancel(q.refreshTimer)};q.sources={},q.assets={},q.selectedAsset="all",q.markerClusterer=null,q._hiddenAssets={},q.assetsKeys=[],q.mapcenter=null,q.infoWindow=null,q.dynMarkers={},q.heatMap={},q.heatMapRadius=q.heatMapRadius?q.heatMapRadius:40,q.heatMapOpacity=q.heatMapOpacity?q.heatMapOpacity:.8,q.heatMapGradient=q.heatMapGradient?q.heatMapGradient:["rgba(0, 255, 255, 0)","rgba(0, 255, 255, 1)","rgba(0, 191, 255, 1)","rgba(0, 127, 255, 1)","rgba(0, 63, 255, 1)","rgba(0, 0, 255, 1)","rgba(0, 0, 223, 1)","rgba(0, 0, 191, 1)","rgba(0, 0, 159, 1)","rgba(0, 0, 127, 1)","rgba(63, 0, 91, 1)","rgba(127, 0, 63, 1)","rgba(191, 0, 31, 1)","rgba(255, 0, 0, 1)"];var r=function(){s(q.transport),q.assetsData?q.processAssets(q.assetsData):q.data&&q.processAssets(q.data)},s=function(b){if("wss"==b&&(q.api||q.msgTag)||"https"==b&&q.api){var c={api:q.api,transport:b,msgTag:q.msgTag,apiParams:q.apiParams,useWindowParams:q.useWindowParams,httpMethod:q.httpMethod,widgetId:a.$id};m.scriptrRequest(c,q.processAssets.bind(q)),q.fetchDataInterval&&!q.refreshTimer&&(q.refreshTimer=g(function(){s(q.transport)},1e3*q.fetchDataInterval))}else a.$emit("waiting-for-data"),a.$on("update-data",function(a,b){b&&(b[q.serviceTag]?q.processAssets(b[q.serviceTag]):q.processAssets(b))})};q.removeAssets=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=u(b,a[b]);delete q.assets[c],delete q.displayedAssets[c],delete q.dynMarkers[c],q.markerClusterer.clearMarkers(),q.markerClusterer.addMarkers(_.toArray(q.dynMarkers),!1),q.markerClusterer.repaint()}},q.processAssets=function(a){q.onFormatData&&"function"==typeof q.onFormatData()&&(a=q.onFormatData()(a));var b=a,c=function(a,b){if(q.trackedAsset&&q.trackedAsset!=c)a.hasOwnProperty(q.trackedAsset)&&q.pushAssets(q.trackedAsset,a[q.trackedAsset]);else for(var c in a)a.hasOwnProperty(c)&&q.pushAssets(c,a[c]);q.heatmap||q.swithcStatus||(q.renderAssets(),!q.clusteredView||q.trackedAsset||q.selectedTrackedAsset||q.renderClusterer()),q.mapFitBounds&&q.bounds&&i.getMap({id:b}).then(function(a){q.mapcenter||(q.mapcenter=q.bounds.getCenter().lat()+","+q.bounds.getCenter().lng(),a.setCenter(q.bounds.getCenter()),a.fitBounds(q.bounds))})};!q.clusteredView||q.markerClusterer||q.trackedAsset||q.selectedTrackedAsset?(c(b,"detailed-"+q.$wdgid),1==q.switchStatus&&q.heatmap&&q.activateHeatMap(!0)):i.getMap({id:"clustered-"+q.$wdgid}).then(function(a){q.markerClusterer||q.buildClusterer(a),c(b,"clustered-"+q.$wdgid),1==q.switchStatus&&q.heatmap&&q.activateHeatMap(!0)},function(a){console.log("Clusterer Map error",a)})},q.activateHeatMap=function(a){1==a?(heatmap=new google.maps.visualization.HeatmapLayer({data:_.toArray(q.heatMap),radius:q.heatMapRadius,gradient:q.heatMapGradient,opacity:q.heatMapOpacity}),heatmap.setMap(q.map),q.showDetailedMap=!1,q.markerClusterer.clearMarkers(),q.markerClusterer.repaint()):"undefined"!=typeof heatmap&&(heatmap.setMap(null),q.showDetailedMap=!1,q.renderClusterer())},q.buildClusterer=function(a){q.markerClusterer=new MarkerClusterer(a,_.toArray(q.dynMarkers),{maxZoom:q.clusteredZoomMax,imagePath:"https://cdn.rawgit.com/googlemaps/js-marker-clusterer/gh-pages/images/m",minimumClusterSize:-1,gridSize:50,averageCenter:!0,styles:q.clusterStyles})};var t=function(){q.selectedAsset="all",q.renderAssets()};q.renderAssets=function(){console.log("Render New Assets."),"all"==q.selectedAsset?q.showAllAssets():q._renderOnlyClickedAsset?(q.displayedAssets={},q.displayedAssets[q.selectedAsset]=q.assets[q.selectedAsset]):q.showAllAssets()},q.renderClusterer=function(){console.log("Render clusterer."),q.markerClusterer.resetViewport(!0),q.markerClusterer.clearMarkers(),q.markerClusterer.addMarkers(_.toArray(q.dynMarkers),!1),q.markerClusterer.repaint()},q.showAllAssets=function(){q.displayedAssets=angular.copy(q.assets,{})},q.onClusteredZoomChanged=function(){q.trackedAsset||q.selectedTrackedAsset||q.heatmap||q.switchStatus||i.getMap({id:"clustered-"+q.$wdgid}).then(function(a){q.map=a,a.getZoom()>=q.detailedZoomMin?(q.showDetailedMap=!0,q.mapcenter=a.getCenter(),q.detailedmapzoom=q.detailedZoomMin):(q.showDetailedMap=!1,q.markerClusterer&&q.markerClusterer.setMap(a),t())})},q.onDetailedZoomChanged=function(){q.trackedAsset||q.selectedTrackedAsset||1!=q.clusteredView||q.heatmap||q.switchStatus||i.getMap({id:"detailed-"+q.$wdgid}).then(function(a){q.map=a,a.getZoom()<=q.clusteredZoomMax?(q.showDetailedMap=!1,q.clusterZoom=q.clusteredZoomMax,t()):q.showDetailedMap=!0})};var u=function(a,b){return b.source+"_"+a};q.pushAssets=function(a,b){var c=b.source,d=c+"_"+a,e=null;if(q.assets[d]){var f=q.assets[d].markers;e=f[f.length-1]}else q.instantiateAsset(d),q.assets[d].pathColor=x();var g=null,h=null,i=b.order;if(i)for(var k=i.length-1;k>=0;k--){var l=i[k];if(b.hasOwnProperty(l))for(var m=b[l],n=x(),o=x(),p=m.length-1;p>=0;p--){var r=m[p],s={position:r.lat.value+","+r.long.value};s.title="Source: "+c+", Asset: "+a+", trip: "+l+".",s.source=c,s.assetId=a,s.assetKey=d,s.tripKey=l,s.details=r,g=s.details&&s.details.model?s.details.model.value:"",h=s.details&&s.details.make?s.details.make.value:"",s.display=w(h,g,a,r),e||null!=e?l==e.tripKey?(s.id=d+"-"+l+"-"+(e.pointRef+1),s.pointRef=e.pointRef+1,s.strokeColor=e.strokeColor,s.fillColor=e.fillColor,q.assets[d].markers[f.length-1].icon=v(6,.8,.8,e.strokeColor,e.fillColor)):q.assets[d].markers[f.length-1].icon=v(10,1,1,e.strokeColor,e.fillColor):(s.id=d+"-"+l+"-"+p,s.pointRef=p,s.strokeColor=n,s.fillColor=o),0==k&&0==p?(s.icon=q.sourcesInfo&&q.sourcesInfo[c]&&q.sourcesInfo[c].icon?q.sourcesInfo[c].icon:j.sourceIcon.default,q.assets[d].latestMarker=s):s.icon=0==p?v(10,1,1,n,o):v(6,.8,.8,n,o),q.setMarkerIcon&&"function"==typeof q.setMarkerIcon()&&(s=q.setMarkerIcon()(r,s)),q.controlVehicleTrips(d),q.addMarkerToMap(d,s,r),q.bounds?q.bounds.extend(new google.maps.LatLng(r.lat.value,r.long.value)):null==q.mapcenter&&(q.mapcenter=s.position)}}q.addAssetToSourceList(c,d,s.display)},q.addAssetToSourceList=function(a,b,c){q.sources[a]?void 0==_.findWhere(q.sources[a],{key:b})&&q.sources[a].push({key:b,label:c}):q.sources[a]=[{key:b,label:c}]},q.addMarkerToMap=function(b,c,d){if(q.bounce&&d.bounce&&("true"==d.bounce.value||1==d.bounce.value)&&(c.animation=google.maps.Animation.BOUNCE),q.assets[b].markers.push(c),q.assets[b].path.push([d.lat.value,d.long.value]),q.selectedTrackedAsset==c.assetId&&(q.selectedTrackedMarker=c),q.selectedAsset==b&&(a.$parent.marker=c),!q.trackedAsset){var e=angular.copy(c,{});e.position=new google.maps.LatLng(d.lat.value,d.long.value);var f=new google.maps.Marker(e);q.dynMarkers[b]=f;var g={};g.location=e.position,g.weight=q.heatMapWeight?q.heatMapWeight:40,q.heatMap[b]=g}},q.controlVehicleTrips=function(a){q.maxAssetPoints&&q.assets[a].markers.length>=q.maxAssetPoints&&(q.assets[a].markers.shift(),q.assets[a].path.shift())},q.instantiateAsset=function(a){q.assets[a]={markers:[],path:[],pathColor:"",latestMarker:{},strokeOpacity:q.pathStrokeOpacity,strokeWeight:q.pathStrokeWeight,pathIcon:[{icon:{path:"M 0,-1 0,1",strokeOpacity:1,scale:4},offset:"0",repeat:"20px"}]}};var v=function(a,b,c,d,e){return{path:google.maps.SymbolPath.CIRCLE,fillOpacity:b,strokeWeight:c,scale:a,strokeColor:d,fillColor:e}},w=function(a,b,c,d){if(q.onBuildAssetTitle&&"function"==typeof q.onBuildAssetTitle())return q.onBuildAssetTitle()(d);var e=a?a+" ":"";return e+=b?b+"-":"",e+=c};q.hideinfoWindow=function(){q.clickOutsideCloseInfoWindow&&null!=q.infoWindow&&q.infoWindow.close()},q.focusOnAsset=function(a,b,c){q.onSelectAsset&&"function"==typeof q.onSelectAsset()&&q.onSelectAsset()(b,c),q.selectedAsset=a,q.showDetailedMap=!0,null!=q.infoWindow&&q.infoWindow.close(),"all"==q.selectedAsset?(q.detailedmapzoom=q.detailedZoomMin,q.searchText=""):(q.searchText=q.assets[a].latestMarker.display,!0!==c&&(q.mapcenter=q.assets[q.selectedAsset].latestMarker.position,q.detailedmapzoom=q.focusedMarkerZoom))},q.showAssetInfo=function(b,c,d,e,f,g){if("mouseover"!=c||0!=q.markerHoverWindow){console.log("Show assetInfo assetKey",e),q.selectedAsset=e,q.focusOnAsset(e,d,"mouseover"==c);var h=b?this:null;i.getMap({id:"detailed-"+q.$wdgid}).then(function(c){a.$parent.marker=d,h=h||_.findWhere(c.markers,{data:d.id});var e="infoWindowTemplate_"+a.$parent.marker.source;if(a.map=c,q.markerInfoWindow)if(a.map.infoWindows[e])a.map.showInfoWindow(b,e,h),q.infoWindow=a.map.infoWindows[e];else if(q.customDefaultInfoWindow&&a.map.infoWindows[q.customDefaultInfoWindow])a.map.showInfoWindow(b,q.customDefaultInfoWindow,h),q.infoWindow=a.map.infoWindows[q.customDefaultInfoWindow];else{a.marker=d;var e="infoWindowTemplate_default_"+q.$wdgid;a.map.showInfoWindow(b,e,h),q.infoWindow=a.map.infoWindows[e]}})}};var x=function(){var a=Math.floor(16777215*Math.random()).toString(16);return y("#"+a,0)},y=function(a,b){var c=parseInt(a.slice(1),16),d=b<0?0:255,e=b<0?-1*b:b,f=c>>16,g=c>>8&255,h=255&c;return"#"+(16777216+65536*(Math.round((d-f)*e)+f)+256*(Math.round((d-g)*e)+g)+(Math.round((d-h)*e)+h)).toString(16).slice(1)};q.isEmptyObject=function(a){return 0==Object.keys(a).length},q.drawingControl=["rectangle","circle","polygon"],q.drawingOptions={position:"TOP_CENTER",drawingModes:["rectangle","circle","polygon"]},q.geoFencesList=[],q.geofencesVisible=!0,q.overlaySettings={fillColor:"#444",fillOpacity:.2,strokeWeight:3,strokeColor:"#ff8c00",clickable:!0,zIndex:1,editable:!0,draggable:!0},q.loadGeofences=function(){q.geofenceData["api-params"]?q.geofenceData["api-params"].assetId=q.selectedAsset:q.geofenceData["api-params"]={assetId:q.selectedAsset};var b={api:q.geofenceData["load-api"],transport:q.geofenceData.transport||q.transport,apiParams:q.geofenceData["api-params"],useWindowParams:q.geofenceData["use-window-params"],httpMethod:q.geofenceData["http-method"],widgetId:a.$id};m.scriptrRequest(b,q.consumeLoadedGeofences.bind(q))},q.consumeLoadedGeofences=function(a){q.geofencesLoaded=!0,_.each(a,function(a){z(a,null)}),i.getMap({id:"detailed-"+q.$wdgid}).then(function(a){q.attachGeofencesToMap(a)}),i.getMap({id:"clustered-"+q.$wdgid}).then(function(a){q.attachGeofencesToMap(a)})},q.attachGeofencesToMap=function(a){_.each(q.geoFencesList,function(b){b.overlayInstance.setMap(a)})};var z=function(a,b){var c={};c.fillColor=q.overlaySettings.fillColor,c.fillOpacity=q.overlaySettings.fillOpacity,c.strokeWeight=q.overlaySettings.strokeWeight,c.strokeColor=q.overlaySettings.strokeColor,c.clickable=q.overlaySettings.clickable,c.zIndex=q.overlaySettings.zIndex,c.editable=q.overlaySettings.editable,c.draggable=q.overlaySettings.draggable,b&&(c.map=b);var d="string"==typeof a?JSON.parse(a):a,e=d.type,f=null;"rectangle"==e&&(c.bounds=d.overlay.bounds,f=new google.maps.Rectangle(c)),"circle"==e&&(c.center=d.overlay.center,c.radius=d.overlay.radius,f=new google.maps.Circle(c)),"polygon"==e&&(c.path=d.overlay.path,f=new google.maps.Polygon(c)),delete d.overlay,delete d.type,f&&q.setupOverlay(f,e,d.dataModel)},A=function(a,b,c){return"circle"==b?{dataModel:c,type:"circle",overlay:{radius:a.getRadius(),center:a.getCenter()},overlayInstance:a}:"rectangle"==b?{dataModel:c,type:"rectangle",overlay:{bounds:a.getBounds()},overlayInstance:a}:"polygon"==b?{dataModel:c,type:"polygon",overlay:{path:a.getPath().getArray()},overlayInstance:a}:void 0};q.createLocalGeofence=function(a,b,c){var d=A(a,b,c);d&&q.geoFencesList.push(d),q.reminderToSave()},q.updateLocalGeofence=function(a,b){_.each(q.geoFencesList,function(c,d,e){if(a===c.dataModel.identifier){var f=A(b,c.type,b.get("dataModel"));f&&(e[d]=f)}}),q.reminderToSave()},q.onMapOverlayCompleted=function(a){q.setupOverlay(a.overlay,a.type)},q.setupOverlay=function(a,b,c){var d={},e=_.pluck(_.pluck(q.geoFencesList,"dataModel"),"identifier");do{q.geofencesIncrement++;var f="Geofence_"+q.geofencesIncrement}while(e.indexOf(f)>-1);var d=c&&c.identifier?c:{identifier:f};a.set("dataModel",d),q.createLocalGeofence(a,b,d),c&&c.identifier||(q.rightClickedOverlay=a,q.editSelectedGeofenceSettings()),q.disableContextMenuListener=null,google.maps.event.addListener(a,"mouseover",function(a){q.disableContextMenuListener=google.maps.event.addDomListener(document,"contextmenu",function(a){return a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!1})}),google.maps.event.addListener(a,"mouseout",function(a){q.disableContextMenuListener&&google.maps.event.removeListener(q.disableContextMenuListener)}),google.maps.event.addListener(a,"rightclick",function(a){q.rightClickedOverlay=this;for(prop in a)if(a[prop]instanceof MouseEvent){mouseEvt=a[prop];var b=mouseEvt.clientX,c=mouseEvt.clientY;menuBox=o.find(".geofence-menu"),menuBox.attr("style","left: "+b+"px; top:"+c+"px; display: block;"),mouseEvt.preventDefault(),q.geofenceMenuDisplayed=!0}return!1});var g=function(a){var b=a.get("dataModel").identifier;q.updateLocalGeofence(b,a)};"circle"==b&&(google.maps.event.addListener(a,"center_changed",function(){g(this)}),google.maps.event.addListener(a,"radius_changed",function(){g(this)})),"rectangle"==b&&google.maps.event.addListener(a,"bounds_changed",function(){g(this)})},q.editSelectedGeofenceSettings=function(){var b=null;q.rightClickedOverlay.get("dataModel")&&(b=q.rightClickedOverlay.get("dataModel").identifier);var c=_.pluck(_.pluck(q.geoFencesList,"dataModel"),"identifier"),d={};q.rightClickedOverlay.get("dataModel")&&(d=q.rightClickedOverlay.get("dataModel")),d.inUseIdentifiers=_.filter(c,function(a){return a!=b}),n.open({animation:!0,component:"mapModalComponent",size:"md",scope:a,resolve:{widget:function(){return{label:"Geofence Properties",model:d,schema:angular.copy(p.schema),form:angular.copy(p.form)}}}}).result.then(function(a){"cancel"!=a&&(delete a.inUseIdentifiers,q.rightClickedOverlay.set("dataModel",a),q.updateLocalGeofence(b,q.rightClickedOverlay))},function(){console.info("modal-component for widget update dismissed at: "+new Date)})},q.removeSelectedGeofence=function(){if(q.rightClickedOverlay.get("dataModel")){var a=q.rightClickedOverlay.get("dataModel").identifier;q.geoFencesList=_.filter(q.geoFencesList,function(b,c,d){return a!=b.dataModel.identifier})}q.rightClickedOverlay.setMap(null),q.reminderToSave()},q.drawingMessages=null,q.drawingMessagesTimeout=null,q.clearAllGeofences=function(){_.each(q.geoFencesList,function(a){a.overlayInstance.setMap(null)}),q.geoFencesList=[],q.reminderToSave()},q.hideShowGeofences=function(){_.map(q.geoFencesList,function(a){return a.overlayInstance.setVisible(!q.geofencesVisible)});q.geofencesVisible=!q.geofencesVisible},q.saveAllGeofences=function(){var b=_.map(q.geoFencesList,function(a){return{dataModel:a.dataModel,overlay:a.overlay,type:a.type}});q.geofenceData["api-params"]?q.geofenceData["api-params"].geofences=b:q.geofenceData["api-params"]={geofences:b};var c={api:q.geofenceData["save-api"],transport:q.geofenceData.transport||q.transport,apiParams:q.geofenceData["api-params"],useWindowParams:q.geofenceData["use-window-params"],httpMethod:q.geofenceData["http-method"],widgetId:a.$id};m.scriptrRequest(c,function(a){q.drawingMessages=JSON.stringify(a),q.drawingMessagesTimeout=f(function(){q.drawingMessages=null},5e3)})},q.reminderToSave=function(){q.drawingMessages="Do not forget to save your changes, once you are done defining your geofences.",q.drawingMessagesTimeout=f(function(){q.drawingMessages=null},5e3)}}]}).constant("defaultConstants",{sourceIcon:{default:{
url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAoCAMAAAA1+gEjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM5Q0JGQjdENzVBNTExRTY4RDczRThCNDhCQkVDQ0REIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM5Q0JGQjdFNzVBNTExRTY4RDczRThCNDhCQkVDQ0REIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MzlDQkZCN0I3NUE1MTFFNjhENzNFOEI0OEJCRUNDREQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzlDQkZCN0M3NUE1MTFFNjhENzNFOEI0OEJCRUNDREQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4YqnkxAAAAY1BMVEUAAAD///8fitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitItkdU7mdhJoNpXp91ztuOBveaPxemdzOur0+652vHH4vTV6ffj8Pnx+Pz////2ehAtAAAAEXRSTlMAABAgMEBQYHCAj5+vv8/f7/4ucL8AAAFeSURBVBgZfcEBYqIwFEXRP1FBEUtuVEAa5O1/lY0iFrTOOfaU7Stuqn1mL9zO88vvnM1sKpaqjT3l3NTdVdK1q7nJ7SEnqa+aXGuS3O4yIHxr7jsAmSXOQ+i11AfwzswKIOpVBAozB9RKYmAUopIacLYFBiWnYxwdz0oGYGsHqJX0dBp19EpqOJiHTknNoNFAraQDb0CU1DDXSIqAAZJ6QsOkCfSSAAMGKdLqxOikligNgAFRioQTk1MgShGwEi5SZClKFzhYDmcpshSlM2zNeYiSoNWoBUkRWJnt4SwpcNHoQpB0htLMVkArXaMm8Sq1wMaSPdBpqQMOdrPyQKO5hmRjdzuSY6dJdyQ52MhV3IS6izF2deBuZQ8b3hX2VPLKO3tynheZzWQslbZQMOdXtuAqZrb2Ys2v0t5smXhn70oeMvuD++KusD+tPcmXfZADfm2fFJDZZ2VhC//+5wfrMULZDg3JQwAAAABJRU5ErkJggg=="}}}).component("mapModalComponent",{bindings:{resolve:"<",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/map/modalContent.html",controller:["$scope",function(a){this.$onInit=function(){this.widget=this.resolve.widget,a.$broadcast("schemaFormRedraw"),this.frmGlobalOptions={destroyStrategy:"remove",formDefaults:{feedback:!1}},this.widget&&(this.widget.schema&&(this.schema=angular.copy(this.widget.schema)),this.widget.form&&(this.form=angular.copy(this.widget.form)),this.model=this.widget.model?angular.copy(this.widget.model):{})},this.onSubmit=function(b){a.$broadcast("schemaFormValidate"),b.$valid&&this.close({$value:this.model})},this.onCancel=function(a){this.schema={},this.form={},this.dismiss({$value:"cancel"}),console.log("Dissmissed")}}]}),agGrid.initialiseAgGridWithAngular1(angular),angular.module("Grid",["agGrid","ui.bootstrap","ngRoute"]),angular.module("Grid").component("scriptrGrid",{bindings:{data:"<",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",deleteParams:"<?",addParams:"<?",editParams:"<?",onLoad:"&onLoad",gridDataIdentifierProperty:"@",columnsDefinition:"<columnsDefinition",rowHeight:"<?",enableServerSideSorting:"<?",enableServerSideFilter:"<?",refreshOnEdit:"<?",enableColResize:"<?",pagination:"@",enableDeleteRow:"<?",fixedHeight:"<?",enableAddRow:"<?",cellEditable:"<?",enableClientSideSorting:"<?",onInsertRowScript:"@",onDeleteRowScript:"@",enableClientSideFilter:"<?",rowModelType:"@",rowModelSelection:"@",rowDeselection:"<?",onSelectionChanged:"&?",rowData:"<?",suppressFilter:"<?",gridHeight:"@",paginationPageSize:"<?",paginationOverflowSize:"<?",maxConcurrentDatasourceRequests:"<?",paginationInitialRowCount:"<?",maxPagesInCache:"<?",onCellValueChanged:"&",onCellClicked:"&",class:"@",defaultCellRenderer:"&",onGridReady:"&",customNoRowsLabel:"@",showLoadingOverlay:"<?",customLoadingLabel:"@",suppressRowClickSelection:"<?",suppressCellSelection:"<?",enableRangeSelection:"<?"},templateUrl:"/UIComponents/dashboard/frontend/components/grid/grid.html",controller:["$translate","$rootScope","$scope","$window","$uibModal","$timeout","wsClient","dataStore","$routeParams",function(a,b,c,d,e,f,g,h,i){var j=this;j.broadcastData=null,this.dataSource={getRows:function(a){if(null!=j.broadcastData){if(null!=j.broadcastData.api)var b=j.broadcastData.api;else var b=j.api;if(null!=j.broadcastData.params&&(j.apiParams=j.broadcastData.params),null!=j.broadcastData.transport)var c=j.broadcastData.transport;else var c=j.transport}else var b=j.api,c=j.transport;var d=j.buildParams(a),e=null;"function"==typeof j.onFormatData()&&(e=function(a){return j.onFormatData()(a)}),j.showLoadingOverlay&&j.gridOptions.api.showLoadingOverlay(),h.getGridData(b,d,c,e).then(function(b,c){if(b&&b.documents){var d=b.documents,e=parseInt(b.count),f=j.cleanRows(d);if(a.successCallback(f,e),j.gridOptions.api.sizeColumnsToFit(),null==f||0==f.length){j.gridOptions.api.showNoRowsOverlay();angular.element(document.querySelector("#btNext")).attr("disabled","true")}else j.gridOptions.api.hideOverlay()}else a.failCallback(),j.gridOptions.api.showNoRowsOverlay()},function(a){console.log("reject",a)})}},this.$onDestroy=function(){j.msgTag&&g.unsubscribe(j.msgTag,null,c.$id),console.log("destory Grid")},this.cleanRows=function(a){Array.isArray(a)||(a=[a]);for(var b=!1,c=0;c<a.length;c++)for(row in a[c])if("key"!=row){b=!1;for(var d=0;d<j.gridOptions.columnDefs.length;d++)if(row==j.gridOptions.columnDefs[d].field){b=!0;break}b||delete a[c][row]}return a},this._createNewDatasource=function(){this.gridOptions.api.setDatasource(this.dataSource)},this.$onInit=function(){a.use(b.lang),this.hasData=!!(this.rowData&&this.rowData.length>0),this.data&&this.data.length>0&&(this.rowData=angular.copy(this.data)),this.noRowsLabel=this.customNoRowsLabel?this.customNoRowsLabel:a.instant("DASHBOARDS.SOCIAL_DISTANCING.GRID.NO_RESULTS_FOUND"),this.showLoadingOverlay=void 0!==this.showLoadingOverlay&&this.showLoadingOverlay,this.loadingLabel=this.customLoadingLabel?this.customLoadingLabel:a.instant("DASHBOARDS.SOCIAL_DISTANCING.GRID.CUSTOM_LOADING_MESSAGE"),this._dataIdentifierProperty=this.gridDataIdentifierProperty?this.gridDataIdentifierProperty:"key",this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.gridOptions={angularCompileRows:!0,rowHeight:this.rowHeight?this.rowHeight:25,enableSorting:void 0===this.enableClientSideSorting||this.enableClientSideSorting,enableServerSideSorting:void 0===this.enableServerSideSorting||this.enableServerSideSorting,enableServerSideFilter:void 0===this.enableServerSideFilter||this.enableServerSideFilter,enableColResize:void 0!==this.enableColResize&&this.enableColResize,enableFilter:!0,columnDefs:this.columnsDefinition,editType:"fullRow",pagination:void 0!==this.pagination&&this.pagination,cacheBlockSize:this.paginationPageSize?this.paginationPageSize:50,suppressRowClickSelection:!!this.suppressRowClickSelection&&this.suppressRowClickSelection,suppressCellSelection:!!this.suppressCellSelection&&this.suppressCellSelection,enableRangeSelection:!!this.enableRangeSelection&&this.enableRangeSelection,rowData:this.rowData?this.rowData:null,rowModelType:this.api?"infinite":"",rowSelection:this.rowModelSelection?this.rowModelSelection:"multiple",paginationPageSize:this.paginationPageSize?this.paginationPageSize:50,overlayLoadingTemplate:'<span class="ag-overlay-loading-center"><i class="fa fa-spinner fa-spin fa-fw fa-2x"></i> '+a.instant(this.loadingLabel)+"</span>",overlayNoRowsTemplate:'<span class="ag-overlay-no-rows-center">'+a.instant(this.noRowsLabel)+"</span>",defaultColDef:{filterParams:{apply:!0},suppressFilter:void 0!==this.suppressFilter&&this.suppressFilter,editable:void 0===this.cellEditable||this.cellEditable,cellRenderer:"function"==typeof this.defaultCellRenderer()?this.defaultCellRenderer():null},onSelectionChanged:function(){if(null!=j.onSelectionChanged&&"function"==typeof j.onSelectionChanged())return j.onSelectionChanged()(j.gridOptions,j.gridApi)},onCellClicked:function(a){if(null!=j.onCellClicked&&"function"==typeof j.onCellClicked())return j.onCellClicked()(a,j.gridOptions,j.gridApi)},onRowValueChanged:function(a){j.cellEditable&&(null!=j.onCellValueChanged&&"function"==typeof j.onCellValueChanged()&&j.onCellValueChanged()(j.gridOptions),"infinite"==j.gridOptions.rowModelType&&(j.api?(j.gridOptions.api.showLoadingOverlay(),j._saveData(a)):(j.undoChanges(),j.showAlert("danger","No script defined for cell edit"))))},onGridReady:function(a){if(console.log("the grid is now ready"),f(function(){j.gridOptions.api=a.api,j.gridApi=a.api},3e3),"function"==typeof j.onGridReady()&&j.onGridReady()(j),a.api.filterManager.availableFilters.text.CONTAINS="startsWith",void 0===j.rowData||null==j.rowData||j.rowData&&0==j.rowData.length?j.api?j._createNewDatasource():a.api.setRowData([]):a.api.sizeColumnsToFit(),this.columnsDefinition)for(var b=0;b<this.columnsDefinition.length;b++)this.columnsDefinition[b].hasOwnProperty("type")&&"numeric"==this.columnsDefinition[b].type&&(this.columnsDefinition[b].filter="number")},onGridSizeChanged:function(a){j.gridOptions.api.sizeColumnsToFit()},headerCellRenderer:function(b){return null!=j.onHeaderCellRenderer&&"function"==typeof j.onHeaderCellRenderer()?j.onHeaderCellRenderer()(b):a.instant(b.colDef.headerName)}},this.fixedHeight=void 0===this.fixedHeight||this.fixedHeight,this.style={},this.fixedHeight?(this.gridHeight=this.gridHeight?this.gridHeight:"500",this.style.height=this.gridHeight,this.style.clear="left",this.style.width="100%"):this.style.height="77%",this.refreshOnEdit=void 0!==this.refreshOnEdit&&this.refreshOnEdit,this.transport=this.transport?this.transport:"wss",this.disableDeleteRow=1!=this.enableDeleteRow,this.disableAddRow=1!=this.enableAddRow,this.mode="infinite"==this.gridOptions.rowModelType?"infinite":"normal",j.msgTag&&h.subscribe(this.onServerCall,j.msgTag,c),c.$on("updateGridData",function(a,b){j.broadcastData=b,j._createNewDatasource()})},this.closeAlert=function(){this.show=!1},this.showAlert=function(a,b){j.message={type:a,content:b},j.showError=!0,f(function(){j.showError=!1},5e3)},this._saveData=function(a){if(a.data&&a.data[j._dataIdentifierProperty]){var b=a.data;if(b.action="edit",this.editParams)for(var c in this.editParams)b[c]=this.editParams[c];h.gridHelper(j.api,b).then(function(a,b){j.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?(j.undoChanges(),a&&a.errorDetail?j.showAlert("danger",a.errorDetail):j.showAlert("danger","An error has occured")):j.refreshOnEdit&&j.onServerCall(a)},function(a){j.gridOptions.api.hideOverlay(),console.log("reject",a),j.showAlert("danger","An error has occured")})}else{var b=a.data;if(b.action="add",this.addParams)for(var c in this.addParams)b[c]=this.addParams[c];h.gridHelper(j.api,a.data).then(function(a,b){j.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?(j.undoChanges(),a&&a.errorDetail?j.showAlert("danger",a.errorDetail):j.showAlert("danger","An error has occured")):j.refreshOnEdit&&j.onServerCall(a)},function(a){j.gridOptions.api.hideOverlay(),console.log("reject",a),j.showAlert("danger","An error has occured")})}},this.onAddRow=function(){for(var a={},b=0;b<j.gridOptions.columnDefs.length;b++)a[j.gridOptions.columnDefs[b].field]="";j.gridOptions.api.insertItemsAtIndex(0,[a]),j.gridOptions.api.setFocusedCell(0,j.gridOptions.columnDefs[0].field),j.gridOptions.api.startEditingCell({rowIndex:0,colKey:j.gridOptions.columnDefs[0].field,charPress:j.gridOptions.columnDefs[0].field})},this.openConfirmationPopUp=function(){if(j.gridOptions.api.getSelectedNodes().length>0){e.open({animation:!0,component:"deleteConfirmation",size:"md",resolve:{grid:function(){return j}}})}},this.onRemoveRow=function(a){if("infinite"==j.gridOptions.rowModelType)if(j.api){for(var b=j.gridOptions.api.getSelectedNodes(),c=[],d=0;d<b.length;d++)c.push(b[d].data[j._dataIdentifierProperty]);if(c.length>0){j.gridOptions.api.showLoadingOverlay();var e={keys:c,action:"delete"};if(this.deleteParams)for(var a in this.deleteParams)e[a]=this.deleteParams[a];h.gridHelper(j.api,e).then(function(a,b){j.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?a&&a.errorDetail?j.showAlert("danger",a.errorDetail):j.showAlert("danger","An error has occured"):(j.showAlert("success","Row(s) deleted successfuly"),j.onServerCall(a))},function(a){j.gridOptions.api.hideOverlay(),console.log("reject",a),j.showAlert("danger","An error has occured")})}}else j.showAlert("danger","No script defined for delete row");else{var b=j.gridOptions.api.getSelectedNodes();j.gridOptions.api.removeItems(b)}},this.onServerCall=function(a){j.gridOptions.api.refreshInfiniteCache()},this.undoChanges=function(a){if(j.oldEditedValue){j.gridOptions.api.forEachNode(function(a){a.childIndex!=j.editedChildIndex&&a.id!=j.editedChildIndex||a.setSelected(!0,!0)});j.gridOptions.api.getSelectedNodes()[0].data[j.editedColumn]=j.oldEditedValue,j.gridOptions.api.refreshView()}else j.gridOptions.api.refreshInfiniteCache()},this.onFilterChanged=function(){this.gridOptions.enableServerSideFilter=!1,this.gridOptions.api.setQuickFilter(this.quickFilterValue),this.gridOptions.enableServerSideFilter=!0},this.onServerFilterChanged=function(){j._createNewDatasource()},this.buildParams=function(a){var b=j.serverFilterText,c=null,d=a.endRow/this.gridOptions.paginationPageSize;if(a.sortModel&&a.sortModel.length>0){var e=a.sortModel[0].sort,f=a.sortModel[0].colId;c=this.gridOptions.api.getColumnDef(f).type?this.gridOptions.api.getColumnDef(f).type:null}if(a.filterModel)for(p in a.filterModel){b=a.filterModel[p].filter;var g=a.filterModel[p].type,h=p;c=this.gridOptions.api.getColumnDef(h).type?this.gridOptions.api.getColumnDef(h).type:null}var k={resultsPerPage:this.gridOptions.paginationPageSize,pageNumber:d};if(f&&(k.sortingColumnName=f),h&&(k.filterColumnName=h),e&&(k.sort=e),c&&(k.sortType=c),b&&(k.queryFilter=b),g&&(k.queryType=g),k.startRow=a.startRow,k.endRow=a.endRow,this.apiParams)for(var l in this.apiParams)k[l]=this.apiParams[l];return j.useWindowParams&&"true"==j.useWindowParams&&(k=angular.merge(k,i)),k}}]}),angular.module("Grid").service("dataStore",["httpClient","wsClient","$q",function(a,b,c){this.subscribe=function(a,c,d){b.onReady.then(function(){b.subscribe(c,a.bind(self),d.$id)})},this.gridHelper=function(b,d){var e=c.defer();return a.get(b,d,"grid").then(function(a,b){e.resolve(a,b)},function(a){e.reject(a)}),e.promise},this.getGridData=function(d,e,f,g){var h=c.defer();return"https"==f?(a.get(d,e).then(function(a,b){if(g&&(a=g(a)),a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)}),h.promise):"wss"==f?d&&void 0!==d?(b.onReady.then(function(){b.call(d,e,"grid").then(function(a,b){if(g&&(a=g(a)),a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)})}),h.promise):(b.onReady.then(function(){b.publish(e,"publish").then(function(a,b){if(a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)})}),h.promise):void 0}}]),angular.module("Grid").component("deleteConfirmation",{bindings:{resolve:"<",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/grid/popup.html",controller:["$scope",function(a){this.onSubmit=function(){this.resolve.grid.onRemoveRow(),this.close({$value:!0})},this.onCancel=function(){this.dismiss({$value:!1})}}]}),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Dygraph=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.prependListener=k,n.prependOnceListener=k,n.listeners=function(a){return[]},n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./bars"),e=function(a){return a&&a.__esModule?a:{default:a}}(d),f=function(){};f.prototype=new e.default,f.prototype.extractSeries=function(a,b,c){for(var d,e,f,g=[],h=c.get("logscale"),i=0;i<a.length;i++)d=a[i][0],f=a[i][b],h&&null!==f&&(f[0]<=0||f[1]<=0||f[2]<=0)&&(f=null),null!==f?(e=f[1],null===e||isNaN(e)?g.push([d,e,[e,e]]):g.push([d,e,[f[0],f[2]]])):g.push([d,null,[null,null]]);return g},f.prototype.rollingAverage=function(a,b,c){b=Math.min(b,a.length);var d,e,f,g,h,i,j,k=[];for(e=0,g=0,f=0,h=0,i=0;i<a.length;i++){if(d=a[i][1],j=a[i][2],k[i]=a[i],null===d||isNaN(d)||(e+=j[0],g+=d,f+=j[1],h+=1),i-b>=0){var l=a[i-b];null===l[1]||isNaN(l[1])||(e-=l[2][0],g-=l[1],f-=l[2][1],h-=1)}k[i]=h?[a[i][0],1*g/h,[1*e/h,1*f/h]]:[a[i][0],null,[null,null]]}return k},c.default=f,b.exports=c.default},{"./bars":5}],3:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./bars"),e=function(a){return a&&a.__esModule?a:{default:a}}(d),f=function(){};f.prototype=new e.default,f.prototype.extractSeries=function(a,b,c){for(var d,e,f,g,h=[],i=c.get("sigma"),j=c.get("logscale"),k=0;k<a.length;k++)d=a[k][0],g=a[k][b],j&&null!==g&&(g[0]<=0||g[0]-i*g[1]<=0)&&(g=null),null!==g?(e=g[0],null===e||isNaN(e)?h.push([d,e,[e,e,e]]):(f=i*g[1],h.push([d,e,[e-f,e+f,g[1]]]))):h.push([d,null,[null,null,null]]);return h},f.prototype.rollingAverage=function(a,b,c){b=Math.min(b,a.length);var d,e,f,g,h,i,j,k,l,m=[],n=c.get("sigma");for(d=0;d<a.length;d++){for(h=0,k=0,i=0,e=Math.max(0,d-b+1);e<d+1;e++)null===(f=a[e][1])||isNaN(f)||(i++,h+=f,k+=Math.pow(a[e][2][2],2));i?(j=Math.sqrt(k)/i,l=h/i,m[d]=[a[d][0],l,[l-n*j,l+n*j]]):(g=1==b?a[d][1]:null,m[d]=[a[d][0],g,[g,g]])}return m},c.default=f,b.exports=c.default},{"./bars":5}],4:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./bars"),e=function(a){return a&&a.__esModule?a:{default:a}}(d),f=function(){};f.prototype=new e.default,f.prototype.extractSeries=function(a,b,c){for(var d,e,f,g,h,i,j,k,l=[],m=c.get("sigma"),n=c.get("logscale"),o=0;o<a.length;o++)d=a[o][0],f=a[o][b],n&&null!==f&&(f[0]<=0||f[1]<=0)&&(f=null),null!==f?(g=f[0],h=f[1],null===g||isNaN(g)?l.push([d,g,[g,g,g,h]]):(i=h?g/h:0,j=h?m*Math.sqrt(i*(1-i)/h):1,k=100*j,e=100*i,l.push([d,e,[e-k,e+k,g,h]]))):l.push([d,null,[null,null,null,null]]);return l},f.prototype.rollingAverage=function(a,b,c){b=Math.min(b,a.length);var d,e,f,g,h=[],i=c.get("sigma"),j=c.get("wilsonInterval"),k=0,l=0;for(f=0;f<a.length;f++){k+=a[f][2][2],l+=a[f][2][3],f-b>=0&&(k-=a[f-b][2][2],l-=a[f-b][2][3]);var m=a[f][0],n=l?k/l:0;if(j)if(l){var o=n<0?0:n,p=l,q=i*Math.sqrt(o*(1-o)/p+i*i/(4*p*p)),r=1+i*i/l;d=(o+i*i/(2*l)-q)/r,e=(o+i*i/(2*l)+q)/r,h[f]=[m,100*o,[100*d,100*e]]}else h[f]=[m,0,[0,0]];else g=l?i*Math.sqrt(n*(1-n)/l):1,h[f]=[m,100*n,[100*(n-g),100*(n+g)]]}return h},c.default=f,b.exports=c.default},{"./bars":5}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./datahandler"),f=d(e),g=a("../dygraph-layout"),h=d(g),i=function(){f.default.call(this)};i.prototype=new f.default,i.prototype.extractSeries=function(a,b,c){},i.prototype.rollingAverage=function(a,b,c){},i.prototype.onPointsCreated_=function(a,b){for(var c=0;c<a.length;++c){var d=a[c],e=b[c];e.y_top=NaN,e.y_bottom=NaN,e.yval_minus=f.default.parseFloat(d[2][0]),e.yval_plus=f.default.parseFloat(d[2][1])}},i.prototype.getExtremeYValues=function(a,b,c){for(var d,e=null,f=null,g=a.length-1,h=0;h<=g;h++)if(null!==(d=a[h][1])&&!isNaN(d)){var i=a[h][2][0],j=a[h][2][1];i>d&&(i=d),j<d&&(j=d),(null===f||j>f)&&(f=j),(null===e||i<e)&&(e=i)}return[e,f]},i.prototype.onLineEvaluated=function(a,b,c){for(var d,e=0;e<a.length;e++)d=a[e],d.y_top=h.default.calcYNormal_(b,d.yval_minus,c),d.y_bottom=h.default.calcYNormal_(b,d.yval_plus,c)},c.default=i,b.exports=c.default},{"../dygraph-layout":13,"./datahandler":6}],6:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(){},e=d;e.X=0,e.Y=1,e.EXTRAS=2,e.prototype.extractSeries=function(a,b,c){},e.prototype.seriesToPoints=function(a,b,c){for(var d=[],f=0;f<a.length;++f){var g=a[f],h=g[1],i=null===h?null:e.parseFloat(h),j={x:NaN,y:NaN,xval:e.parseFloat(g[0]),yval:i,name:b,idx:f+c};d.push(j)}return this.onPointsCreated_(a,d),d},e.prototype.onPointsCreated_=function(a,b){},e.prototype.rollingAverage=function(a,b,c){},e.prototype.getExtremeYValues=function(a,b,c){},e.prototype.onLineEvaluated=function(a,b,c){},e.parseFloat=function(a){return null===a?NaN:a},c.default=d,b.exports=c.default},{}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./datahandler"),f=(d(e),a("./default")),g=d(f),h=function(){};h.prototype=new g.default,h.prototype.extractSeries=function(a,b,c){for(var d,e,f,g,h,i,j=[],k=c.get("logscale"),l=0;l<a.length;l++)d=a[l][0],f=a[l][b],k&&null!==f&&(f[0]<=0||f[1]<=0)&&(f=null),null!==f?(g=f[0],h=f[1],null===g||isNaN(g)?j.push([d,g,[g,h]]):(i=h?g/h:0,e=100*i,j.push([d,e,[g,h]]))):j.push([d,null,[null,null]]);return j},h.prototype.rollingAverage=function(a,b,c){b=Math.min(b,a.length);var d,e=[],f=0,g=0;for(d=0;d<a.length;d++){f+=a[d][2][0],g+=a[d][2][1],d-b>=0&&(f-=a[d-b][2][0],g-=a[d-b][2][1]);var h=a[d][0],i=g?f/g:0;e[d]=[h,100*i]}return e},c.default=h,b.exports=c.default},{"./datahandler":6,"./default":8}],8:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./datahandler"),e=function(a){return a&&a.__esModule?a:{default:a}}(d),f=function(){};f.prototype=new e.default,f.prototype.extractSeries=function(a,b,c){for(var d=[],e=c.get("logscale"),f=0;f<a.length;f++){var g=a[f][0],h=a[f][b];e&&h<=0&&(h=null),d.push([g,h])}return d},f.prototype.rollingAverage=function(a,b,c){b=Math.min(b,a.length);var d,e,f,g,h,i=[];if(1==b)return a;for(d=0;d<a.length;d++){for(g=0,h=0,e=Math.max(0,d-b+1);e<d+1;e++)null===(f=a[e][1])||isNaN(f)||(h++,g+=a[e][1]);i[d]=h?[a[d][0],g/h]:[a[d][0],null]}return i},f.prototype.getExtremeYValues=function(a,b,c){for(var d,e=null,f=null,g=a.length-1,h=0;h<=g;h++)null===(d=a[h][1])||isNaN(d)||((null===f||d>f)&&(f=d),(null===e||d<e)&&(e=d));return[e,f]},c.default=f,b.exports=c.default},{"./datahandler":6}],9:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./dygraph-utils"),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=a("./dygraph"),g=function(a){return a&&a.__esModule?a:{default:a}}(f),h=function(a,b,c,d){if(this.dygraph_=a,this.layout=d,this.element=b,this.elementContext=c,this.height=a.height_,this.width=a.width_,!e.isCanvasSupported(this.element))throw"Canvas is not supported.";this.area=d.getPlotArea();var f=this.dygraph_.canvas_ctx_;f.beginPath(),f.rect(this.area.x,this.area.y,this.area.w,this.area.h),f.clip(),f=this.dygraph_.hidden_ctx_,f.beginPath(),f.rect(this.area.x,this.area.y,this.area.w,this.area.h),f.clip()};h.prototype.clear=function(){this.elementContext.clearRect(0,0,this.width,this.height)},h.prototype.render=function(){this._updatePoints(),this._renderLineChart()},h._getIteratorPredicate=function(a){return a?h._predicateThatSkipsEmptyPoints:null},h._predicateThatSkipsEmptyPoints=function(a,b){return null!==a[b].yval},h._drawStyledLine=function(a,b,c,d,f,g,i){var j=a.dygraph,k=j.getBooleanOption("stepPlot",a.setName);e.isArrayLike(d)||(d=null);var l=j.getBooleanOption("drawGapEdgePoints",a.setName),m=a.points,n=a.setName,o=e.createIterator(m,0,m.length,h._getIteratorPredicate(j.getBooleanOption("connectSeparatedPoints",n))),p=d&&d.length>=2,q=a.drawingContext;q.save(),p&&q.setLineDash&&q.setLineDash(d);var r=h._drawSeries(a,o,c,i,f,l,k,b);h._drawPointsOnLine(a,r,g,b,i),p&&q.setLineDash&&q.setLineDash([]),q.restore()},h._drawSeries=function(a,b,c,d,e,f,g,h){var i,j,k=null,l=null,m=null,n=[],o=!0,p=a.drawingContext;p.beginPath(),p.strokeStyle=h,p.lineWidth=c;for(var q=b.array_,r=b.end_,s=b.predicate_,t=b.start_;t<r;t++){if(j=q[t],s){for(;t<r&&!s(q,t);)t++;if(t==r)break;j=q[t]}if(null===j.canvasy||j.canvasy!=j.canvasy)g&&null!==k&&(p.moveTo(k,l),p.lineTo(j.canvasx,l)),k=l=null;else{if(i=!1,f||null===k){b.nextIdx_=t,b.next(),m=b.hasNext?b.peek.canvasy:null;var u=null===m||m!=m;i=null===k&&u,f&&(!o&&null===k||b.hasNext&&u)&&(i=!0)}null!==k?c&&(g&&(p.moveTo(k,l),p.lineTo(j.canvasx,l)),p.lineTo(j.canvasx,j.canvasy)):p.moveTo(j.canvasx,j.canvasy),(e||i)&&n.push([j.canvasx,j.canvasy,j.idx]),k=j.canvasx,l=j.canvasy}o=!1}return p.stroke(),n},h._drawPointsOnLine=function(a,b,c,d,e){for(var f=a.drawingContext,g=0;g<b.length;g++){var h=b[g];f.save(),c.call(a.dygraph,a.dygraph,a.setName,f,h[0],h[1],d,e,h[2]),f.restore()}},h.prototype._updatePoints=function(){for(var a=this.layout.points,b=a.length;b--;)for(var c=a[b],d=c.length;d--;){var e=c[d];e.canvasx=this.area.w*e.x+this.area.x,e.canvasy=this.area.h*e.y+this.area.y}},h.prototype._renderLineChart=function(a,b){var c,d,f=b||this.elementContext,g=this.layout.points,h=this.layout.setNames;this.colors=this.dygraph_.colorsMap_;var i=this.dygraph_.getOption("plotter"),j=i;e.isArrayLike(j)||(j=[j]);var k={};for(c=0;c<h.length;c++){d=h[c];var l=this.dygraph_.getOption("plotter",d);l!=i&&(k[d]=l)}for(c=0;c<j.length;c++)for(var m=j[c],n=c==j.length-1,o=0;o<g.length;o++)if(d=h[o],!a||d==a){var p=g[o],q=m;if(d in k){if(!n)continue;q=k[d]}var r=this.colors[d],s=this.dygraph_.getOption("strokeWidth",d);f.save(),f.strokeStyle=r,f.lineWidth=s,q({points:p,setName:d,drawingContext:f,color:r,strokeWidth:s,dygraph:this.dygraph_,axis:this.dygraph_.axisPropertiesForSeries(d),plotArea:this.area,seriesIndex:o,seriesCount:g.length,singleSeriesName:a,allSeriesPoints:g}),f.restore()}},h._Plotters={linePlotter:function(a){h._linePlotter(a)},fillPlotter:function(a){h._fillPlotter(a)},errorPlotter:function(a){h._errorPlotter(a)}},h._linePlotter=function(a){var b=a.dygraph,c=a.setName,d=a.strokeWidth,f=b.getNumericOption("strokeBorderWidth",c),g=b.getOption("drawPointCallback",c)||e.Circles.DEFAULT,i=b.getOption("strokePattern",c),j=b.getBooleanOption("drawPoints",c),k=b.getNumericOption("pointSize",c);f&&d&&h._drawStyledLine(a,b.getOption("strokeBorderColor",c),d+2*f,i,j,g,k),h._drawStyledLine(a,a.color,d,i,j,g,k)},h._errorPlotter=function(a){var b=a.dygraph,c=a.setName;if(b.getBooleanOption("errorBars")||b.getBooleanOption("customBars")){b.getBooleanOption("fillGraph",c)&&console.warn("Can't use fillGraph option with error bars");var d,f=a.drawingContext,g=a.color,i=b.getNumericOption("fillAlpha",c),j=b.getBooleanOption("stepPlot",c),k=a.points,l=e.createIterator(k,0,k.length,h._getIteratorPredicate(b.getBooleanOption("connectSeparatedPoints",c))),m=NaN,n=NaN,o=[-1,-1],p=e.toRGB_(g),q="rgba("+p.r+","+p.g+","+p.b+","+i+")";f.fillStyle=q,f.beginPath();for(var r=function(a){return null===a||void 0===a||isNaN(a)};l.hasNext;){var s=l.next();!j&&r(s.y)||j&&!isNaN(n)&&r(n)?m=NaN:(d=[s.y_bottom,s.y_top],j&&(n=s.y),isNaN(d[0])&&(d[0]=s.y),isNaN(d[1])&&(d[1]=s.y),d[0]=a.plotArea.h*d[0]+a.plotArea.y,d[1]=a.plotArea.h*d[1]+a.plotArea.y,isNaN(m)||(j?(f.moveTo(m,o[0]),f.lineTo(s.canvasx,o[0]),f.lineTo(s.canvasx,o[1])):(f.moveTo(m,o[0]),f.lineTo(s.canvasx,d[0]),f.lineTo(s.canvasx,d[1])),f.lineTo(m,o[1]),f.closePath()),o=d,m=s.canvasx)}f.fill()}},h._fastCanvasProxy=function(a){var b=[],c=null,d=null,e=0,f=function(a){if(!(b.length<=1)){for(var c=b.length-1;c>0;c--){var d=b[c];if(2==d[0]){var e=b[c-1];e[1]==d[1]&&e[2]==d[2]&&b.splice(c,1)}}for(var c=0;c<b.length-1;){var d=b[c];2==d[0]&&2==b[c+1][0]?b.splice(c,1):c++}if(b.length>2&&!a){var f=0;2==b[0][0]&&f++;for(var g=null,h=null,c=f;c<b.length;c++){var d=b[c];if(1==d[0])if(null===g&&null===h)g=c,h=c;else{var i=d[2];i<b[g][2]?g=c:i>b[h][2]&&(h=c)}}var j=b[g],k=b[h];b.splice(f,b.length-f),g<h?(b.push(j),b.push(k)):g>h?(b.push(k),b.push(j)):b.push(j)}}},g=function(c){f(c);for(var g=0,h=b.length;g<h;g++){var i=b[g];1==i[0]?a.lineTo(i[1],i[2]):2==i[0]&&a.moveTo(i[1],i[2])}b.length&&(d=b[b.length-1][1]),e+=b.length,b=[]},h=function(a,e,f){var h=Math.round(e);if(null===c||h!=c){var i=c-d>1,j=h-c>1;g(i||j),c=h}b.push([a,e,f])};return{moveTo:function(a,b){h(2,a,b)},lineTo:function(a,b){h(1,a,b)},stroke:function(){g(!0),a.stroke()},fill:function(){g(!0),a.fill()},beginPath:function(){g(!0),a.beginPath()},closePath:function(){g(!0),a.closePath()},_count:function(){return e}}},h._fillPlotter=function(a){if(!a.singleSeriesName&&0===a.seriesIndex){for(var b=a.dygraph,c=b.getLabels().slice(1),d=c.length;d>=0;d--)b.visibility()[d]||c.splice(d,1);if(function(){for(var a=0;a<c.length;a++)if(b.getBooleanOption("fillGraph",c[a]))return!0;return!1}())for(var f,i,j=a.plotArea,k=a.allSeriesPoints,l=k.length,m=b.getBooleanOption("stackedGraph"),n=b.getColors(),o={},p=function(a,b,c,d){if(a.lineTo(b,c),m)for(var e=d.length-1;e>=0;e--){var f=d[e];a.lineTo(f[0],f[1])}},q=l-1;q>=0;q--){var r=a.drawingContext,s=c[q];if(b.getBooleanOption("fillGraph",s)){var t=b.getNumericOption("fillAlpha",s),u=b.getBooleanOption("stepPlot",s),v=n[q],w=b.axisPropertiesForSeries(s),x=1+w.minyval*w.yscale;x<0?x=0:x>1&&(x=1),x=j.h*x+j.y;var y,z=k[q],A=e.createIterator(z,0,z.length,h._getIteratorPredicate(b.getBooleanOption("connectSeparatedPoints",s))),B=NaN,C=[-1,-1],D=e.toRGB_(v),E="rgba("+D.r+","+D.g+","+D.b+","+t+")";r.fillStyle=E,r.beginPath();var F,G=!0;(z.length>2*b.width_||g.default.FORCE_FAST_PROXY)&&(r=h._fastCanvasProxy(r));for(var H,I=[];A.hasNext;)if(H=A.next(),e.isOK(H.y)||u){if(m){if(!G&&F==H.xval)continue;G=!1,F=H.xval,f=o[H.canvasx];var J;J=void 0===f?x:i?f[0]:f,y=[H.canvasy,J],u?-1===C[0]?o[H.canvasx]=[H.canvasy,x]:o[H.canvasx]=[H.canvasy,C[0]]:o[H.canvasx]=H.canvasy}else y=isNaN(H.canvasy)&&u?[j.y+j.h,x]:[H.canvasy,x];isNaN(B)?(r.moveTo(H.canvasx,y[1]),
r.lineTo(H.canvasx,y[0])):(u?(r.lineTo(H.canvasx,C[0]),r.lineTo(H.canvasx,y[0])):r.lineTo(H.canvasx,y[0]),m&&(I.push([B,C[1]]),i&&f?I.push([H.canvasx,f[1]]):I.push([H.canvasx,y[1]]))),C=y,B=H.canvasx}else p(r,B,C[1],I),I=[],B=NaN,null===H.y_stacked||isNaN(H.y_stacked)||(o[H.canvasx]=j.h*H.y_stacked+j.y);i=u,y&&H&&(p(r,H.canvasx,y[1],I),I=[]),r.fill()}}}},c.default=h,b.exports=c.default},{"./dygraph":18,"./dygraph-utils":17}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./dygraph-tickers"),g=e(f),h=a("./dygraph-interaction-model"),i=d(h),j=a("./dygraph-canvas"),k=d(j),l=a("./dygraph-utils"),m=e(l),n={highlightCircleSize:3,highlightSeriesOpts:null,highlightSeriesBackgroundAlpha:.5,highlightSeriesBackgroundColor:"rgb(255, 255, 255)",labelsSeparateLines:!1,labelsShowZeroValues:!0,labelsKMB:!1,labelsKMG2:!1,showLabelsOnHighlight:!0,digitsAfterDecimal:2,maxNumberWidth:6,sigFigs:null,strokeWidth:1,strokeBorderWidth:0,strokeBorderColor:"white",axisTickSize:3,axisLabelFontSize:14,rightGap:5,showRoller:!1,offset:0,xValueParser:void 0,delimiter:",",sigma:2,errorBars:!1,fractions:!1,wilsonInterval:!0,customBars:!1,fillGraph:!1,fillAlpha:.15,connectSeparatedPoints:!1,stackedGraph:!1,stackedGraphNaNFill:"all",hideOverlayOnMouseOut:!0,legend:"onmouseover",stepPlot:!1,xRangePad:0,yRangePad:null,drawAxesAtZero:!1,titleHeight:28,xLabelHeight:18,yLabelWidth:18,axisLineColor:"black",axisLineWidth:.3,gridLineWidth:.3,axisLabelWidth:75,gridLineColor:"rgb(128,128,128)",interactionModel:i.default.defaultModel,animatedZooms:!1,showRangeSelector:!1,rangeSelectorHeight:40,rangeSelectorPlotStrokeColor:"#808FAB",rangeSelectorPlotFillGradientColor:"white",rangeSelectorPlotFillColor:"#A7B1C4",rangeSelectorBackgroundStrokeColor:"gray",rangeSelectorBackgroundLineWidth:1,rangeSelectorPlotLineWidth:1.5,rangeSelectorForegroundStrokeColor:"black",rangeSelectorForegroundLineWidth:1,rangeSelectorAlpha:.6,showInRangeSelector:null,plotter:[k.default._fillPlotter,k.default._errorPlotter,k.default._linePlotter],plugins:[],axes:{x:{pixelsPerLabel:70,axisLabelWidth:60,axisLabelFormatter:m.dateAxisLabelFormatter,valueFormatter:m.dateValueFormatter,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:g.dateTicker},y:{axisLabelWidth:75,pixelsPerLabel:30,valueFormatter:function(a){return parseFloat(a)},axisLabelFormatter:function(a){return parseFloat(a)},drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:g.numericTicks},y2:{axisLabelWidth:75,pixelsPerLabel:30,valueFormatter:function(a){return parseFloat(a)},axisLabelFormatter:function(a){return parseFloat(a)},drawAxis:!0,drawGrid:!1,independentTicks:!1,ticker:g.numericTicks}}};c.default=n,b.exports=c.default},{"./dygraph-canvas":9,"./dygraph-interaction-model":12,"./dygraph-tickers":16,"./dygraph-utils":17}],11:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./dygraph"),e=function(a){return a&&a.__esModule?a:{default:a}}(d),f=function(a){this.container=a};f.prototype.draw=function(a,b){this.container.innerHTML="",void 0!==this.date_graph&&this.date_graph.destroy(),this.date_graph=new e.default(this.container,a,b)},f.prototype.setSelection=function(a){var b=!1;a.length&&(b=a[0].row),this.date_graph.setSelection(b)},f.prototype.getSelection=function(){var a=[],b=this.date_graph.getSelection();if(b<0)return a;for(var c=this.date_graph.layout_.points,d=0;d<c.length;++d)a.push({row:b,column:d+1});return a},c.default=f,b.exports=c.default},{"./dygraph":18}],12:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./dygraph-utils"),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f={};f.maybeTreatMouseOpAsClick=function(a,b,c){c.dragEndX=e.dragGetX_(a,c),c.dragEndY=e.dragGetY_(a,c);var d=Math.abs(c.dragEndX-c.dragStartX),g=Math.abs(c.dragEndY-c.dragStartY);d<2&&g<2&&void 0!==b.lastx_&&-1!=b.lastx_&&f.treatMouseOpAsClick(b,a,c),c.regionWidth=d,c.regionHeight=g},f.startPan=function(a,b,c){var d,f;c.isPanning=!0;var g=b.xAxisRange();if(b.getOptionForAxis("logscale","x")?(c.initialLeftmostDate=e.log10(g[0]),c.dateRange=e.log10(g[1])-e.log10(g[0])):(c.initialLeftmostDate=g[0],c.dateRange=g[1]-g[0]),c.xUnitsPerPixel=c.dateRange/(b.plotter_.area.w-1),b.getNumericOption("panEdgeFraction")){var h=b.width_*b.getNumericOption("panEdgeFraction"),i=b.xAxisExtremes(),j=b.toDomXCoord(i[0])-h,k=b.toDomXCoord(i[1])+h,l=b.toDataXCoord(j),m=b.toDataXCoord(k);c.boundedDates=[l,m];var n=[],o=b.height_*b.getNumericOption("panEdgeFraction");for(d=0;d<b.axes_.length;d++){f=b.axes_[d];var p=f.extremeRange,q=b.toDomYCoord(p[0],d)+o,r=b.toDomYCoord(p[1],d)-o,s=b.toDataYCoord(q,d),t=b.toDataYCoord(r,d);n[d]=[s,t]}c.boundedValues=n}for(c.is2DPan=!1,c.axes=[],d=0;d<b.axes_.length;d++){f=b.axes_[d];var u={},v=b.yAxisRange(d);b.attributes_.getForAxis("logscale",d)?(u.initialTopValue=e.log10(v[1]),u.dragValueRange=e.log10(v[1])-e.log10(v[0])):(u.initialTopValue=v[1],u.dragValueRange=v[1]-v[0]),u.unitsPerPixel=u.dragValueRange/(b.plotter_.area.h-1),c.axes.push(u),f.valueRange&&(c.is2DPan=!0)}},f.movePan=function(a,b,c){c.dragEndX=e.dragGetX_(a,c),c.dragEndY=e.dragGetY_(a,c);var d=c.initialLeftmostDate-(c.dragEndX-c.dragStartX)*c.xUnitsPerPixel;c.boundedDates&&(d=Math.max(d,c.boundedDates[0]));var f=d+c.dateRange;if(c.boundedDates&&f>c.boundedDates[1]&&(d-=f-c.boundedDates[1],f=d+c.dateRange),b.getOptionForAxis("logscale","x")?b.dateWindow_=[Math.pow(e.LOG_SCALE,d),Math.pow(e.LOG_SCALE,f)]:b.dateWindow_=[d,f],c.is2DPan)for(var g=c.dragEndY-c.dragStartY,h=0;h<b.axes_.length;h++){var i=b.axes_[h],j=c.axes[h],k=g*j.unitsPerPixel,l=c.boundedValues?c.boundedValues[h]:null,m=j.initialTopValue+k;l&&(m=Math.min(m,l[1]));var n=m-j.dragValueRange;l&&n<l[0]&&(m-=n-l[0],n=m-j.dragValueRange),b.attributes_.getForAxis("logscale",h)?i.valueRange=[Math.pow(e.LOG_SCALE,n),Math.pow(e.LOG_SCALE,m)]:i.valueRange=[n,m]}b.drawGraph_(!1)},f.endPan=f.maybeTreatMouseOpAsClick,f.startZoom=function(a,b,c){c.isZooming=!0,c.zoomMoved=!1},f.moveZoom=function(a,b,c){c.zoomMoved=!0,c.dragEndX=e.dragGetX_(a,c),c.dragEndY=e.dragGetY_(a,c);var d=Math.abs(c.dragStartX-c.dragEndX),f=Math.abs(c.dragStartY-c.dragEndY);c.dragDirection=d<f/2?e.VERTICAL:e.HORIZONTAL,b.drawZoomRect_(c.dragDirection,c.dragStartX,c.dragEndX,c.dragStartY,c.dragEndY,c.prevDragDirection,c.prevEndX,c.prevEndY),c.prevEndX=c.dragEndX,c.prevEndY=c.dragEndY,c.prevDragDirection=c.dragDirection},f.treatMouseOpAsClick=function(a,b,c){for(var d=a.getFunctionOption("clickCallback"),e=a.getFunctionOption("pointClickCallback"),f=null,g=-1,h=Number.MAX_VALUE,i=0;i<a.selPoints_.length;i++){var j=a.selPoints_[i],k=Math.pow(j.canvasx-c.dragEndX,2)+Math.pow(j.canvasy-c.dragEndY,2);!isNaN(k)&&(-1==g||k<h)&&(h=k,g=i)}var l=a.getNumericOption("highlightCircleSize")+2;if(h<=l*l&&(f=a.selPoints_[g]),f){var m={cancelable:!0,point:f,canvasx:c.dragEndX,canvasy:c.dragEndY};if(a.cascadeEvents_("pointClick",m))return;e&&e.call(a,b,f)}var m={cancelable:!0,xval:a.lastx_,pts:a.selPoints_,canvasx:c.dragEndX,canvasy:c.dragEndY};a.cascadeEvents_("click",m)||d&&d.call(a,b,a.lastx_,a.selPoints_)},f.endZoom=function(a,b,c){b.clearZoomRect_(),c.isZooming=!1,f.maybeTreatMouseOpAsClick(a,b,c);var d=b.getArea();if(c.regionWidth>=10&&c.dragDirection==e.HORIZONTAL){var g=Math.min(c.dragStartX,c.dragEndX),h=Math.max(c.dragStartX,c.dragEndX);g=Math.max(g,d.x),h=Math.min(h,d.x+d.w),g<h&&b.doZoomX_(g,h),c.cancelNextDblclick=!0}else if(c.regionHeight>=10&&c.dragDirection==e.VERTICAL){var i=Math.min(c.dragStartY,c.dragEndY),j=Math.max(c.dragStartY,c.dragEndY);i=Math.max(i,d.y),j=Math.min(j,d.y+d.h),i<j&&b.doZoomY_(i,j),c.cancelNextDblclick=!0}c.dragStartX=null,c.dragStartY=null},f.startTouch=function(a,b,c){a.preventDefault(),a.touches.length>1&&(c.startTimeForDoubleTapMs=null);for(var d=[],e=0;e<a.touches.length;e++){var f=a.touches[e];d.push({pageX:f.pageX,pageY:f.pageY,dataX:b.toDataXCoord(f.pageX),dataY:b.toDataYCoord(f.pageY)})}if(c.initialTouches=d,1==d.length)c.initialPinchCenter=d[0],c.touchDirections={x:!0,y:!0};else if(d.length>=2){c.initialPinchCenter={pageX:.5*(d[0].pageX+d[1].pageX),pageY:.5*(d[0].pageY+d[1].pageY),dataX:.5*(d[0].dataX+d[1].dataX),dataY:.5*(d[0].dataY+d[1].dataY)};var g=180/Math.PI*Math.atan2(c.initialPinchCenter.pageY-d[0].pageY,d[0].pageX-c.initialPinchCenter.pageX);g=Math.abs(g),g>90&&(g=90-g),c.touchDirections={x:g<67.5,y:g>22.5}}c.initialRange={x:b.xAxisRange(),y:b.yAxisRange()}},f.moveTouch=function(a,b,c){c.startTimeForDoubleTapMs=null;var d,e=[];for(d=0;d<a.touches.length;d++){var f=a.touches[d];e.push({pageX:f.pageX,pageY:f.pageY})}var g,h=c.initialTouches,i=c.initialPinchCenter;g=1==e.length?e[0]:{pageX:.5*(e[0].pageX+e[1].pageX),pageY:.5*(e[0].pageY+e[1].pageY)};var j={pageX:g.pageX-i.pageX,pageY:g.pageY-i.pageY},k=c.initialRange.x[1]-c.initialRange.x[0],l=c.initialRange.y[0]-c.initialRange.y[1];j.dataX=j.pageX/b.plotter_.area.w*k,j.dataY=j.pageY/b.plotter_.area.h*l;var m,n;if(1==e.length)m=1,n=1;else if(e.length>=2){var o=h[1].pageX-i.pageX;m=(e[1].pageX-g.pageX)/o;var p=h[1].pageY-i.pageY;n=(e[1].pageY-g.pageY)/p}m=Math.min(8,Math.max(.125,m)),n=Math.min(8,Math.max(.125,n));var q=!1;if(c.touchDirections.x&&(b.dateWindow_=[i.dataX-j.dataX+(c.initialRange.x[0]-i.dataX)/m,i.dataX-j.dataX+(c.initialRange.x[1]-i.dataX)/m],q=!0),c.touchDirections.y)for(d=0;d<1;d++){var r=b.axes_[d],s=b.attributes_.getForAxis("logscale",d);s||(r.valueRange=[i.dataY-j.dataY+(c.initialRange.y[0]-i.dataY)/n,i.dataY-j.dataY+(c.initialRange.y[1]-i.dataY)/n],q=!0)}if(b.drawGraph_(!1),q&&e.length>1&&b.getFunctionOption("zoomCallback")){var t=b.xAxisRange();b.getFunctionOption("zoomCallback").call(b,t[0],t[1],b.yAxisRanges())}},f.endTouch=function(a,b,c){if(0!==a.touches.length)f.startTouch(a,b,c);else if(1==a.changedTouches.length){var d=(new Date).getTime(),e=a.changedTouches[0];c.startTimeForDoubleTapMs&&d-c.startTimeForDoubleTapMs<500&&c.doubleTapX&&Math.abs(c.doubleTapX-e.screenX)<50&&c.doubleTapY&&Math.abs(c.doubleTapY-e.screenY)<50?b.resetZoom():(c.startTimeForDoubleTapMs=d,c.doubleTapX=e.screenX,c.doubleTapY=e.screenY)}};var g=function(a,b,c){return a<b?b-a:a>c?a-c:0},h=function(a,b){var c=e.findPos(b.canvas_),d={left:c.x,right:c.x+b.canvas_.offsetWidth,top:c.y,bottom:c.y+b.canvas_.offsetHeight},f={x:e.pageX(a),y:e.pageY(a)},h=g(f.x,d.left,d.right),i=g(f.y,d.top,d.bottom);return Math.max(h,i)};f.defaultModel={mousedown:function(a,b,c){if(!a.button||2!=a.button){c.initializeMouseDown(a,b,c),a.altKey||a.shiftKey?f.startPan(a,b,c):f.startZoom(a,b,c);var d=function(a){if(c.isZooming){h(a,b)<100?f.moveZoom(a,b,c):null!==c.dragEndX&&(c.dragEndX=null,c.dragEndY=null,b.clearZoomRect_())}else c.isPanning&&f.movePan(a,b,c)},g=function a(g){c.isZooming?null!==c.dragEndX?f.endZoom(g,b,c):f.maybeTreatMouseOpAsClick(g,b,c):c.isPanning&&f.endPan(g,b,c),e.removeEvent(document,"mousemove",d),e.removeEvent(document,"mouseup",a),c.destroy()};b.addAndTrackEvent(document,"mousemove",d),b.addAndTrackEvent(document,"mouseup",g)}},willDestroyContextMyself:!0,touchstart:function(a,b,c){f.startTouch(a,b,c)},touchmove:function(a,b,c){f.moveTouch(a,b,c)},touchend:function(a,b,c){f.endTouch(a,b,c)},dblclick:function(a,b,c){if(c.cancelNextDblclick)return void(c.cancelNextDblclick=!1);var d={canvasx:c.dragEndX,canvasy:c.dragEndY,cancelable:!0};b.cascadeEvents_("dblclick",d)||a.altKey||a.shiftKey||b.resetZoom()}},f.nonInteractiveModel_={mousedown:function(a,b,c){c.initializeMouseDown(a,b,c)},mouseup:f.maybeTreatMouseOpAsClick},f.dragIsPanInteractionModel={mousedown:function(a,b,c){c.initializeMouseDown(a,b,c),f.startPan(a,b,c)},mousemove:function(a,b,c){c.isPanning&&f.movePan(a,b,c)},mouseup:function(a,b,c){c.isPanning&&f.endPan(a,b,c)}},c.default=f,b.exports=c.default},{"./dygraph-utils":17}],13:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./dygraph-utils"),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=function(a){this.dygraph_=a,this.points=[],this.setNames=[],this.annotations=[],this.yAxes_=null,this.xTicks_=null,this.yTicks_=null};f.prototype.addDataset=function(a,b){this.points.push(b),this.setNames.push(a)},f.prototype.getPlotArea=function(){return this.area_},f.prototype.computePlotArea=function(){var a={x:0,y:0};a.w=this.dygraph_.width_-a.x-this.dygraph_.getOption("rightGap"),a.h=this.dygraph_.height_;var b={chart_div:this.dygraph_.graphDiv,reserveSpaceLeft:function(b){var c={x:a.x,y:a.y,w:b,h:a.h};return a.x+=b,a.w-=b,c},reserveSpaceRight:function(b){var c={x:a.x+a.w-b,y:a.y,w:b,h:a.h};return a.w-=b,c},reserveSpaceTop:function(b){var c={x:a.x,y:a.y,w:a.w,h:b};return a.y+=b,a.h-=b,c},reserveSpaceBottom:function(b){var c={x:a.x,y:a.y+a.h-b,w:a.w,h:b};return a.h-=b,c},chartRect:function(){return{x:a.x,y:a.y,w:a.w,h:a.h}}};this.dygraph_.cascadeEvents_("layout",b),this.area_=a},f.prototype.setAnnotations=function(a){this.annotations=[];for(var b=this.dygraph_.getOption("xValueParser")||function(a){return a},c=0;c<a.length;c++){var d={};if(!a[c].xval&&void 0===a[c].x)return void console.error("Annotations must have an 'x' property");if(a[c].icon&&(!a[c].hasOwnProperty("width")||!a[c].hasOwnProperty("height")))return void console.error("Must set width and height when setting annotation.icon property");e.update(d,a[c]),d.xval||(d.xval=b(d.x)),this.annotations.push(d)}},f.prototype.setXTicks=function(a){this.xTicks_=a},f.prototype.setYAxes=function(a){this.yAxes_=a},f.prototype.evaluate=function(){this._xAxis={},this._evaluateLimits(),this._evaluateLineCharts(),this._evaluateLineTicks(),this._evaluateAnnotations()},f.prototype._evaluateLimits=function(){var a=this.dygraph_.xAxisRange();this._xAxis.minval=a[0],this._xAxis.maxval=a[1];var b=a[1]-a[0];this._xAxis.scale=0!==b?1/b:1,this.dygraph_.getOptionForAxis("logscale","x")&&(this._xAxis.xlogrange=e.log10(this._xAxis.maxval)-e.log10(this._xAxis.minval),this._xAxis.xlogscale=0!==this._xAxis.xlogrange?1/this._xAxis.xlogrange:1);for(var c=0;c<this.yAxes_.length;c++){var d=this.yAxes_[c];d.minyval=d.computedValueRange[0],d.maxyval=d.computedValueRange[1],d.yrange=d.maxyval-d.minyval,d.yscale=0!==d.yrange?1/d.yrange:1,this.dygraph_.getOption("logscale")&&(d.ylogrange=e.log10(d.maxyval)-e.log10(d.minyval),d.ylogscale=0!==d.ylogrange?1/d.ylogrange:1,isFinite(d.ylogrange)&&!isNaN(d.ylogrange)||console.error("axis "+c+" of graph at "+d.g+" can't be displayed in log scale for range ["+d.minyval+" - "+d.maxyval+"]"))}},f.calcXNormal_=function(a,b,c){return c?(e.log10(a)-e.log10(b.minval))*b.xlogscale:(a-b.minval)*b.scale},f.calcYNormal_=function(a,b,c){if(c){var d=1-(e.log10(b)-e.log10(a.minyval))*a.ylogscale;return isFinite(d)?d:NaN}return 1-(b-a.minyval)*a.yscale},f.prototype._evaluateLineCharts=function(){for(var a=this.dygraph_.getOption("stackedGraph"),b=this.dygraph_.getOptionForAxis("logscale","x"),c=0;c<this.points.length;c++){for(var d=this.points[c],e=this.setNames[c],g=this.dygraph_.getOption("connectSeparatedPoints",e),h=this.dygraph_.axisPropertiesForSeries(e),i=this.dygraph_.attributes_.getForSeries("logscale",e),j=0;j<d.length;j++){var k=d[j];k.x=f.calcXNormal_(k.xval,this._xAxis,b);var l=k.yval;a&&(k.y_stacked=f.calcYNormal_(h,k.yval_stacked,i),null===l||isNaN(l)||(l=k.yval_stacked)),null===l&&(l=NaN,g||(k.yval=NaN)),k.y=f.calcYNormal_(h,l,i)}this.dygraph_.dataHandler_.onLineEvaluated(d,h,i)}},f.prototype._evaluateLineTicks=function(){var a,b,c,d,e,f;for(this.xticks=[],a=0;a<this.xTicks_.length;a++)b=this.xTicks_[a],c=b.label,f=!("label_v"in b),e=f?b.v:b.label_v,(d=this.dygraph_.toPercentXCoord(e))>=0&&d<1&&this.xticks.push({pos:d,label:c,has_tick:f});for(this.yticks=[],a=0;a<this.yAxes_.length;a++)for(var g=this.yAxes_[a],h=0;h<g.ticks.length;h++)b=g.ticks[h],c=b.label,f=!("label_v"in b),e=f?b.v:b.label_v,(d=this.dygraph_.toPercentYCoord(e,a))>0&&d<=1&&this.yticks.push({axis:a,pos:d,label:c,has_tick:f})},f.prototype._evaluateAnnotations=function(){var a,b={};for(a=0;a<this.annotations.length;a++){var c=this.annotations[a];b[c.xval+","+c.series]=c}if(this.annotated_points=[],this.annotations&&this.annotations.length)for(var d=0;d<this.points.length;d++){var e=this.points[d];for(a=0;a<e.length;a++){var f=e[a],g=f.xval+","+f.name;g in b&&(f.annotation=b[g],this.annotated_points.push(f))}}},f.prototype.removeAllDatasets=function(){delete this.points,delete this.setNames,delete this.setPointsLengths,delete this.setPointsOffsets,this.points=[],this.setNames=[],this.setPointsLengths=[],this.setPointsOffsets=[]},c.default=f,b.exports=c.default},{"./dygraph-utils":17}],14:[function(a,b,c){(function(a){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=null;if(void 0!==a){d={xValueParser:{default:"parseFloat() or Date.parse()*",labels:["CSV parsing"],type:"function(str) -> number",description:"A function which parses x-values (i.e. the dependent series). Must return a number, even when the values are dates. In this case, millis since epoch are used. This is used primarily for parsing CSV data. *=Dygraphs is slightly more accepting in the dates which it will parse. See code for details."},stackedGraph:{default:"false",labels:["Data Line display"],type:"boolean",description:"If set, stack series on top of one another rather than drawing them independently. The first series specified in the input data will wind up on top of the chart and the last will be on bottom. NaN values are drawn as white areas without a line on top, see stackedGraphNaNFill for details."},stackedGraphNaNFill:{default:"all",labels:["Data Line display"],type:"string",description:'Controls handling of NaN values inside a stacked graph. NaN values are interpolated/extended for stacking purposes, but the actual point value remains NaN in the legend display. Valid option values are "all" (interpolate internally, repeat leftmost and rightmost value as needed), "inside" (interpolate internally only, use zero outside leftmost and rightmost value), and "none" (treat NaN as zero everywhere).'},pointSize:{default:"1",labels:["Data Line display"],type:"integer",description:'The size of the dot to draw on each point in pixels (see drawPoints). A dot is always drawn when a point is "isolated", i.e. there is a missing point on either side of it. This also controls the size of those dots.'},drawPoints:{default:"false",labels:["Data Line display"],type:"boolean",description:"Draw a small dot at each point, in addition to a line going through the point. This makes the individual data points easier to see, but can increase visual clutter in the chart. The small dot can be replaced with a custom rendering by supplying a <a href='#drawPointCallback'>drawPointCallback</a>."},drawGapEdgePoints:{default:"false",labels:["Data Line display"],type:"boolean",description:"Draw points at the edges of gaps in the data. This improves visibility of small data segments or other data irregularities."},drawPointCallback:{default:"null",labels:["Data Line display"],type:"function(g, seriesName, canvasContext, cx, cy, color, pointSize)",parameters:[["g","the reference graph"],["seriesName","the name of the series"],["canvasContext","the canvas to draw on"],["cx","center x coordinate"],["cy","center y coordinate"],["color","series color"],["pointSize","the radius of the image."],["idx","the row-index of the point in the data."]],description:"Draw a custom item when drawPoints is enabled. Default is a small dot matching the series color. This method should constrain drawing to within pointSize pixels from (cx, cy).  Also see <a href='#drawHighlightPointCallback'>drawHighlightPointCallback</a>"},height:{default:"320",labels:["Overall display"],type:"integer",description:"Height, in pixels, of the chart. If the container div has been explicitly sized, this will be ignored."},zoomCallback:{default:"null",labels:["Callbacks"],type:"function(minDate, maxDate, yRanges)",parameters:[["minDate","milliseconds since epoch"],["maxDate","milliseconds since epoch."],["yRanges","is an array of [bottom, top] pairs, one for each y-axis."]],description:"A function to call when the zoom window is changed (either by zooming in or out). When animatedZooms is set, zoomCallback is called once at the end of the transition (it will not be called for intermediate frames)."},pointClickCallback:{snippet:"function(e, point){<br>&nbsp;&nbsp;alert(point);<br>}",default:"null",labels:["Callbacks","Interactive Elements"],type:"function(e, point)",parameters:[["e","the event object for the click"],["point","the point that was clicked See <a href='#point_properties'>Point properties</a> for details"]],description:"A function to call when a data point is clicked. and the point that was clicked."},color:{default:"(see description)",labels:["Data Series Colors"],type:"string",example:"red",description:"A per-series color definition. Used in conjunction with, and overrides, the colors option."},colors:{default:"(see description)",labels:["Data Series Colors"],type:"array<string>",example:"['red', '#00FF00']",description:'List of colors for the data series. These can be of the form "#AABBCC" or "rgb(255,100,200)" or "yellow", etc. If not specified, equally-spaced points around a color wheel are used. Overridden by the \'color\' option.'},connectSeparatedPoints:{default:"false",labels:["Data Line display"],type:"boolean",description:"Usually, when Dygraphs encounters a missing value in a data series, it interprets this as a gap and draws it as such. If, instead, the missing values represents an x-value for which only a different series has data, then you'll want to connect the dots by setting this to true. To explicitly include a gap with this option set, use a value of NaN."},highlightCallback:{default:"null",labels:["Callbacks"],type:"function(event, x, points, row, seriesName)",description:"When set, this callback gets called every time a new point is highlighted.",parameters:[["event","the JavaScript mousemove event"],["x","the x-coordinate of the highlighted points"],["points","an array of highlighted points: <code>[ {name: 'series', yval: y-value}, &hellip; ]</code>"],["row","integer index of the highlighted row in the data table, starting from 0"],["seriesName","name of the highlighted series, only present if highlightSeriesOpts is set."]]},drawHighlightPointCallback:{default:"null",labels:["Data Line display"],type:"function(g, seriesName, canvasContext, cx, cy, color, pointSize)",parameters:[["g","the reference graph"],["seriesName","the name of the series"],["canvasContext","the canvas to draw on"],["cx","center x coordinate"],["cy","center y coordinate"],["color","series color"],["pointSize","the radius of the image."],["idx","the row-index of the point in the data."]],description:"Draw a custom item when a point is highlighted.  Default is a small dot matching the series color. This method should constrain drawing to within pointSize pixels from (cx, cy) Also see <a href='#drawPointCallback'>drawPointCallback</a>"},highlightSeriesOpts:{default:"null",labels:["Interactive Elements"],type:"Object",description:"When set, the options from this object are applied to the timeseries closest to the mouse pointer for interactive highlighting. See also 'highlightCallback'. Example: highlightSeriesOpts: { strokeWidth: 3 }."},highlightSeriesBackgroundAlpha:{default:"0.5",labels:["Interactive Elements"],type:"float",description:"Fade the background while highlighting series. 1=fully visible background (disable fading), 0=hiddden background (show highlighted series only)."},highlightSeriesBackgroundColor:{default:"rgb(255, 255, 255)",labels:["Interactive Elements"],type:"string",description:"Sets the background color used to fade out the series in conjunction with 'highlightSeriesBackgroundAlpha'."},includeZero:{default:"false",labels:["Axis display"],type:"boolean",description:"Usually, dygraphs will use the range of the data plus some padding to set the range of the y-axis. If this option is set, the y-axis will always include zero, typically as the lowest value. This can be used to avoid exaggerating the variance in the data"},rollPeriod:{default:"1",labels:["Error Bars","Rolling Averages"],type:"integer &gt;= 1",description:"Number of days over which to average data. Discussed extensively above."},unhighlightCallback:{default:"null",labels:["Callbacks"],type:"function(event)",parameters:[["event","the mouse event"]],description:"When set, this callback gets called every time the user stops highlighting any point by mousing out of the graph."},axisTickSize:{default:"3.0",labels:["Axis display"],type:"number",description:"The size of the line to display next to each tick mark on x- or y-axes."},labelsSeparateLines:{default:"false",labels:["Legend"],type:"boolean",description:"Put <code>&lt;br/&gt;</code> between lines in the label string. Often used in conjunction with <strong>labelsDiv</strong>."},valueFormatter:{default:"Depends on the type of your data.",labels:["Legend","Value display/formatting"],type:"function(num or millis, opts, seriesName, dygraph, row, col)",description:"Function to provide a custom display format for the values displayed on mouseover. This does not affect the values that appear on tick marks next to the axes. To format those, see axisLabelFormatter. This is usually set on a <a href='per-axis.html'>per-axis</a> basis. .",parameters:[["num_or_millis","The value to be formatted. This is always a number. For date axes, it's millis since epoch. You can call new Date(millis) to get a Date object."],["opts","This is a function you can call to access various options (e.g. opts('labelsKMB')). It returns per-axis values for the option when available."],["seriesName","The name of the series from which the point came, e.g. 'X', 'Y', 'A', etc."],["dygraph","The dygraph object for which the formatting is being done"],["row","The row of the data from which this point comes. g.getValue(row, 0) will return the x-value for this point."],["col","The column of the data from which this point comes. g.getValue(row, col) will return the original y-value for this point. This can be used to get the full confidence interval for the point, or access un-rolled values for the point."]]},annotationMouseOverHandler:{default:"null",labels:["Annotations"],type:"function(annotation, point, dygraph, event)",description:"If provided, this function is called whenever the user mouses over an annotation."},annotationMouseOutHandler:{default:"null",labels:["Annotations"],type:"function(annotation, point, dygraph, event)",parameters:[["annotation","the annotation left"],["point","the point associated with the annotation"],["dygraph","the reference graph"],["event","the mouse event"]],description:"If provided, this function is called whenever the user mouses out of an annotation."},annotationClickHandler:{default:"null",labels:["Annotations"],type:"function(annotation, point, dygraph, event)",parameters:[["annotation","the annotation left"],["point","the point associated with the annotation"],["dygraph","the reference graph"],["event","the mouse event"]],description:"If provided, this function is called whenever the user clicks on an annotation."},annotationDblClickHandler:{default:"null",labels:["Annotations"],type:"function(annotation, point, dygraph, event)",parameters:[["annotation","the annotation left"],["point","the point associated with the annotation"],["dygraph","the reference graph"],["event","the mouse event"]],description:"If provided, this function is called whenever the user double-clicks on an annotation."},drawCallback:{default:"null",labels:["Callbacks"],type:"function(dygraph, is_initial)",parameters:[["dygraph","The graph being drawn"],["is_initial","True if this is the initial draw, false for subsequent draws."]],description:"When set, this callback gets called every time the dygraph is drawn. This includes the initial draw, after zooming and repeatedly while panning."},labelsKMG2:{default:"false",labels:["Value display/formatting"],type:"boolean",description:"Show k/M/G for kilo/Mega/Giga on y-axis. This is different than <code>labelsKMB</code> in that it uses base 2, not 10."},delimiter:{default:",",labels:["CSV parsing"],type:"string",description:"The delimiter to look for when separating fields of a CSV file. Setting this to a tab is not usually necessary, since tab-delimited data is auto-detected."},axisLabelFontSize:{default:"14",labels:["Axis display"],type:"integer",description:"Size of the font (in pixels) to use in the axis labels, both x- and y-axis."},underlayCallback:{default:"null",labels:["Callbacks"],type:"function(context, area, dygraph)",parameters:[["context","the canvas drawing context on which to draw"],["area","An object with {x,y,w,h} properties describing the drawing area."],["dygraph","the reference graph"]],description:"When set, this callback gets called before the chart is drawn. It details on how to use this."},width:{default:"480",labels:["Overall display"],type:"integer",description:"Width, in pixels, of the chart. If the container div has been explicitly sized, this will be ignored."},pixelRatio:{default:"(devicePixelRatio / context.backingStoreRatio)",labels:["Overall display"],type:"float",description:"Overrides the pixel ratio scaling factor for the canvas's 2d context. Ordinarily, this is set to the devicePixelRatio / (context.backingStoreRatio || 1), so on mobile devices, where the devicePixelRatio can be somewhere around 3, performance can be improved by overriding this value to something less precise, like 1, at the expense of resolution."},interactionModel:{default:"...",labels:["Interactive Elements"],type:"Object",description:"TODO(konigsberg): document this"},ticker:{default:"Dygraph.dateTicker or Dygraph.numericTicks",labels:["Axis display"],type:"function(min, max, pixels, opts, dygraph, vals) -> [{v: ..., label: ...}, ...]",parameters:[["min",""],["max",""],["pixels",""],["opts",""],["dygraph","the reference graph"],["vals",""]],description:"This lets you specify an arbitrary function to generate tick marks on an axis. The tick marks are an array of (value, label) pairs. The built-in functions go to great lengths to choose good tick marks so, if you set this option, you'll most likely want to call one of them and modify the result. See dygraph-tickers.js for an extensive discussion. This is set on a <a href='per-axis.html'>per-axis</a> basis."},xAxisHeight:{default:"(null)",labels:["Axis display"],type:"integer",description:"Height, in pixels, of the x-axis. If not set explicitly, this is computed based on axisLabelFontSize and axisTickSize."},showLabelsOnHighlight:{default:"true",labels:["Interactive Elements","Legend"],type:"boolean",description:"Whether to show the legend upon mouseover."},axis:{default:"(none)",labels:["Axis display"],type:"string",description:"Set to either 'y1' or 'y2' to assign a series to a y-axis (primary or secondary). Must be set per-series."},pixelsPerLabel:{default:"70 (x-axis) or 30 (y-axes)",labels:["Axis display","Grid"],type:"integer",description:"Number of pixels to require between each x- and y-label. Larger values will yield a sparser axis with fewer ticks. This is set on a <a href='per-axis.html'>per-axis</a> basis."},labelsDiv:{default:"null",labels:["Legend"],type:"DOM element or string",example:"<code style='font-size: small'>document.getElementById('foo')</code>or<code>'foo'",description:"Show data labels in an external div, rather than on the graph.  This value can either be a div element or a div id."},fractions:{default:"false",labels:["CSV parsing","Error Bars"],type:"boolean",
description:'When set, attempt to parse each cell in the CSV file as "a/b", where a and b are integers. The ratio will be plotted. This allows computation of Wilson confidence intervals (see below).'},logscale:{default:"false",labels:["Axis display"],type:"boolean",description:"When set for the y-axis or x-axis, the graph shows that axis in log scale. Any values less than or equal to zero are not displayed. Showing log scale with ranges that go below zero will result in an unviewable graph.\n\n Not compatible with showZero. connectSeparatedPoints is ignored. This is ignored for date-based x-axes."},strokeWidth:{default:"1.0",labels:["Data Line display"],type:"float",example:"0.5, 2.0",description:"The width of the lines connecting data points. This can be used to increase the contrast or some graphs."},strokePattern:{default:"null",labels:["Data Line display"],type:"array<integer>",example:"[10, 2, 5, 2]",description:"A custom pattern array where the even index is a draw and odd is a space in pixels. If null then it draws a solid line. The array should have a even length as any odd lengthed array could be expressed as a smaller even length array. This is used to create dashed lines."},strokeBorderWidth:{default:"null",labels:["Data Line display"],type:"float",example:"1.0",description:"Draw a border around graph lines to make crossing lines more easily distinguishable. Useful for graphs with many lines."},strokeBorderColor:{default:"white",labels:["Data Line display"],type:"string",example:"red, #ccffdd",description:"Color for the line border used if strokeBorderWidth is set."},wilsonInterval:{default:"true",labels:["Error Bars"],type:"boolean",description:'Use in conjunction with the "fractions" option. Instead of plotting +/- N standard deviations, dygraphs will compute a Wilson confidence interval and plot that. This has more reasonable behavior for ratios close to 0 or 1.'},fillGraph:{default:"false",labels:["Data Line display"],type:"boolean",description:"Should the area underneath the graph be filled? This option is not compatible with error bars. This may be set on a <a href='per-axis.html'>per-series</a> basis."},highlightCircleSize:{default:"3",labels:["Interactive Elements"],type:"integer",description:"The size in pixels of the dot drawn over highlighted points."},gridLineColor:{default:"rgb(128,128,128)",labels:["Grid"],type:"red, blue",description:"The color of the gridlines. This may be set on a per-axis basis to define each axis' grid separately."},gridLinePattern:{default:"null",labels:["Grid"],type:"array<integer>",example:"[10, 2, 5, 2]",description:"A custom pattern array where the even index is a draw and odd is a space in pixels. If null then it draws a solid line. The array should have a even length as any odd lengthed array could be expressed as a smaller even length array. This is used to create dashed gridlines."},visibility:{default:"[true, true, ...]",labels:["Data Line display"],type:"Array of booleans",description:"Which series should initially be visible? Once the Dygraph has been constructed, you can access and modify the visibility of each series using the <code>visibility</code> and <code>setVisibility</code> methods."},valueRange:{default:"Full range of the input is shown",labels:["Axis display"],type:"Array of two numbers",example:"[10, 110]",description:"Explicitly set the vertical range of the graph to [low, high]. This may be set on a per-axis basis to define each y-axis separately. If either limit is unspecified, it will be calculated automatically (e.g. [null, 30] to automatically calculate just the lower bound)"},colorSaturation:{default:"1.0",labels:["Data Series Colors"],type:"float (0.0 - 1.0)",description:"If <strong>colors</strong> is not specified, saturation of the automatically-generated data series colors."},hideOverlayOnMouseOut:{default:"true",labels:["Interactive Elements","Legend"],type:"boolean",description:"Whether to hide the legend when the mouse leaves the chart area."},legend:{default:"onmouseover",labels:["Legend"],type:"string",description:'When to display the legend. By default, it only appears when a user mouses over the chart. Set it to "always" to always display a legend of some sort. When set to "follow", legend follows highlighted points.'},legendFormatter:{default:"null",labels:["Legend"],type:"function(data): string",params:[["data",'An object containing information about the selection (or lack of a selection). This includes formatted values and series information. See <a href="https://github.com/danvk/dygraphs/pull/683">here</a> for sample values.']],description:'Set this to supply a custom formatter for the legend. See <a href="https://github.com/danvk/dygraphs/pull/683">this comment</a> and the <a href="tests/legend-formatter.html">legendFormatter demo</a> for usage.'},labelsShowZeroValues:{default:"true",labels:["Legend"],type:"boolean",description:"Show zero value labels in the labelsDiv."},stepPlot:{default:"false",labels:["Data Line display"],type:"boolean",description:"When set, display the graph as a step plot instead of a line plot. This option may either be set for the whole graph or for single series."},offset:{default:"0",labels:["Value display/formatting"],type:"string",description:"When set, display the graph dates with this offset."},labelsUTC:{default:"false",labels:["Value display/formatting","Axis display"],type:"boolean",description:"Show date/time labels according to UTC (instead of local time)."},labelsKMB:{default:"false",labels:["Value display/formatting"],type:"boolean",description:"Show K/M/B for thousands/millions/billions on y-axis."},rightGap:{default:"5",labels:["Overall display"],type:"integer",description:"Number of pixels to leave blank at the right edge of the Dygraph. This makes it easier to highlight the right-most data point."},drawAxesAtZero:{default:"false",labels:["Axis display"],type:"boolean",description:"When set, draw the X axis at the Y=0 position and the Y axis at the X=0 position if those positions are inside the graph's visible area. Otherwise, draw the axes at the bottom or left graph edge as usual."},xRangePad:{default:"0",labels:["Axis display"],type:"float",description:"Add the specified amount of extra space (in pixels) around the X-axis value range to ensure points at the edges remain visible."},yRangePad:{default:"null",labels:["Axis display"],type:"float",description:"If set, add the specified amount of extra space (in pixels) around the Y-axis value range to ensure points at the edges remain visible. If unset, use the traditional Y padding algorithm."},axisLabelFormatter:{default:"Depends on the data type",labels:["Axis display"],type:"function(number or Date, granularity, opts, dygraph)",parameters:[["number or date","Either a number (for a numeric axis) or a Date object (for a date axis)"],["granularity","specifies how fine-grained the axis is. For date axes, this is a reference to the time granularity enumeration, defined in dygraph-tickers.js, e.g. Dygraph.WEEKLY."],["opts","a function which provides access to various options on the dygraph, e.g. opts('labelsKMB')."],["dygraph","the referenced graph"]],description:"Function to call to format the tick values that appear along an axis. This is usually set on a <a href='per-axis.html'>per-axis</a> basis."},clickCallback:{snippet:"function(e, date_millis){<br>&nbsp;&nbsp;alert(new Date(date_millis));<br>}",default:"null",labels:["Callbacks"],type:"function(e, x, points)",parameters:[["e","The event object for the click"],["x","The x value that was clicked (for dates, this is milliseconds since epoch)"],["points","The closest points along that date. See <a href='#point_properties'>Point properties</a> for details."]],description:"A function to call when the canvas is clicked."},labels:{default:'["X", "Y1", "Y2", ...]*',labels:["Legend"],type:"array<string>",description:"A name for each data series, including the independent (X) series. For CSV files and DataTable objections, this is determined by context. For raw data, this must be specified. If it is not, default values are supplied and a warning is logged."},dateWindow:{default:"Full range of the input is shown",labels:["Axis display"],type:"Array of two numbers",example:"[<br>&nbsp;&nbsp;Date.parse('2006-01-01'),<br>&nbsp;&nbsp;(new Date()).valueOf()<br>]",description:"Initially zoom in on a section of the graph. Is of the form [earliest, latest], where earliest/latest are milliseconds since epoch. If the data for the x-axis is numeric, the values in dateWindow must also be numbers."},showRoller:{default:"false",labels:["Interactive Elements","Rolling Averages"],type:"boolean",description:"If the rolling average period text box should be shown."},sigma:{default:"2.0",labels:["Error Bars"],type:"float",description:"When errorBars is set, shade this many standard deviations above/below each point."},customBars:{default:"false",labels:["CSV parsing","Error Bars"],type:"boolean",description:'When set, parse each CSV cell as "low;middle;high". Error bars will be drawn for each point between low and high, with the series itself going through middle.'},colorValue:{default:"1.0",labels:["Data Series Colors"],type:"float (0.0 - 1.0)",description:"If colors is not specified, value of the data series colors, as in hue/saturation/value. (0.0-1.0, default 0.5)"},errorBars:{default:"false",labels:["CSV parsing","Error Bars"],type:"boolean",description:"Does the data contain standard deviations? Setting this to true alters the input format (see above)."},displayAnnotations:{default:"false",labels:["Annotations"],type:"boolean",description:"Only applies when Dygraphs is used as a GViz chart. Causes string columns following a data series to be interpreted as annotations on points in that series. This is the same format used by Google's AnnotatedTimeLine chart."},panEdgeFraction:{default:"null",labels:["Axis display","Interactive Elements"],type:"float",description:"A value representing the farthest a graph may be panned, in percent of the display. For example, a value of 0.1 means that the graph can only be panned 10% passed the edges of the displayed values. null means no bounds."},title:{labels:["Chart labels"],type:"string",default:"null",description:"Text to display above the chart. You can supply any HTML for this value, not just text. If you wish to style it using CSS, use the 'dygraph-label' or 'dygraph-title' classes."},titleHeight:{default:"18",labels:["Chart labels"],type:"integer",description:"Height of the chart title, in pixels. This also controls the default font size of the title. If you style the title on your own, this controls how much space is set aside above the chart for the title's div."},xlabel:{labels:["Chart labels"],type:"string",default:"null",description:"Text to display below the chart's x-axis. You can supply any HTML for this value, not just text. If you wish to style it using CSS, use the 'dygraph-label' or 'dygraph-xlabel' classes."},xLabelHeight:{labels:["Chart labels"],type:"integer",default:"18",description:"Height of the x-axis label, in pixels. This also controls the default font size of the x-axis label. If you style the label on your own, this controls how much space is set aside below the chart for the x-axis label's div."},ylabel:{labels:["Chart labels"],type:"string",default:"null",description:"Text to display to the left of the chart's y-axis. You can supply any HTML for this value, not just text. If you wish to style it using CSS, use the 'dygraph-label' or 'dygraph-ylabel' classes. The text will be rotated 90 degrees by default, so CSS rules may behave in unintuitive ways. No additional space is set aside for a y-axis label. If you need more space, increase the width of the y-axis tick labels using the yAxisLabelWidth option. If you need a wider div for the y-axis label, either style it that way with CSS (but remember that it's rotated, so width is controlled by the 'height' property) or set the yLabelWidth option."},y2label:{labels:["Chart labels"],type:"string",default:"null",description:"Text to display to the right of the chart's secondary y-axis. This label is only displayed if a secondary y-axis is present. See <a href='http://dygraphs.com/tests/two-axes.html'>this test</a> for an example of how to do this. The comments for the 'ylabel' option generally apply here as well. This label gets a 'dygraph-y2label' instead of a 'dygraph-ylabel' class."},yLabelWidth:{labels:["Chart labels"],type:"integer",default:"18",description:"Width of the div which contains the y-axis label. Since the y-axis label appears rotated 90 degrees, this actually affects the height of its div."},drawGrid:{default:"true for x and y, false for y2",labels:["Grid"],type:"boolean",description:"Whether to display gridlines in the chart. This may be set on a per-axis basis to define the visibility of each axis' grid separately."},independentTicks:{default:"true for y, false for y2",labels:["Axis display","Grid"],type:"boolean",description:"Only valid for y and y2, has no effect on x: This option defines whether the y axes should align their ticks or if they should be independent. Possible combinations: 1.) y=true, y2=false (default): y is the primary axis and the y2 ticks are aligned to the the ones of y. (only 1 grid) 2.) y=false, y2=true: y2 is the primary axis and the y ticks are aligned to the the ones of y2. (only 1 grid) 3.) y=true, y2=true: Both axis are independent and have their own ticks. (2 grids) 4.) y=false, y2=false: Invalid configuration causes an error."},drawAxis:{default:"true for x and y, false for y2",labels:["Axis display"],type:"boolean",description:"Whether to draw the specified axis. This may be set on a per-axis basis to define the visibility of each axis separately. Setting this to false also prevents axis ticks from being drawn and reclaims the space for the chart grid/lines."},gridLineWidth:{default:"0.3",labels:["Grid"],type:"float",description:"Thickness (in pixels) of the gridlines drawn under the chart. The vertical/horizontal gridlines can be turned off entirely by using the drawGrid option. This may be set on a per-axis basis to define each axis' grid separately."},axisLineWidth:{default:"0.3",labels:["Axis display"],type:"float",description:"Thickness (in pixels) of the x- and y-axis lines."},axisLineColor:{default:"black",labels:["Axis display"],type:"string",description:"Color of the x- and y-axis lines. Accepts any value which the HTML canvas strokeStyle attribute understands, e.g. 'black' or 'rgb(0, 100, 255)'."},fillAlpha:{default:"0.15",labels:["Error Bars","Data Series Colors"],type:"float (0.0 - 1.0)",description:"Error bars (or custom bars) for each series are drawn in the same color as the series, but with partial transparency. This sets the transparency. A value of 0.0 means that the error bars will not be drawn, whereas a value of 1.0 means that the error bars will be as dark as the line for the series itself. This can be used to produce chart lines whose thickness varies at each point."},axisLabelWidth:{default:"50 (y-axis), 60 (x-axis)",labels:["Axis display","Chart labels"],type:"integer",description:"Width (in pixels) of the containing divs for x- and y-axis labels. For the y-axis, this also controls the width of the y-axis. Note that for the x-axis, this is independent from pixelsPerLabel, which controls the spacing between labels."},sigFigs:{default:"null",labels:["Value display/formatting"],type:"integer",description:"By default, dygraphs displays numbers with a fixed number of digits after the decimal point. If you'd prefer to have a fixed number of significant figures, set this option to that number of sig figs. A value of 2, for instance, would cause 1 to be display as 1.0 and 1234 to be displayed as 1.23e+3."},digitsAfterDecimal:{default:"2",labels:["Value display/formatting"],type:"integer",description:"Unless it's run in scientific mode (see the <code>sigFigs</code> option), dygraphs displays numbers with <code>digitsAfterDecimal</code> digits after the decimal point. Trailing zeros are not displayed, so with a value of 2 you'll get '0', '0.1', '0.12', '123.45' but not '123.456' (it will be rounded to '123.46'). Numbers with absolute value less than 0.1^digitsAfterDecimal (i.e. those which would show up as '0.00') will be displayed in scientific notation."},maxNumberWidth:{default:"6",labels:["Value display/formatting"],type:"integer",description:"When displaying numbers in normal (not scientific) mode, large numbers will be displayed with many trailing zeros (e.g. 100000000 instead of 1e9). This can lead to unwieldy y-axis labels. If there are more than <code>maxNumberWidth</code> digits to the left of the decimal in a number, dygraphs will switch to scientific notation, even when not operating in scientific mode. If you'd like to see all those digits, set this to something large, like 20 or 30."},file:{default:"(set when constructed)",labels:["Data"],type:"string (URL of CSV or CSV), GViz DataTable or 2D Array",description:"Sets the data being displayed in the chart. This can only be set when calling updateOptions; it cannot be set from the constructor. For a full description of valid data formats, see the <a href='http://dygraphs.com/data.html'>Data Formats</a> page."},timingName:{default:"null",labels:["Debugging","Deprecated"],type:"string",description:"Set this option to log timing information. The value of the option will be logged along with the timimg, so that you can distinguish multiple dygraphs on the same page."},showRangeSelector:{default:"false",labels:["Range Selector"],type:"boolean",description:"Show or hide the range selector widget."},rangeSelectorHeight:{default:"40",labels:["Range Selector"],type:"integer",description:"Height, in pixels, of the range selector widget. This option can only be specified at Dygraph creation time."},rangeSelectorPlotStrokeColor:{default:"#808FAB",labels:["Range Selector"],type:"string",description:'The range selector mini plot stroke color. This can be of the form "#AABBCC" or "rgb(255,100,200)" or "yellow". You can also specify null or "" to turn off stroke.'},rangeSelectorPlotFillColor:{default:"#A7B1C4",labels:["Range Selector"],type:"string",description:'The range selector mini plot fill color. This can be of the form "#AABBCC" or "rgb(255,100,200)" or "yellow". You can also specify null or "" to turn off fill.'},rangeSelectorPlotFillGradientColor:{default:"white",labels:["Range Selector"],type:"string",description:'The top color for the range selector mini plot fill color gradient. This can be of the form "#AABBCC" or "rgb(255,100,200)" or "rgba(255,100,200,42)" or "yellow". You can also specify null or "" to disable the gradient and fill with one single color.'},rangeSelectorBackgroundStrokeColor:{default:"gray",labels:["Range Selector"],type:"string",description:'The color of the lines below and on both sides of the range selector mini plot. This can be of the form "#AABBCC" or "rgb(255,100,200)" or "yellow".'},rangeSelectorBackgroundLineWidth:{default:"1",labels:["Range Selector"],type:"float",description:"The width of the lines below and on both sides of the range selector mini plot."},rangeSelectorPlotLineWidth:{default:"1.5",labels:["Range Selector"],type:"float",description:"The width of the range selector mini plot line."},rangeSelectorForegroundStrokeColor:{default:"black",labels:["Range Selector"],type:"string",description:'The color of the lines in the interactive layer of the range selector. This can be of the form "#AABBCC" or "rgb(255,100,200)" or "yellow".'},rangeSelectorForegroundLineWidth:{default:"1",labels:["Range Selector"],type:"float",description:"The width the lines in the interactive layer of the range selector."},rangeSelectorAlpha:{default:"0.6",labels:["Range Selector"],type:"float (0.0 - 1.0)",description:"The transparency of the veil that is drawn over the unselected portions of the range selector mini plot. A value of 0 represents full transparency and the unselected portions of the mini plot will appear as normal. A value of 1 represents full opacity and the unselected portions of the mini plot will be hidden."},showInRangeSelector:{default:"null",labels:["Range Selector"],type:"boolean",description:"Mark this series for inclusion in the range selector. The mini plot curve will be an average of all such series. If this is not specified for any series, the default behavior is to average all the visible series. Setting it for one series will result in that series being charted alone in the range selector. Once it's set for a single series, it needs to be set for all series which should be included (regardless of visibility)."},animatedZooms:{default:"false",labels:["Interactive Elements"],type:"boolean",description:"Set this option to animate the transition between zoom windows. Applies to programmatic and interactive zooms. Note that if you also set a drawCallback, it will be called several times on each zoom. If you set a zoomCallback, it will only be called after the animation is complete."},plotter:{default:"[DygraphCanvasRenderer.Plotters.fillPlotter, DygraphCanvasRenderer.Plotters.errorPlotter, DygraphCanvasRenderer.Plotters.linePlotter]",labels:["Data Line display"],type:"array or function",description:"A function (or array of functions) which plot each data series on the chart. TODO(danvk): more details! May be set per-series."},axes:{default:"null",labels:["Configuration"],type:"Object",description:"Defines per-axis options. Valid keys are 'x', 'y' and 'y2'. Only some options may be set on a per-axis basis. If an option may be set in this way, it will be noted on this page. See also documentation on <a href='http://dygraphs.com/per-axis.html'>per-series and per-axis options</a>."},series:{default:"null",labels:["Series"],type:"Object",description:"Defines per-series options. Its keys match the y-axis label names, and the values are dictionaries themselves that contain options specific to that series."},plugins:{default:"[]",labels:["Configuration"],type:"Array<plugin>",description:"Defines per-graph plugins. Useful for per-graph customization"},dataHandler:{default:"(depends on data)",labels:["Data"],type:"Dygraph.DataHandler",description:"Custom DataHandler. This is an advanced customization. See http://bit.ly/151E7Aq."}};var e,f=function(a){window.console&&window.console.warn(a)},g=["type","default","description"],h=["Annotations","Axis display","Chart labels","CSV parsing","Callbacks","Data","Data Line display","Data Series Colors","Error Bars","Grid","Interactive Elements","Range Selector","Legend","Overall display","Rolling Averages","Series","Value display/formatting","Zooming","Debugging","Configuration","Deprecated"],i={};for(e=0;e<h.length;e++)i[h[e]]=!0;for(var j in d)if(d.hasOwnProperty(j)){var k=d[j];for(e=0;e<g.length;e++)k.hasOwnProperty(g[e])?"string"!=typeof k[g[e]]&&f(j+"."+g[e]+" must be of type string"):f("Option "+j+' missing "'+g[e]+'" property');var l=k.labels;if("object"!=typeof l)f('Option "'+j+'" is missing a "labels": [...] option');else for(e=0;e<l.length;e++)i.hasOwnProperty(l[e])||f('Option "'+j+'" has label "'+l[e]+'", which is invalid.')}}c.default=d,b.exports=c.default}).call(this,a("_process"))},{_process:1}],15:[function(a,b,c){(function(d){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./dygraph-utils"),g=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(f),h=a("./dygraph-default-attrs"),i=e(h),j=a("./dygraph-options-reference"),k=e(j),l=function(a){this.dygraph_=a,this.yAxes_=[],this.xAxis_={},this.series_={},this.global_=this.dygraph_.attrs_,this.user_=this.dygraph_.user_attrs_||{},this.labels_=[],this.highlightSeries_=this.get("highlightSeriesOpts")||{},this.reparseSeries()};if(l.AXIS_STRING_MAPPINGS_={y:0,Y:0,y1:0,Y1:0,y2:1,Y2:1},l.axisToIndex_=function(a){if("string"==typeof a){if(l.AXIS_STRING_MAPPINGS_.hasOwnProperty(a))return l.AXIS_STRING_MAPPINGS_[a];throw"Unknown axis : "+a}if("number"==typeof a){if(0===a||1===a)return a;throw"Dygraphs only supports two y-axes, indexed from 0-1."}if(a)throw"Unknown axis : "+a;return 0},l.prototype.reparseSeries=function(){var a=this.get("labels");if(a){this.labels_=a.slice(1),this.yAxes_=[{series:[],options:{}}],this.xAxis_={options:{}},this.series_={};for(var b=this.user_.series||{},c=0;c<this.labels_.length;c++){var e=this.labels_[c],f=b[e]||{},h=l.axisToIndex_(f.axis);this.series_[e]={idx:c,yAxis:h,options:f},this.yAxes_[h]?this.yAxes_[h].series.push(e):this.yAxes_[h]={series:[e],options:{}}}var i=this.user_.axes||{};g.update(this.yAxes_[0].options,i.y||{}),this.yAxes_.length>1&&g.update(this.yAxes_[1].options,i.y2||{}),g.update(this.xAxis_.options,i.x||{}),void 0!==d&&this.validateOptions_()}},l.prototype.get=function(a){var b=this.getGlobalUser_(a);return null!==b?b:this.getGlobalDefault_(a)},l.prototype.getGlobalUser_=function(a){return this.user_.hasOwnProperty(a)?this.user_[a]:null},l.prototype.getGlobalDefault_=function(a){return this.global_.hasOwnProperty(a)?this.global_[a]:i.default.hasOwnProperty(a)?i.default[a]:null},l.prototype.getForAxis=function(a,b){var c,d;if("number"==typeof b)c=b,d=0===c?"y":"y2";else{if("y1"==b&&(b="y"),"y"==b)c=0;else if("y2"==b)c=1;else{if("x"!=b)throw"Unknown axis "+b;c=-1}d=b}var e=-1==c?this.xAxis_:this.yAxes_[c];if(e){var f=e.options;if(f.hasOwnProperty(a))return f[a]}if("x"!==b||"logscale"!==a){var g=this.getGlobalUser_(a);if(null!==g)return g}var h=i.default.axes[d];return h.hasOwnProperty(a)?h[a]:this.getGlobalDefault_(a)},l.prototype.getForSeries=function(a,b){if(b===this.dygraph_.getHighlightSeries()&&this.highlightSeries_.hasOwnProperty(a))return this.highlightSeries_[a];if(!this.series_.hasOwnProperty(b))throw"Unknown series: "+b;var c=this.series_[b],d=c.options;return d.hasOwnProperty(a)?d[a]:this.getForAxis(a,c.yAxis)},l.prototype.numAxes=function(){return this.yAxes_.length},l.prototype.axisForSeries=function(a){return this.series_[a].yAxis},l.prototype.axisOptions=function(a){return this.yAxes_[a].options},l.prototype.seriesForAxis=function(a){return this.yAxes_[a].series},l.prototype.seriesNames=function(){return this.labels_},void 0!==d){l.prototype.validateOptions_=function(){if(void 0===k.default)throw"Called validateOptions_ in prod build.";for(var a=this,b=[this.xAxis_.options,this.yAxes_[0].options,this.yAxes_[1]&&this.yAxes_[1].options,this.global_,this.user_,this.highlightSeries_],c=this.seriesNames(),d=0;d<c.length;d++){var e=c[d];this.series_.hasOwnProperty(e)&&b.push(this.series_[e].options)}for(var d=0;d<b.length;d++){var f=b[d];if(f)for(var g in f)f.hasOwnProperty(g)&&function(b){k.default[b]||a.warnInvalidOption_(b)}(g)}};var m={};l.prototype.warnInvalidOption_=function(a){if(!m[a]){m[a]=!0;throw this.labels_.indexOf(a)>=0?console.warn("Use new-style per-series options (saw "+a+" as top-level options key). See http://bit.ly/1tceaJs"):console.warn("Unknown option "+a+" (full list of options at dygraphs.com/options.html"),"invalid option "+a}},l.resetWarnings_=function(){m={}}}c.default=l,b.exports=c.default}).call(this,a("_process"))},{"./dygraph-default-attrs":10,"./dygraph-options-reference":14,"./dygraph-utils":17,_process:1}],16:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./dygraph-utils"),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=function(a,b,c,d,e,f){return g(a,b,c,function(a){return"logscale"!==a&&d(a)},e,f)};c.numericLinearTicks=f;var g=function(a,b,c,d,f,g){var h,i,j,k,m=d("pixelsPerLabel"),n=[];if(g)for(h=0;h<g.length;h++)n.push({v:g[h]});else{if(d("logscale")){k=Math.floor(c/m);var o=e.binarySearch(a,l,1),p=e.binarySearch(b,l,-1);-1==o&&(o=0),-1==p&&(p=l.length-1);var q=null;if(p-o>=k/4){for(var r=p;r>=o;r--){var s=l[r],t=Math.log(s/a)/Math.log(b/a)*c,u={v:s};null===q?q={tickValue:s,pixel_coord:t}:Math.abs(t-q.pixel_coord)>=m?q={tickValue:s,pixel_coord:t}:u.label="",n.push(u)}n.reverse()}}if(0===n.length){var v,w,x=d("labelsKMG2");x?(v=[1,2,4,8,16,32,64,128,256],w=16):(v=[1,2,5,10,20,50,100],w=10);var y,z,A,B=Math.ceil(c/m),C=Math.abs(b-a)/B,D=Math.floor(Math.log(C)/Math.log(w)),E=Math.pow(w,D);for(i=0;i<v.length&&(y=E*v[i],z=Math.floor(a/y)*y,A=Math.ceil(b/y)*y,k=Math.abs(A-z)/y,!(c/k>m));i++);for(z>A&&(y*=-1),h=0;h<=k;h++)j=z+h*y,n.push({v:j})}}var F=d("axisLabelFormatter");for(h=0;h<n.length;h++)void 0===n[h].label&&(n[h].label=F.call(f,n[h].v,0,d,f));return n};c.numericTicks=g;var h=function(a,b,c,d,e,f){var g=m(a,b,c,d);return g>=0?o(a,b,g,d,e):[]};c.dateTicker=h;var i={MILLISECONDLY:0,TWO_MILLISECONDLY:1,FIVE_MILLISECONDLY:2,TEN_MILLISECONDLY:3,FIFTY_MILLISECONDLY:4,HUNDRED_MILLISECONDLY:5,FIVE_HUNDRED_MILLISECONDLY:6,SECONDLY:7,TWO_SECONDLY:8,FIVE_SECONDLY:9,TEN_SECONDLY:10,THIRTY_SECONDLY:11,MINUTELY:12,TWO_MINUTELY:13,FIVE_MINUTELY:14,TEN_MINUTELY:15,THIRTY_MINUTELY:16,HOURLY:17,TWO_HOURLY:18,SIX_HOURLY:19,DAILY:20,TWO_DAILY:21,WEEKLY:22,MONTHLY:23,QUARTERLY:24,BIANNUAL:25,ANNUAL:26,DECADAL:27,CENTENNIAL:28,NUM_GRANULARITIES:29};c.Granularity=i;var j={DATEFIELD_Y:0,DATEFIELD_M:1,DATEFIELD_D:2,DATEFIELD_HH:3,DATEFIELD_MM:4,DATEFIELD_SS:5,DATEFIELD_MS:6,NUM_DATEFIELDS:7},k=[];k[i.MILLISECONDLY]={datefield:j.DATEFIELD_MS,step:1,spacing:1},k[i.TWO_MILLISECONDLY]={datefield:j.DATEFIELD_MS,step:2,spacing:2},k[i.FIVE_MILLISECONDLY]={datefield:j.DATEFIELD_MS,step:5,spacing:5},k[i.TEN_MILLISECONDLY]={datefield:j.DATEFIELD_MS,step:10,spacing:10},k[i.FIFTY_MILLISECONDLY]={datefield:j.DATEFIELD_MS,step:50,spacing:50},k[i.HUNDRED_MILLISECONDLY]={datefield:j.DATEFIELD_MS,step:100,spacing:100},k[i.FIVE_HUNDRED_MILLISECONDLY]={datefield:j.DATEFIELD_MS,step:500,spacing:500},k[i.SECONDLY]={datefield:j.DATEFIELD_SS,step:1,spacing:1e3},k[i.TWO_SECONDLY]={datefield:j.DATEFIELD_SS,step:2,spacing:2e3},k[i.FIVE_SECONDLY]={datefield:j.DATEFIELD_SS,step:5,spacing:5e3},k[i.TEN_SECONDLY]={datefield:j.DATEFIELD_SS,step:10,spacing:1e4},k[i.THIRTY_SECONDLY]={datefield:j.DATEFIELD_SS,step:30,spacing:3e4},k[i.MINUTELY]={datefield:j.DATEFIELD_MM,step:1,spacing:6e4},k[i.TWO_MINUTELY]={datefield:j.DATEFIELD_MM,step:2,spacing:12e4},k[i.FIVE_MINUTELY]={datefield:j.DATEFIELD_MM,step:5,spacing:3e5},k[i.TEN_MINUTELY]={datefield:j.DATEFIELD_MM,step:10,spacing:6e5},k[i.THIRTY_MINUTELY]={datefield:j.DATEFIELD_MM,step:30,spacing:18e5},k[i.HOURLY]={datefield:j.DATEFIELD_HH,step:1,spacing:36e5},k[i.TWO_HOURLY]={datefield:j.DATEFIELD_HH,step:2,spacing:72e5},k[i.SIX_HOURLY]={datefield:j.DATEFIELD_HH,step:6,spacing:216e5},k[i.DAILY]={datefield:j.DATEFIELD_D,step:1,spacing:864e5},k[i.TWO_DAILY]={datefield:j.DATEFIELD_D,step:2,spacing:1728e5},k[i.WEEKLY]={datefield:j.DATEFIELD_D,step:7,spacing:6048e5},k[i.MONTHLY]={datefield:j.DATEFIELD_M,step:1,spacing:2629817280},k[i.QUARTERLY]={datefield:j.DATEFIELD_M,step:3,spacing:216e5*365.2524},k[i.BIANNUAL]={datefield:j.DATEFIELD_M,step:6,spacing:432e5*365.2524},k[i.ANNUAL]={datefield:j.DATEFIELD_Y,step:1,spacing:864e5*365.2524},k[i.DECADAL]={datefield:j.DATEFIELD_Y,step:10,spacing:315578073600},k[i.CENTENNIAL]={datefield:j.DATEFIELD_Y,step:100,spacing:3155780736e3};var l=function(){for(var a=[],b=-39;b<=39;b++)for(var c=Math.pow(10,b),d=1;d<=9;d++){var e=c*d;a.push(e)}return a}(),m=function(a,b,c,d){for(var e=d("pixelsPerLabel"),f=0;f<i.NUM_GRANULARITIES;f++){if(c/n(a,b,f)>=e)return f}return-1},n=function(a,b,c){var d=k[c].spacing;return Math.round(1*(b-a)/d)},o=function(a,b,c,d,f){var g=d("axisLabelFormatter"),h=d("labelsUTC"),l=h?e.DateAccessorsUTC:e.DateAccessorsLocal,m=k[c].datefield,n=k[c].step,o=k[c].spacing,p=new Date(a),q=[];q[j.DATEFIELD_Y]=l.getFullYear(p,d("offset")),q[j.DATEFIELD_M]=l.getMonth(p,d("offset")),q[j.DATEFIELD_D]=l.getDate(p,d("offset")),q[j.DATEFIELD_HH]=l.getHours(p,d("offset")),
q[j.DATEFIELD_MM]=l.getMinutes(p,d("offset")),q[j.DATEFIELD_SS]=l.getSeconds(p,d("offset")),q[j.DATEFIELD_MS]=l.getMilliseconds(p,d("offset"));var r=q[m]%n;c==i.WEEKLY&&(r=l.getDay(p,d("offset"))),q[m]-=r;for(var s=m+1;s<j.NUM_DATEFIELDS;s++)q[s]=s===j.DATEFIELD_D?1:0;q.push(d("offset"));var t=[],u=l.makeDate.apply(null,q),v=u.getTime();if(c<=i.HOURLY)for(v<a&&(v+=o,u=new Date(v));v<=b;)t.push({v:v,label:g.call(f,u,c,d,f)}),v+=o,u=new Date(v);else for(v<a&&(q[m]+=n,u=l.makeDate.apply(null,q),v=u.getTime());v<=b;)(c>=i.DAILY||l.getHours(u,d("offset"))%n==0)&&t.push({v:v,label:g.call(f,u,c,d,f)}),q[m]+=n,u=l.makeDate.apply(null,q),v=u.getTime();return t};c.getDateAxis=o},{"./dygraph-utils":17}],17:[function(a,b,c){"use strict";function d(a,b,c){a.removeEventListener(b,c,!1)}function e(a){return a=a||window.event,a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.cancel=!0,a.returnValue=!1,!1}function f(a,b,c){var d,e,f;if(0===b)d=c,e=c,f=c;else{var g=Math.floor(6*a),h=6*a-g,i=c*(1-b),j=c*(1-b*h),k=c*(1-b*(1-h));switch(g){case 1:d=j,e=c,f=i;break;case 2:d=i,e=c,f=k;break;case 3:d=i,e=j,f=c;break;case 4:d=k,e=i,f=c;break;case 5:d=c,e=i,f=j;break;case 6:case 0:d=c,e=k,f=i}}return d=Math.floor(255*d+.5),e=Math.floor(255*e+.5),f=Math.floor(255*f+.5),"rgb("+d+","+e+","+f+")"}function g(a){var b=a.getBoundingClientRect(),c=window,d=document.documentElement;return{x:b.left+(c.pageXOffset||d.scrollLeft),y:b.top+(c.pageYOffset||d.scrollTop)}}function h(a){return!a.pageX||a.pageX<0?0:a.pageX}function i(a){return!a.pageY||a.pageY<0?0:a.pageY}function j(a,b){return h(a)-b.px}function k(a,b){return i(a)-b.py}function l(a){return!!a&&!isNaN(a)}function m(a,b){return!!a&&(null!==a.yval&&(null!==a.x&&void 0!==a.x&&(null!==a.y&&void 0!==a.y&&!(isNaN(a.x)||!b&&isNaN(a.y)))))}function n(a,b){var c=Math.min(Math.max(1,b||2),21);return Math.abs(a)<.001&&0!==a?a.toExponential(c-1):a.toPrecision(c)}function o(a){return a<10?"0"+a:""+a}function p(a,b,c,d){var e=o(a)+":"+o(b);if(c&&(e+=":"+o(c),d)){var f=""+d;e+="."+("000"+f).substring(f.length)}return e}function q(a,b,c){var d=b?ba:_,e=new Date(a),f=d.getFullYear(e,c),g=d.getMonth(e,c),h=d.getDate(e,c),i=d.getHours(e,c),j=d.getMinutes(e,c),k=d.getSeconds(e,c),l=d.getMilliseconds(e,c),m=""+f,n=o(g+1),q=o(h),r=3600*i+60*j+k+.001*l,s=m+"/"+n+"/"+q;return r&&(s+=" "+p(i,j,k,l)),s}function r(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}function s(a,b,c,d,e){for(var f=!0;f;){var g=a,h=b,i=c,j=d,k=e;if(f=!1,null!==j&&void 0!==j&&null!==k&&void 0!==k||(j=0,k=h.length-1),j>k)return-1;null!==i&&void 0!==i||(i=0);var l,m=function(a){return a>=0&&a<h.length},n=parseInt((j+k)/2,10),o=h[n];if(o==g)return n;if(o>g){if(i>0&&(l=n-1,m(l)&&h[l]<g))return n;a=g,b=h,c=i,d=j,e=n-1,f=!0,m=n=o=l=void 0}else{if(!(o<g))return-1;if(i<0&&(l=n+1,m(l)&&h[l]>g))return n;a=g,b=h,c=i,d=n+1,e=k,f=!0,m=n=o=l=void 0}}}function t(a){var b,c;if((-1==a.search("-")||-1!=a.search("T")||-1!=a.search("Z"))&&(c=u(a))&&!isNaN(c))return c;if(-1!=a.search("-")){for(b=a.replace("-","/","g");-1!=b.search("-");)b=b.replace("-","/");c=u(b)}else 8==a.length?(b=a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2),c=u(b)):c=u(a);return c&&!isNaN(c)||console.error("Couldn't parse "+a+" as a date"),c}function u(a){return new Date(a).getTime()}function v(a,b){if(void 0!==b&&null!==b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function w(a,b){if(void 0!==b&&null!==b)for(var c in b)b.hasOwnProperty(c)&&(null===b[c]?a[c]=null:x(b[c])?a[c]=b[c].slice():!function(a){return"object"==typeof Node?a instanceof Node:"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName}(b[c])&&"object"==typeof b[c]?("object"==typeof a[c]&&null!==a[c]||(a[c]={}),w(a[c],b[c])):a[c]=b[c]);return a}function x(a){var b=typeof a;return("object"==b||"function"==b&&"function"==typeof a.item)&&null!==a&&"number"==typeof a.length&&3!==a.nodeType}function y(a){return"object"==typeof a&&null!==a&&"function"==typeof a.getTime}function z(a){for(var b=[],c=0;c<a.length;c++)x(a[c])?b.push(z(a[c])):b.push(a[c]);return b}function A(){return document.createElement("canvas")}function B(a){try{var b=window.devicePixelRatio,c=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;return void 0!==b?b/c:1}catch(a){return 1}}function C(a,b,c,d){b=b||0,c=c||a.length,this.hasNext=!0,this.peek=null,this.start_=b,this.array_=a,this.predicate_=d,this.end_=Math.min(a.length,b+c),this.nextIdx_=b-1,this.next()}function D(a,b,c,d){return new C(a,b,c,d)}function E(a,b,c,d){var e,f=0,g=(new Date).getTime();if(a(f),1==b)return void d();var h=b-1;!function i(){f>=b||ca.call(window,function(){var b=(new Date).getTime(),j=b-g;e=f,f=Math.floor(j/c);var k=f-e;f+k>h||f>=h?(a(h),d()):(0!==k&&a(f),i())})}()}function F(a,b){var c={};if(a)for(var d=1;d<a.length;d++)c[a[d]]=!0;var e=function(a){for(var b in a)if(a.hasOwnProperty(b)&&!da[b])return!0;return!1};for(var f in b)if(b.hasOwnProperty(f))if("highlightSeriesOpts"==f||c[f]&&!b.series){if(e(b[f]))return!0}else if("series"==f||"axes"==f){var g=b[f];for(var h in g)if(g.hasOwnProperty(h)&&e(g[h]))return!0}else if(!da[f])return!0;return!1}function G(a){for(var b=0;b<a.length;b++){var c=a.charAt(b);if("\r"===c)return b+1<a.length&&"\n"===a.charAt(b+1)?"\r\n":c;if("\n"===c)return b+1<a.length&&"\r"===a.charAt(b+1)?"\n\r":c}return null}function H(a,b){if(null===b||null===a)return!1;for(var c=a;c&&c!==b;)c=c.parentNode;return c===b}function I(a,b){return b<0?1/Math.pow(a,-b):Math.pow(a,b)}function J(a){var b=fa.exec(a);if(!b)return null;var c=parseInt(b[1],10),d=parseInt(b[2],10),e=parseInt(b[3],10);return b[4]?{r:c,g:d,b:e,a:parseFloat(b[4])}:{r:c,g:d,b:e}}function K(a){var b=J(a);if(b)return b;var c=document.createElement("div");c.style.backgroundColor=a,c.style.visibility="hidden",document.body.appendChild(c);var d=window.getComputedStyle(c,null).backgroundColor;return document.body.removeChild(c),J(d)}function L(a){try{(a||document.createElement("canvas")).getContext("2d")}catch(a){return!1}return!0}function M(a,b,c){var d=parseFloat(a);if(!isNaN(d))return d;if(/^ *$/.test(a))return null;if(/^ *nan *$/i.test(a))return NaN;var e="Unable to parse '"+a+"' as a number";return void 0!==c&&void 0!==b&&(e+=" on line "+(1+(b||0))+" ('"+c+"') of CSV."),console.error(e),null}function N(a,b){var c=b("sigFigs");if(null!==c)return n(a,c);var d,e=b("digitsAfterDecimal"),f=b("maxNumberWidth"),g=b("labelsKMB"),h=b("labelsKMG2");if(d=0!==a&&(Math.abs(a)>=Math.pow(10,f)||Math.abs(a)<Math.pow(10,-e))?a.toExponential(e):""+r(a,e),g||h){var i,j=[],k=[];g&&(i=1e3,j=ga),h&&(g&&console.warn("Setting both labelsKMB and labelsKMG2. Pick one!"),i=1024,j=ha,k=ia);for(var l=Math.abs(a),m=I(i,j.length),o=j.length-1;o>=0;o--,m/=i)if(l>=m){d=r(a/m,e)+j[o];break}if(h){var p=String(a.toExponential()).split("e-");2===p.length&&p[1]>=3&&p[1]<=24&&(d=p[1]%3>0?r(p[0]/I(10,p[1]%3),e):Number(p[0]).toFixed(2),d+=k[Math.floor(p[1]/3)-1])}}return d}function O(a,b,c){return N.call(this,a,c)}function P(a,b,c){var d=c("labelsUTC"),e=d?ba:_,f=e.getFullYear(a,c("offset")),g=e.getMonth(a,c("offset")),h=e.getDate(a,c("offset")),i=e.getHours(a,c("offset")),j=e.getMinutes(a,c("offset")),k=e.getSeconds(a,c("offset")),l=e.getMilliseconds(a,c("offset"));if(b>=S.Granularity.DECADAL)return""+f;if(b>=S.Granularity.MONTHLY)return ja[g]+"&#160;"+f;if(0===3600*i+60*j+k+.001*l||b>=S.Granularity.DAILY)return o(h)+"&#160;"+ja[g];if(b<S.Granularity.SECONDLY){var m=""+l;return o(k)+"."+("000"+m).substring(m.length)}return b>S.Granularity.MINUTELY?p(i,j,k,0):p(i,j,k,l)}function Q(a,b){return q(a,b("labelsUTC"),b("offset"))}Object.defineProperty(c,"__esModule",{value:!0}),c.removeEvent=d,c.cancelEvent=e,c.hsvToRGB=f,c.findPos=g,c.pageX=h,c.pageY=i,c.dragGetX_=j,c.dragGetY_=k,c.isOK=l,c.isValidPoint=m,c.floatFormat=n,c.zeropad=o,c.hmsString_=p,c.dateString_=q,c.round_=r,c.binarySearch=s,c.dateParser=t,c.dateStrToMillis=u,c.update=v,c.updateDeep=w,c.isArrayLike=x,c.isDateLike=y,c.clone=z,c.createCanvas=A,c.getContextPixelRatio=B,c.Iterator=C,c.createIterator=D,c.repeatAndCleanup=E,c.isPixelChangingOptionList=F,c.detectLineDelimiter=G,c.isNodeContainedBy=H,c.pow=I,c.toRGB_=K,c.isCanvasSupported=L,c.parseFloat_=M,c.numberValueFormatter=N,c.numberAxisLabelFormatter=O,c.dateAxisLabelFormatter=P,c.dateValueFormatter=Q;var R=a("./dygraph-tickers"),S=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(R);c.LOG_SCALE=10;var T=Math.log(10);c.LN_TEN=T;var U=function(a){return Math.log(a)/T};c.log10=U;var V=function(a,b,c){var d=U(a),e=U(b),f=d+c*(e-d);return Math.pow(10,f)};c.logRangeFraction=V;var W=[2,2];c.DOTTED_LINE=W;var X=[7,3];c.DASHED_LINE=X;var Y=[7,2,2,2];c.DOT_DASH_LINE=Y;c.HORIZONTAL=1;c.VERTICAL=2;var Z=function(a){return a.getContext("2d")};c.getContext=Z;var $=function(a,b,c){a.addEventListener(b,c,!1)};c.addEvent=$;var _={getFullYear:function(a){return a.getFullYear()},getMonth:function(a){return a.getMonth()},getDate:function(a){return a.getDate()},getHours:function(a){return a.getHours()},getMinutes:function(a){return a.getMinutes()},getSeconds:function(a){return a.getSeconds()},getMilliseconds:function(a){return a.getMilliseconds()},getDay:function(a){return a.getDay()},makeDate:function(a,b,c,d,e,f,g){return new Date(a,b,c,d,e,f,g)}};c.DateAccessorsLocal=_;var aa=function(a,b,c){return b?moment(a).utcOffset(c,!0):moment(a).utcOffset(c,!1)},ba={getFullYear:function(a,b){return aa(a,!1,b).year()},getMonth:function(a,b){return aa(a,!1,b).month()},getDate:function(a,b){return aa(a,!1,b).date()},getHours:function(a,b){return aa(a,!1,b).hour()},getMinutes:function(a,b){return aa(a,!1,b).minute()},getSeconds:function(a,b){return aa(a,!1,b).second()},getMilliseconds:function(a,b){return aa(a,!1,b).millisecond()},getDay:function(a,b){return aa(a,!1,b).day()},makeDate:function(a,b,c,d,e,f,g,h){return aa(new Date(a,b,c,d,e,f,g),!0,h).toDate()}};c.DateAccessorsUTC=ba,C.prototype.next=function(){if(!this.hasNext)return null;for(var a=this.peek,b=this.nextIdx_+1,c=!1;b<this.end_;){if(!this.predicate_||this.predicate_(this.array_,b)){this.peek=this.array_[b],c=!0;break}b++}return this.nextIdx_=b,c||(this.hasNext=!1,this.peek=null),a};var ca=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();c.requestAnimFrame=ca;var da={annotationClickHandler:!0,annotationDblClickHandler:!0,annotationMouseOutHandler:!0,annotationMouseOverHandler:!0,axisLineColor:!0,axisLineWidth:!0,clickCallback:!0,drawCallback:!0,drawHighlightPointCallback:!0,drawPoints:!0,drawPointCallback:!0,drawGrid:!0,fillAlpha:!0,gridLineColor:!0,gridLineWidth:!0,hideOverlayOnMouseOut:!0,highlightCallback:!0,highlightCircleSize:!0,interactionModel:!0,labelsDiv:!0,labelsKMB:!0,labelsKMG2:!0,labelsSeparateLines:!0,labelsShowZeroValues:!0,legend:!0,panEdgeFraction:!0,pixelsPerYLabel:!0,pointClickCallback:!0,pointSize:!0,rangeSelectorPlotFillColor:!0,rangeSelectorPlotFillGradientColor:!0,rangeSelectorPlotStrokeColor:!0,rangeSelectorBackgroundStrokeColor:!0,rangeSelectorBackgroundLineWidth:!0,rangeSelectorPlotLineWidth:!0,rangeSelectorForegroundStrokeColor:!0,rangeSelectorForegroundLineWidth:!0,rangeSelectorAlpha:!0,showLabelsOnHighlight:!0,showRoller:!0,strokeWidth:!0,underlayCallback:!0,unhighlightCallback:!0,zoomCallback:!0},ea={DEFAULT:function(a,b,c,d,e,f,g){c.beginPath(),c.fillStyle=f,c.arc(d,e,g,0,2*Math.PI,!1),c.fill()}};c.Circles=ea;var fa=/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*([01](?:\.\d+)?))?\)$/,ga=["K","M","B","T","Q"],ha=["k","M","G","T","P","E","Z","Y"],ia=["m","u","n","p","f","a","z","y"],ja=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},{"./dygraph-tickers":16}],18:[function(a,b,c){(function(d){"use strict";function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function f(a){return a&&a.__esModule?a:{default:a}}function g(a){var b=a[0],c=b[0];if("number"!=typeof c&&!t.isDateLike(c))throw new Error("Expected number or date but got "+typeof c+": "+c+".");for(var d=1;d<b.length;d++){var e=b[d];if(null!==e&&void 0!==e&&("number"!=typeof e&&!t.isArrayLike(e)))throw new Error("Expected number or array but got "+typeof e+": "+e+".")}}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=a("./dygraph-layout"),j=f(i),k=a("./dygraph-canvas"),l=f(k),m=a("./dygraph-options"),n=f(m),o=a("./dygraph-interaction-model"),p=f(o),q=a("./dygraph-tickers"),r=e(q),s=a("./dygraph-utils"),t=e(s),u=a("./dygraph-default-attrs"),v=f(u),w=a("./dygraph-options-reference"),x=f(w),y=a("./iframe-tarp"),z=f(y),A=a("./datahandler/default"),B=f(A),C=a("./datahandler/bars-error"),D=f(C),E=a("./datahandler/bars-custom"),F=f(E),G=a("./datahandler/default-fractions"),H=f(G),I=a("./datahandler/bars-fractions"),J=f(I),K=a("./datahandler/bars"),L=f(K),M=a("./plugins/annotations"),N=f(M),O=a("./plugins/axes"),P=f(O),Q=a("./plugins/chart-labels"),R=f(Q),S=a("./plugins/grid"),T=f(S),U=a("./plugins/legend"),V=f(U),W=a("./plugins/range-selector"),X=f(W),Y=a("./dygraph-gviz"),Z=f(Y),$=function(a,b,c){this.__init__(a,b,c)};$.NAME="Dygraph",$.VERSION="2.1.0",$.DEFAULT_ROLL_PERIOD=1,$.DEFAULT_WIDTH=480,$.DEFAULT_HEIGHT=320,$.ANIMATION_STEPS=12,$.ANIMATION_DURATION=200,$.Plotters=l.default._Plotters,$.addedAnnotationCSS=!1,$.prototype.__init__=function(a,b,c){if(this.is_initial_draw_=!0,this.readyFns_=[],null!==c&&void 0!==c||(c={}),c=$.copyUserAttrs_(c),"string"==typeof a&&(a=document.getElementById(a)),!a)throw new Error("Constructing dygraph with a non-existent div!");this.maindiv_=a,this.file_=b,this.rollPeriod_=c.rollPeriod||$.DEFAULT_ROLL_PERIOD,this.previousVerticalX_=-1,this.fractions_=c.fractions||!1,this.dateWindow_=c.dateWindow||null,this.annotations_=[],a.innerHTML="",""===a.style.width&&c.width&&(a.style.width=c.width+"px"),""===a.style.height&&c.height&&(a.style.height=c.height+"px"),""===a.style.height&&0===a.clientHeight&&(a.style.height=$.DEFAULT_HEIGHT+"px",""===a.style.width&&(a.style.width=$.DEFAULT_WIDTH+"px")),this.width_=a.clientWidth||c.width||0,this.height_=a.clientHeight||c.height||0,c.stackedGraph&&(c.fillGraph=!0),this.user_attrs_={},t.update(this.user_attrs_,c),this.attrs_={},t.updateDeep(this.attrs_,v.default),this.boundaryIds_=[],this.setIndexByName_={},this.datasetIndex_=[],this.registeredEvents_=[],this.eventListeners_={},this.attributes_=new n.default(this),this.createInterface_(),this.plugins_=[];for(var d=$.PLUGINS.concat(this.getOption("plugins")),e=0;e<d.length;e++){var f,g=d[e];f=void 0!==g.activate?g:new g;var h={plugin:f,events:{},options:{},pluginOptions:{}},i=f.activate(this);for(var j in i)i.hasOwnProperty(j)&&(h.events[j]=i[j]);this.plugins_.push(h)}for(var e=0;e<this.plugins_.length;e++){var k=this.plugins_[e];for(var j in k.events)if(k.events.hasOwnProperty(j)){var l=k.events[j],m=[k.plugin,l];j in this.eventListeners_?this.eventListeners_[j].push(m):this.eventListeners_[j]=[m]}}this.createDragInterface_(),this.start_()},$.prototype.cascadeEvents_=function(a,b){if(!(a in this.eventListeners_))return!1;var c={dygraph:this,cancelable:!1,defaultPrevented:!1,preventDefault:function(){if(!c.cancelable)throw"Cannot call preventDefault on non-cancelable event.";c.defaultPrevented=!0},propagationStopped:!1,stopPropagation:function(){c.propagationStopped=!0}};t.update(c,b);var d=this.eventListeners_[a];if(d)for(var e=d.length-1;e>=0;e--){var f=d[e][0],g=d[e][1];if(g.call(f,c),c.propagationStopped)break}return c.defaultPrevented},$.prototype.getPluginInstance_=function(a){for(var b=0;b<this.plugins_.length;b++){var c=this.plugins_[b];if(c.plugin instanceof a)return c.plugin}return null},$.prototype.isZoomed=function(a){var b=!!this.dateWindow_;if("x"===a)return b;var c=this.axes_.map(function(a){return!!a.valueRange}).indexOf(!0)>=0;if(null===a||void 0===a)return b||c;if("y"===a)return c;throw new Error("axis parameter is ["+a+"] must be null, 'x' or 'y'.")},$.prototype.toString=function(){var a=this.maindiv_;return"[Dygraph "+(a&&a.id?a.id:a)+"]"},$.prototype.attr_=function(a,b){return void 0!==d&&(void 0===x.default?console.error("Must include options reference JS for testing"):x.default.hasOwnProperty(a)||(console.error("Dygraphs is using property "+a+", which has no entry in the Dygraphs.OPTIONS_REFERENCE listing."),x.default[a]=!0)),b?this.attributes_.getForSeries(a,b):this.attributes_.get(a)},$.prototype.getOption=function(a,b){return this.attr_(a,b)},$.prototype.getNumericOption=function(a,b){return this.getOption(a,b)},$.prototype.getStringOption=function(a,b){return this.getOption(a,b)},$.prototype.getBooleanOption=function(a,b){return this.getOption(a,b)},$.prototype.getFunctionOption=function(a,b){return this.getOption(a,b)},$.prototype.getOptionForAxis=function(a,b){return this.attributes_.getForAxis(a,b)},$.prototype.optionsViewForAxis_=function(a){var b=this;return function(c){var d=b.user_attrs_.axes;return d&&d[a]&&d[a].hasOwnProperty(c)?d[a][c]:("x"!==a||"logscale"!==c)&&(void 0!==b.user_attrs_[c]?b.user_attrs_[c]:(d=b.attrs_.axes,d&&d[a]&&d[a].hasOwnProperty(c)?d[a][c]:"y"==a&&b.axes_[0].hasOwnProperty(c)?b.axes_[0][c]:"y2"==a&&b.axes_[1].hasOwnProperty(c)?b.axes_[1][c]:b.attr_(c)))}},$.prototype.rollPeriod=function(){return this.rollPeriod_},$.prototype.xAxisRange=function(){return this.dateWindow_?this.dateWindow_:this.xAxisExtremes()},$.prototype.xAxisExtremes=function(){var a=this.getNumericOption("xRangePad")/this.plotter_.area.w;if(0===this.numRows())return[0-a,1+a];var b=this.rawData_[0][0],c=this.rawData_[this.rawData_.length-1][0];if(a){var d=c-b;b-=d*a,c+=d*a}return[b,c]},$.prototype.yAxisExtremes=function(){var a=this.gatherDatasets_(this.rolledSeries_,null),b=a.extremes,c=this.axes_;this.computeYAxisRanges_(b);var d=this.axes_;return this.axes_=c,d.map(function(a){return a.extremeRange})},$.prototype.yAxisRange=function(a){if(void 0===a&&(a=0),a<0||a>=this.axes_.length)return null;var b=this.axes_[a];return[b.computedValueRange[0],b.computedValueRange[1]]},$.prototype.yAxisRanges=function(){for(var a=[],b=0;b<this.axes_.length;b++)a.push(this.yAxisRange(b));return a},$.prototype.toDomCoords=function(a,b,c){return[this.toDomXCoord(a),this.toDomYCoord(b,c)]},$.prototype.toDomXCoord=function(a){if(null===a)return null;var b=this.plotter_.area,c=this.xAxisRange();return b.x+(a-c[0])/(c[1]-c[0])*b.w},$.prototype.toDomYCoord=function(a,b){var c=this.toPercentYCoord(a,b);if(null===c)return null;var d=this.plotter_.area;return d.y+c*d.h},$.prototype.toDataCoords=function(a,b,c){return[this.toDataXCoord(a),this.toDataYCoord(b,c)]},$.prototype.toDataXCoord=function(a){if(null===a)return null;var b=this.plotter_.area,c=this.xAxisRange();if(this.attributes_.getForAxis("logscale","x")){var d=(a-b.x)/b.w;return t.logRangeFraction(c[0],c[1],d)}return c[0]+(a-b.x)/b.w*(c[1]-c[0])},$.prototype.toDataYCoord=function(a,b){if(null===a)return null;var c=this.plotter_.area,d=this.yAxisRange(b);if(void 0===b&&(b=0),this.attributes_.getForAxis("logscale",b)){var e=(a-c.y)/c.h;return t.logRangeFraction(d[1],d[0],e)}return d[0]+(c.y+c.h-a)/c.h*(d[1]-d[0])},$.prototype.toPercentYCoord=function(a,b){if(null===a)return null;void 0===b&&(b=0);var c,d=this.yAxisRange(b);if(this.attributes_.getForAxis("logscale",b)){var e=t.log10(d[0]),f=t.log10(d[1]);c=(f-t.log10(a))/(f-e)}else c=(d[1]-a)/(d[1]-d[0]);return c},$.prototype.toPercentXCoord=function(a){if(null===a)return null;var b,c=this.xAxisRange();if(!0===this.attributes_.getForAxis("logscale","x")){var d=t.log10(c[0]),e=t.log10(c[1]);b=(t.log10(a)-d)/(e-d)}else b=(a-c[0])/(c[1]-c[0]);return b},$.prototype.numColumns=function(){return this.rawData_?this.rawData_[0]?this.rawData_[0].length:this.attr_("labels").length:0},$.prototype.numRows=function(){return this.rawData_?this.rawData_.length:0},$.prototype.getValue=function(a,b){return a<0||a>this.rawData_.length?null:b<0||b>this.rawData_[a].length?null:this.rawData_[a][b]},$.prototype.createInterface_=function(){var a=this.maindiv_;this.graphDiv=document.createElement("div"),this.graphDiv.style.textAlign="left",this.graphDiv.style.position="relative",a.appendChild(this.graphDiv),this.canvas_=t.createCanvas(),this.canvas_.style.position="absolute",this.hidden_=this.createPlotKitCanvas_(this.canvas_),this.canvas_ctx_=t.getContext(this.canvas_),this.hidden_ctx_=t.getContext(this.hidden_),this.resizeElements_(),this.graphDiv.appendChild(this.hidden_),this.graphDiv.appendChild(this.canvas_),this.mouseEventElement_=this.createMouseEventElement_(),this.layout_=new j.default(this);var b=this;this.mouseMoveHandler_=function(a){b.mouseMove_(a)},this.mouseOutHandler_=function(a){var c=a.target||a.fromElement,d=a.relatedTarget||a.toElement;t.isNodeContainedBy(c,b.graphDiv)&&!t.isNodeContainedBy(d,b.graphDiv)&&b.mouseOut_(a)},this.addAndTrackEvent(window,"mouseout",this.mouseOutHandler_),this.addAndTrackEvent(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),this.resizeHandler_||(this.resizeHandler_=function(a){setTimeout(function(){b.resize()},100)},this.addAndTrackEvent(window,"resize",this.resizeHandler_))},$.prototype.resizeElements_=function(){this.graphDiv.style.width=this.width_+"px",this.graphDiv.style.height=this.height_+"px";var a=this.getNumericOption("pixelRatio"),b=a||t.getContextPixelRatio(this.canvas_ctx_);this.canvas_.width=this.width_*b,this.canvas_.height=this.height_*b,this.canvas_.style.width=this.width_+"px",this.canvas_.style.height=this.height_+"px",1!==b&&this.canvas_ctx_.scale(b,b);var c=a||t.getContextPixelRatio(this.hidden_ctx_);this.hidden_.width=this.width_*c,this.hidden_.height=this.height_*c,this.hidden_.style.width=this.width_+"px",this.hidden_.style.height=this.height_+"px",1!==c&&this.hidden_ctx_.scale(c,c)},$.prototype.destroy=function(){this.canvas_ctx_.restore(),this.hidden_ctx_.restore();for(var a=this.plugins_.length-1;a>=0;a--){var b=this.plugins_.pop();b.plugin.destroy&&b.plugin.destroy()}this.removeTrackedEvents_(),t.removeEvent(window,"mouseout",this.mouseOutHandler_),t.removeEvent(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),t.removeEvent(window,"resize",this.resizeHandler_),this.resizeHandler_=null,function a(b){for(;b.hasChildNodes();)a(b.firstChild),b.removeChild(b.firstChild)}(this.maindiv_);var c=function(a){for(var b in a)"object"==typeof a[b]&&(a[b]=null)};c(this.layout_),c(this.plotter_),c(this)},$.prototype.createPlotKitCanvas_=function(a){var b=t.createCanvas();return b.style.position="absolute",b.style.top=a.style.top,b.style.left=a.style.left,b.width=this.width_,b.height=this.height_,b.style.width=this.width_+"px",b.style.height=this.height_+"px",b},$.prototype.createMouseEventElement_=function(){return this.canvas_},$.prototype.setColors_=function(){var a=this.getLabels(),b=a.length-1;this.colors_=[],this.colorsMap_={};for(var c=this.getNumericOption("colorSaturation")||1,d=this.getNumericOption("colorValue")||.5,e=Math.ceil(b/2),f=this.getOption("colors"),g=this.visibility(),h=0;h<b;h++)if(g[h]){var i=a[h+1],j=this.attributes_.getForSeries("color",i);if(!j)if(f)j=f[h%f.length];else{var k=h%2?e+(h+1)/2:Math.ceil((h+1)/2),l=1*k/(1+b);j=t.hsvToRGB(l,c,d)}this.colors_.push(j),this.colorsMap_[i]=j}},$.prototype.getColors=function(){return this.colors_},$.prototype.getPropertiesForSeries=function(a){for(var b=-1,c=this.getLabels(),d=1;d<c.length;d++)if(c[d]==a){b=d;break}return-1==b?null:{name:a,column:b,visible:this.visibility()[b-1],color:this.colorsMap_[a],axis:1+this.attributes_.axisForSeries(a)}},$.prototype.createRollInterface_=function(){var a=this,b=this.roller_;b||(this.roller_=b=document.createElement("input"),b.type="text",b.style.display="none",b.className="dygraph-roller",this.graphDiv.appendChild(b));var c=this.getBooleanOption("showRoller")?"block":"none",d=this.getArea(),e={top:d.y+d.h-25+"px",left:d.x+1+"px",display:c};b.size="2",b.value=this.rollPeriod_,t.update(b.style,e),b.onchange=function(){return a.adjustRoll(b.value)}},$.prototype.createDragInterface_=function(){var a={isZooming:!1,isPanning:!1,is2DPan:!1,dragStartX:null,dragStartY:null,dragEndX:null,dragEndY:null,dragDirection:null,prevEndX:null,prevEndY:null,prevDragDirection:null,cancelNextDblclick:!1,initialLeftmostDate:null,xUnitsPerPixel:null,dateRange:null,px:0,py:0,boundedDates:null,boundedValues:null,tarp:new z.default,initializeMouseDown:function(a,b,c){a.preventDefault?a.preventDefault():(a.returnValue=!1,a.cancelBubble=!0);var d=t.findPos(b.canvas_);c.px=d.x,c.py=d.y,c.dragStartX=t.dragGetX_(a,c),c.dragStartY=t.dragGetY_(a,c),c.cancelNextDblclick=!1,c.tarp.cover()},destroy:function(){var a=this;if((a.isZooming||a.isPanning)&&(a.isZooming=!1,a.dragStartX=null,a.dragStartY=null),a.isPanning){a.isPanning=!1,a.draggingDate=null,a.dateRange=null;for(var b=0;b<c.axes_.length;b++)delete c.axes_[b].draggingValue,delete c.axes_[b].dragValueRange}a.tarp.uncover()}},b=this.getOption("interactionModel"),c=this;for(var d in b)b.hasOwnProperty(d)&&this.addAndTrackEvent(this.mouseEventElement_,d,function(b){return function(d){b(d,c,a)}}(b[d]));if(!b.willDestroyContextMyself){var e=function(b){a.destroy()};this.addAndTrackEvent(document,"mouseup",e)}},$.prototype.drawZoomRect_=function(a,b,c,d,e,f,g,h){var i=this.canvas_ctx_;f==t.HORIZONTAL?i.clearRect(Math.min(b,g),this.layout_.getPlotArea().y,Math.abs(b-g),this.layout_.getPlotArea().h):f==t.VERTICAL&&i.clearRect(this.layout_.getPlotArea().x,Math.min(d,h),this.layout_.getPlotArea().w,Math.abs(d-h)),a==t.HORIZONTAL?c&&b&&(i.fillStyle="rgba(128,128,128,0.33)",i.fillRect(Math.min(b,c),this.layout_.getPlotArea().y,Math.abs(c-b),this.layout_.getPlotArea().h)):a==t.VERTICAL&&e&&d&&(i.fillStyle="rgba(128,128,128,0.33)",i.fillRect(this.layout_.getPlotArea().x,Math.min(d,e),this.layout_.getPlotArea().w,Math.abs(e-d)))},$.prototype.clearZoomRect_=function(){this.currentZoomRectArgs_=null,this.canvas_ctx_.clearRect(0,0,this.width_,this.height_)},$.prototype.doZoomX_=function(a,b){this.currentZoomRectArgs_=null;var c=this.toDataXCoord(a),d=this.toDataXCoord(b);this.doZoomXDates_(c,d)},$.prototype.doZoomXDates_=function(a,b){var c=this,d=this.xAxisRange(),e=[a,b],f=this.getFunctionOption("zoomCallback");this.doAnimatedZoom(d,e,null,null,function(){f&&f.call(c,a,b,c.yAxisRanges())})},$.prototype.doZoomY_=function(a,b){var c=this;this.currentZoomRectArgs_=null;for(var d=this.yAxisRanges(),e=[],f=0;f<this.axes_.length;f++){var g=this.toDataYCoord(a,f),i=this.toDataYCoord(b,f);e.push([i,g])}var j=this.getFunctionOption("zoomCallback");this.doAnimatedZoom(null,null,d,e,function(){if(j){var a=c.xAxisRange(),b=h(a,2),d=b[0],e=b[1];j.call(c,d,e,c.yAxisRanges())}})},$.zoomAnimationFunction=function(a,b){return(1-Math.pow(1.5,-a))/(1-Math.pow(1.5,-b))},$.prototype.resetZoom=function(){var a=this,b=this.isZoomed("x"),c=this.isZoomed("y"),d=b||c;if(this.clearSelection(),d){var e=this.xAxisExtremes(),f=h(e,2),g=f[0],i=f[1],j=this.getBooleanOption("animatedZooms"),k=this.getFunctionOption("zoomCallback");if(!j)return this.dateWindow_=null,this.axes_.forEach(function(a){a.valueRange&&delete a.valueRange}),this.drawGraph_(),void(k&&k.call(this,g,i,this.yAxisRanges()));var l=null,m=null,n=null,o=null;b&&(l=this.xAxisRange(),m=[g,i]),c&&(n=this.yAxisRanges(),o=this.yAxisExtremes()),this.doAnimatedZoom(l,m,n,o,function(){a.dateWindow_=null,a.axes_.forEach(function(a){a.valueRange&&delete a.valueRange}),k&&k.call(a,g,i,a.yAxisRanges())})}},$.prototype.doAnimatedZoom=function(a,b,c,d,e){var f,g,h=this,i=this.getBooleanOption("animatedZooms")?$.ANIMATION_STEPS:1,j=[],k=[];if(null!==a&&null!==b)for(f=1;f<=i;f++)g=$.zoomAnimationFunction(f,i),j[f-1]=[a[0]*(1-g)+g*b[0],a[1]*(1-g)+g*b[1]];if(null!==c&&null!==d)for(f=1;f<=i;f++){g=$.zoomAnimationFunction(f,i);for(var l=[],m=0;m<this.axes_.length;m++)l.push([c[m][0]*(1-g)+g*d[m][0],c[m][1]*(1-g)+g*d[m][1]]);k[f-1]=l}t.repeatAndCleanup(function(a){if(k.length)for(var b=0;b<h.axes_.length;b++){var c=k[a][b];h.axes_[b].valueRange=[c[0],c[1]]}j.length&&(h.dateWindow_=j[a]),h.drawGraph_()},i,$.ANIMATION_DURATION/i,e)},$.prototype.getArea=function(){return this.plotter_.area},$.prototype.eventToDomCoords=function(a){if(a.offsetX&&a.offsetY)return[a.offsetX,a.offsetY];var b=t.findPos(this.mouseEventElement_);return[t.pageX(a)-b.x,t.pageY(a)-b.y]},$.prototype.findClosestRow=function(a){for(var b=1/0,c=-1,d=this.layout_.points,e=0;e<d.length;e++)for(var f=d[e],g=f.length,h=0;h<g;h++){var i=f[h];if(t.isValidPoint(i,!0)){var j=Math.abs(i.canvasx-a);j<b&&(b=j,c=i.idx)}}return c},$.prototype.findClosestPoint=function(a,b){for(var c,d,e,f,g,h,i,j=1/0,k=this.layout_.points.length-1;k>=0;--k)for(var l=this.layout_.points[k],m=0;m<l.length;++m)f=l[m],t.isValidPoint(f)&&(d=f.canvasx-a,e=f.canvasy-b,(c=d*d+e*e)<j&&(j=c,g=f,h=k,i=f.idx));return{row:i,seriesName:this.layout_.setNames[h],point:g}},$.prototype.findStackedPoint=function(a,b){for(var c,d,e=this.findClosestRow(a),f=0;f<this.layout_.points.length;++f){var g=this.getLeftBoundary_(f),h=e-g,i=this.layout_.points[f];if(!(h>=i.length)){var j=i[h];if(t.isValidPoint(j)){var k=j.canvasy;if(a>j.canvasx&&h+1<i.length){var l=i[h+1];if(t.isValidPoint(l)){var m=l.canvasx-j.canvasx;if(m>0){var n=(a-j.canvasx)/m;k+=n*(l.canvasy-j.canvasy)}}}else if(a<j.canvasx&&h>0){var o=i[h-1];if(t.isValidPoint(o)){var m=j.canvasx-o.canvasx;if(m>0){var n=(j.canvasx-a)/m;k+=n*(o.canvasy-j.canvasy)}}}(0===f||k<b)&&(c=j,d=f)}}}return{row:e,seriesName:this.layout_.setNames[d],point:c}},$.prototype.mouseMove_=function(a){var b=this.layout_.points;if(void 0!==b&&null!==b){var c=this.eventToDomCoords(a),d=c[0],e=c[1],f=this.getOption("highlightSeriesOpts"),g=!1;if(f&&!this.isSeriesLocked()){var h;h=this.getBooleanOption("stackedGraph")?this.findStackedPoint(d,e):this.findClosestPoint(d,e),g=this.setSelection(h.row,h.seriesName)}else{var i=this.findClosestRow(d);g=this.setSelection(i)}var j=this.getFunctionOption("highlightCallback");j&&g&&j.call(this,a,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}},$.prototype.getLeftBoundary_=function(a){if(this.boundaryIds_[a])return this.boundaryIds_[a][0];for(var b=0;b<this.boundaryIds_.length;b++)if(void 0!==this.boundaryIds_[b])return this.boundaryIds_[b][0];return 0},$.prototype.animateSelection_=function(a){void 0===this.fadeLevel&&(this.fadeLevel=0),void 0===this.animateId&&(this.animateId=0);var b=this.fadeLevel,c=a<0?b:10-b;if(c<=0)return void(this.fadeLevel&&this.updateSelection_(1));var d=++this.animateId,e=this,f=function(){0!==e.fadeLevel&&a<0&&(e.fadeLevel=0,e.clearSelection())};t.repeatAndCleanup(function(b){e.animateId==d&&(e.fadeLevel+=a,0===e.fadeLevel?e.clearSelection():e.updateSelection_(e.fadeLevel/10))},c,30,f)},$.prototype.updateSelection_=function(a){this.cascadeEvents_("select",{selectedRow:-1===this.lastRow_?void 0:this.lastRow_,selectedX:-1===this.lastx_?void 0:this.lastx_,selectedPoints:this.selPoints_});var b,c=this.canvas_ctx_;if(this.getOption("highlightSeriesOpts")){c.clearRect(0,0,this.width_,this.height_);var d=1-this.getNumericOption("highlightSeriesBackgroundAlpha"),e=t.toRGB_(this.getOption("highlightSeriesBackgroundColor"));if(d){if(void 0===a)return void this.animateSelection_(1);d*=a,c.fillStyle="rgba("+e.r+","+e.g+","+e.b+","+d+")",c.fillRect(0,0,this.width_,this.height_)}
this.plotter_._renderLineChart(this.highlightSet_,c)}else if(this.previousVerticalX_>=0){var f=0,g=this.attr_("labels");for(b=1;b<g.length;b++){var h=this.getNumericOption("highlightCircleSize",g[b]);h>f&&(f=h)}var i=this.previousVerticalX_;c.clearRect(i-f-1,0,2*f+2,this.height_)}if(this.selPoints_.length>0){var j=this.selPoints_[0].canvasx;for(c.save(),b=0;b<this.selPoints_.length;b++){var k=this.selPoints_[b];if(!isNaN(k.canvasy)){var l=this.getNumericOption("highlightCircleSize",k.name),m=this.getFunctionOption("drawHighlightPointCallback",k.name),n=this.plotter_.colors[k.name];m||(m=t.Circles.DEFAULT),c.lineWidth=this.getNumericOption("strokeWidth",k.name),c.strokeStyle=n,c.fillStyle=n,m.call(this,this,k.name,c,j,k.canvasy,n,l,k.idx)}}c.restore(),this.previousVerticalX_=j}},$.prototype.setSelection=function(a,b,c){this.selPoints_=[];var d=!1;if(!1!==a&&a>=0){a!=this.lastRow_&&(d=!0),this.lastRow_=a;for(var e=0;e<this.layout_.points.length;++e){var f=this.layout_.points[e],g=a-this.getLeftBoundary_(e);if(g>=0&&g<f.length&&f[g].idx==a){var h=f[g];null!==h.yval&&this.selPoints_.push(h)}else for(var i=0;i<f.length;++i){var h=f[i];if(h.idx==a){null!==h.yval&&this.selPoints_.push(h);break}}}}else this.lastRow_>=0&&(d=!0),this.lastRow_=-1;return this.selPoints_.length?this.lastx_=this.selPoints_[0].xval:this.lastx_=-1,void 0!==b&&(this.highlightSet_!==b&&(d=!0),this.highlightSet_=b),void 0!==c&&(this.lockedSet_=c),d&&this.updateSelection_(void 0),d},$.prototype.mouseOut_=function(a){this.getFunctionOption("unhighlightCallback")&&this.getFunctionOption("unhighlightCallback").call(this,a),this.getBooleanOption("hideOverlayOnMouseOut")&&!this.lockedSet_&&this.clearSelection()},$.prototype.clearSelection=function(){if(this.cascadeEvents_("deselect",{}),this.lockedSet_=!1,this.fadeLevel)return void this.animateSelection_(-1);this.canvas_ctx_.clearRect(0,0,this.width_,this.height_),this.fadeLevel=0,this.selPoints_=[],this.lastx_=-1,this.lastRow_=-1,this.highlightSet_=null},$.prototype.getSelection=function(){if(!this.selPoints_||this.selPoints_.length<1)return-1;for(var a=0;a<this.layout_.points.length;a++)for(var b=this.layout_.points[a],c=0;c<b.length;c++)if(b[c].x==this.selPoints_[0].x)return b[c].idx;return-1},$.prototype.getHighlightSeries=function(){return this.highlightSet_},$.prototype.isSeriesLocked=function(){return this.lockedSet_},$.prototype.loadedEvent_=function(a){this.rawData_=this.parseCSV_(a),this.cascadeDataDidUpdateEvent_(),this.predraw_()},$.prototype.addXTicks_=function(){var a;a=this.dateWindow_?[this.dateWindow_[0],this.dateWindow_[1]]:this.xAxisExtremes();var b=this.optionsViewForAxis_("x"),c=b("ticker")(a[0],a[1],this.plotter_.area.w,b,this);this.layout_.setXTicks(c)},$.prototype.getHandlerClass_=function(){return this.attr_("dataHandler")?this.attr_("dataHandler"):this.fractions_?this.getBooleanOption("errorBars")?J.default:H.default:this.getBooleanOption("customBars")?F.default:this.getBooleanOption("errorBars")?D.default:B.default},$.prototype.predraw_=function(){var a=new Date;this.dataHandler_=new(this.getHandlerClass_()),this.layout_.computePlotArea(),this.computeYAxes_(),this.is_initial_draw_||(this.canvas_ctx_.restore(),this.hidden_ctx_.restore()),this.canvas_ctx_.save(),this.hidden_ctx_.save(),this.plotter_=new l.default(this,this.hidden_,this.hidden_ctx_,this.layout_),this.createRollInterface_(),this.cascadeEvents_("predraw"),this.rolledSeries_=[null];for(var b=1;b<this.numColumns();b++){var c=this.dataHandler_.extractSeries(this.rawData_,b,this.attributes_);this.rollPeriod_>1&&(c=this.dataHandler_.rollingAverage(c,this.rollPeriod_,this.attributes_)),this.rolledSeries_.push(c)}this.drawGraph_();var d=new Date;this.drawingTimeMs_=d-a},$.PointType=void 0,$.stackPoints_=function(a,b,c,d){for(var e=null,f=null,g=null,h=-1,i=0;i<a.length;++i){var j=a[i],k=j.xval;void 0===b[k]&&(b[k]=0);var l=j.yval;isNaN(l)||null===l?"none"==d?l=0:(!function(b){if(!(h>=b))for(var c=b;c<a.length;++c)if(g=null,!isNaN(a[c].yval)&&null!==a[c].yval){h=c,g=a[c];break}}(i),l=f&&g&&"none"!=d?f.yval+(g.yval-f.yval)*((k-f.xval)/(g.xval-f.xval)):f&&"all"==d?f.yval:g&&"all"==d?g.yval:0):f=j;var m=b[k];e!=k&&(m+=l,b[k]=m),e=k,j.yval_stacked=m,m>c[1]&&(c[1]=m),m<c[0]&&(c[0]=m)}},$.prototype.gatherDatasets_=function(a,b){var c,d,e,f,g,h,i=[],j=[],k=[],l={},m=a.length-1;for(c=m;c>=1;c--)if(this.visibility()[c-1]){if(b){h=a[c];var n=b[0],o=b[1];for(e=null,f=null,d=0;d<h.length;d++)h[d][0]>=n&&null===e&&(e=d),h[d][0]<=o&&(f=d);null===e&&(e=0);for(var p=e,q=!0;q&&p>0;)p--,q=null===h[p][1];null===f&&(f=h.length-1);var r=f;for(q=!0;q&&r<h.length-1;)r++,q=null===h[r][1];p!==e&&(e=p),r!==f&&(f=r),i[c-1]=[e,f],h=h.slice(e,f+1)}else h=a[c],i[c-1]=[0,h.length-1];var s=this.attr_("labels")[c],t=this.dataHandler_.getExtremeYValues(h,b,this.getBooleanOption("stepPlot",s)),u=this.dataHandler_.seriesToPoints(h,s,i[c-1][0]);this.getBooleanOption("stackedGraph")&&(g=this.attributes_.axisForSeries(s),void 0===k[g]&&(k[g]=[]),$.stackPoints_(u,k[g],t,this.getBooleanOption("stackedGraphNaNFill"))),l[s]=t,j[c]=u}return{points:j,extremes:l,boundaryIds:i}},$.prototype.drawGraph_=function(){var a=new Date,b=this.is_initial_draw_;this.is_initial_draw_=!1,this.layout_.removeAllDatasets(),this.setColors_(),this.attrs_.pointSize=.5*this.getNumericOption("highlightCircleSize");var c=this.gatherDatasets_(this.rolledSeries_,this.dateWindow_),d=c.points,e=c.extremes;this.boundaryIds_=c.boundaryIds,this.setIndexByName_={};for(var f=this.attr_("labels"),g=0,h=1;h<d.length;h++)this.visibility()[h-1]&&(this.layout_.addDataset(f[h],d[h]),this.datasetIndex_[h]=g++);for(var h=0;h<f.length;h++)this.setIndexByName_[f[h]]=h;if(this.computeYAxisRanges_(e),this.layout_.setYAxes(this.axes_),this.addXTicks_(),this.layout_.evaluate(),this.renderGraph_(b),this.getStringOption("timingName")){var i=new Date;console.log(this.getStringOption("timingName")+" - drawGraph: "+(i-a)+"ms")}},$.prototype.renderGraph_=function(a){this.cascadeEvents_("clearChart"),this.plotter_.clear();var b=this.getFunctionOption("underlayCallback");b&&b.call(this,this.hidden_ctx_,this.layout_.getPlotArea(),this,this);var c={canvas:this.hidden_,drawingContext:this.hidden_ctx_};this.cascadeEvents_("willDrawChart",c),this.plotter_.render(),this.cascadeEvents_("didDrawChart",c),this.lastRow_=-1,this.canvas_.getContext("2d").clearRect(0,0,this.width_,this.height_);var d=this.getFunctionOption("drawCallback");if(null!==d&&d.call(this,this,a),a)for(this.readyFired_=!0;this.readyFns_.length>0;){var e=this.readyFns_.pop();e(this)}},$.prototype.computeYAxes_=function(){var a,b,c;for(this.axes_=[],a=0;a<this.attributes_.numAxes();a++)b={g:this},t.update(b,this.attributes_.axisOptions(a)),this.axes_[a]=b;for(a=0;a<this.axes_.length;a++)if(0===a)b=this.optionsViewForAxis_("y"+(a?"2":"")),(c=b("valueRange"))&&(this.axes_[a].valueRange=c);else{var d=this.user_attrs_.axes;d&&d.y2&&(c=d.y2.valueRange)&&(this.axes_[a].valueRange=c)}},$.prototype.numAxes=function(){return this.attributes_.numAxes()},$.prototype.axisPropertiesForSeries=function(a){return this.axes_[this.attributes_.axisForSeries(a)]},$.prototype.computeYAxisRanges_=function(a){for(var b,c,d,e,f,g=function(a){return isNaN(parseFloat(a))},h=this.attributes_.numAxes(),i=0;i<h;i++){var j=this.axes_[i],k=this.attributes_.getForAxis("logscale",i),l=this.attributes_.getForAxis("includeZero",i),m=this.attributes_.getForAxis("independentTicks",i);d=this.attributes_.seriesForAxis(i),b=!0,e=.1;var n=this.getNumericOption("yRangePad");if(null!==n&&(b=!1,e=n/this.plotter_.area.h),0===d.length)j.extremeRange=[0,1];else{for(var o,p,q=1/0,r=-1/0,s=0;s<d.length;s++)a.hasOwnProperty(d[s])&&(o=a[d[s]][0],null!==o&&(q=Math.min(o,q)),null!==(p=a[d[s]][1])&&(r=Math.max(p,r)));l&&!k&&(q>0&&(q=0),r<0&&(r=0)),q==1/0&&(q=0),r==-1/0&&(r=1),c=r-q,0===c&&(0!==r?c=Math.abs(r):(r=1,c=1));var u=r,v=q;b&&(k?(u=r+e*c,v=q):(u=r+e*c,v=q-e*c,v<0&&q>=0&&(v=0),u>0&&r<=0&&(u=0))),j.extremeRange=[v,u]}if(j.valueRange){var w=g(j.valueRange[0])?j.extremeRange[0]:j.valueRange[0],x=g(j.valueRange[1])?j.extremeRange[1]:j.valueRange[1];j.computedValueRange=[w,x]}else j.computedValueRange=j.extremeRange;if(!b)if(w=j.computedValueRange[0],x=j.computedValueRange[1],w===x&&(w-=.5,x+=.5),k){var y=e/(2*e-1),z=(e-1)/(2*e-1);j.computedValueRange[0]=t.logRangeFraction(w,x,y),j.computedValueRange[1]=t.logRangeFraction(w,x,z)}else c=x-w,j.computedValueRange[0]=w-c*e,j.computedValueRange[1]=x+c*e;if(m){j.independentTicks=m;var A=this.optionsViewForAxis_("y"+(i?"2":"")),B=A("ticker");j.ticks=B(j.computedValueRange[0],j.computedValueRange[1],this.plotter_.area.h,A,this),f||(f=j)}}if(void 0===f)throw'Configuration Error: At least one axis has to have the "independentTicks" option activated.';for(var i=0;i<h;i++){var j=this.axes_[i];if(!j.independentTicks){for(var A=this.optionsViewForAxis_("y"+(i?"2":"")),B=A("ticker"),C=f.ticks,D=f.computedValueRange[1]-f.computedValueRange[0],E=j.computedValueRange[1]-j.computedValueRange[0],F=[],G=0;G<C.length;G++){var H=(C[G].v-f.computedValueRange[0])/D,I=j.computedValueRange[0]+H*E;F.push(I)}j.ticks=B(j.computedValueRange[0],j.computedValueRange[1],this.plotter_.area.h,A,this,F)}}},$.prototype.detectTypeFromString_=function(a){var b=!1,c=a.indexOf("-");c>0&&"e"!=a[c-1]&&"E"!=a[c-1]||a.indexOf("/")>=0||isNaN(parseFloat(a))?b=!0:8==a.length&&a>"19700101"&&a<"20371231"&&(b=!0),this.setXAxisOptions_(b)},$.prototype.setXAxisOptions_=function(a){a?(this.attrs_.xValueParser=t.dateParser,this.attrs_.axes.x.valueFormatter=t.dateValueFormatter,this.attrs_.axes.x.ticker=r.dateTicker,this.attrs_.axes.x.axisLabelFormatter=t.dateAxisLabelFormatter):(this.attrs_.xValueParser=function(a){return parseFloat(a)},this.attrs_.axes.x.valueFormatter=function(a){return a},this.attrs_.axes.x.ticker=r.numericTicks,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter)},$.prototype.parseCSV_=function(a){var b,c,d=[],e=t.detectLineDelimiter(a),f=a.split(e||"\n"),g=this.getStringOption("delimiter");-1==f[0].indexOf(g)&&f[0].indexOf("\t")>=0&&(g="\t");var h=0;"labels"in this.user_attrs_||(h=1,this.attrs_.labels=f[0].split(g),this.attributes_.reparseSeries());for(var i,j=!1,k=this.attr_("labels").length,l=!1,m=h;m<f.length;m++){var n=f[m];if(m,0!==n.length&&"#"!=n[0]){var o=n.split(g);if(!(o.length<2)){var p=[];if(j||(this.detectTypeFromString_(o[0]),i=this.getFunctionOption("xValueParser"),j=!0),p[0]=i(o[0],this),this.fractions_)for(c=1;c<o.length;c++)b=o[c].split("/"),2!=b.length?(console.error('Expected fractional "num/den" values in CSV data but found a value \''+o[c]+"' on line "+(1+m)+" ('"+n+"') which is not of this form."),p[c]=[0,0]):p[c]=[t.parseFloat_(b[0],m,n),t.parseFloat_(b[1],m,n)];else if(this.getBooleanOption("errorBars"))for(o.length%2!=1&&console.error("Expected alternating (value, stdev.) pairs in CSV data but line "+(1+m)+" has an odd number of values ("+(o.length-1)+"): '"+n+"'"),c=1;c<o.length;c+=2)p[(c+1)/2]=[t.parseFloat_(o[c],m,n),t.parseFloat_(o[c+1],m,n)];else if(this.getBooleanOption("customBars"))for(c=1;c<o.length;c++){var q=o[c];/^ *$/.test(q)?p[c]=[null,null,null]:(b=q.split(";"),3==b.length?p[c]=[t.parseFloat_(b[0],m,n),t.parseFloat_(b[1],m,n),t.parseFloat_(b[2],m,n)]:console.warn('When using customBars, values must be either blank or "low;center;high" tuples (got "'+q+'" on line '+(1+m)))}else for(c=1;c<o.length;c++)p[c]=t.parseFloat_(o[c],m,n);if(d.length>0&&p[0]<d[d.length-1][0]&&(l=!0),p.length!=k&&console.error("Number of columns in line "+m+" ("+p.length+") does not agree with number of labels ("+k+") "+n),0===m&&this.attr_("labels")){var r=!0;for(c=0;r&&c<p.length;c++)p[c]&&(r=!1);if(r){console.warn("The dygraphs 'labels' option is set, but the first row of CSV data ('"+n+"') appears to also contain labels. Will drop the CSV labels and use the option labels.");continue}}d.push(p)}}}return l&&(console.warn("CSV is out of order; order it correctly to speed loading."),d.sort(function(a,b){return a[0]-b[0]})),d},$.prototype.parseArray_=function(a){if(0===a.length)return console.error("Can't plot empty data set"),null;if(0===a[0].length)return console.error("Data set cannot contain an empty row"),null;g(a);var b;if(null===this.attr_("labels")){for(console.warn("Using default labels. Set labels explicitly via 'labels' in the options parameter"),this.attrs_.labels=["X"],b=1;b<a[0].length;b++)this.attrs_.labels.push("Y"+b);this.attributes_.reparseSeries()}else{var c=this.attr_("labels");if(c.length!=a[0].length){console.warn("Mismatch between number of labels ("+c+") and number of columns in array ("+a[0].length+")"),this.attrs_.labels=c;for(var b=c.length;b<a[0].length;b++)this.attrs_.labels.push("Y"+b);this.attributes_.reparseSeries()}}if(t.isDateLike(a[0][0])){this.attrs_.axes.x.valueFormatter=t.dateValueFormatter,this.attrs_.axes.x.ticker=r.dateTicker,this.attrs_.axes.x.axisLabelFormatter=t.dateAxisLabelFormatter;var d=t.clone(a);for(b=0;b<a.length;b++){if(0===d[b].length)return console.error("Row "+(1+b)+" of data is empty"),null;if(null===d[b][0]||"function"!=typeof d[b][0].getTime||isNaN(d[b][0].getTime()))return console.error("x value in row "+(1+b)+" is not a Date"),null;d[b][0]=d[b][0].getTime()}return d}return this.attrs_.axes.x.valueFormatter=function(a){return a},this.attrs_.axes.x.ticker=r.numericTicks,this.attrs_.axes.x.axisLabelFormatter=t.numberAxisLabelFormatter,a},$.prototype.parseDataTable_=function(a){var b=a.getNumberOfColumns(),c=a.getNumberOfRows(),d=a.getColumnType(0);if("date"==d||"datetime"==d)this.attrs_.xValueParser=t.dateParser,this.attrs_.axes.x.valueFormatter=t.dateValueFormatter,this.attrs_.axes.x.ticker=r.dateTicker,this.attrs_.axes.x.axisLabelFormatter=t.dateAxisLabelFormatter;else{if("number"!=d)throw new Error("only 'date', 'datetime' and 'number' types are supported for column 1 of DataTable input (Got '"+d+"')");this.attrs_.xValueParser=function(a){return parseFloat(a)},this.attrs_.axes.x.valueFormatter=function(a){return a},this.attrs_.axes.x.ticker=r.numericTicks,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter}var e,f,g=[],h={},i=!1;for(e=1;e<b;e++){var j=a.getColumnType(e);if("number"==j)g.push(e);else{if("string"!=j||!this.getBooleanOption("displayAnnotations"))throw new Error("Only 'number' is supported as a dependent type with Gviz. 'string' is only supported if displayAnnotations is true");var k=g[g.length-1];h.hasOwnProperty(k)?h[k].push(e):h[k]=[e],i=!0}}var l=[a.getColumnLabel(0)];for(e=0;e<g.length;e++)l.push(a.getColumnLabel(g[e])),this.getBooleanOption("errorBars")&&(e+=1);this.attrs_.labels=l,b=l.length;var m=[],n=!1,o=[];for(e=0;e<c;e++){var p=[];if(void 0!==a.getValue(e,0)&&null!==a.getValue(e,0)){if("date"==d||"datetime"==d?p.push(a.getValue(e,0).getTime()):p.push(a.getValue(e,0)),this.getBooleanOption("errorBars"))for(f=0;f<b-1;f++)p.push([a.getValue(e,1+2*f),a.getValue(e,2+2*f)]);else{for(f=0;f<g.length;f++){var q=g[f];if(p.push(a.getValue(e,q)),i&&h.hasOwnProperty(q)&&null!==a.getValue(e,h[q][0])){var s={};s.series=a.getColumnLabel(q),s.xval=p[0],s.shortText=function(a){var b=String.fromCharCode(65+a%26);for(a=Math.floor(a/26);a>0;)b=String.fromCharCode(65+(a-1)%26)+b.toLowerCase(),a=Math.floor((a-1)/26);return b}(o.length),s.text="";for(var u=0;u<h[q].length;u++)u&&(s.text+="\n"),s.text+=a.getValue(e,h[q][u]);o.push(s)}}for(f=0;f<p.length;f++)isFinite(p[f])||(p[f]=null)}m.length>0&&p[0]<m[m.length-1][0]&&(n=!0),m.push(p)}else console.warn("Ignoring row "+e+" of DataTable because of undefined or null first column.")}n&&(console.warn("DataTable is out of order; order it correctly to speed loading."),m.sort(function(a,b){return a[0]-b[0]})),this.rawData_=m,o.length>0&&this.setAnnotations(o,!0),this.attributes_.reparseSeries()},$.prototype.cascadeDataDidUpdateEvent_=function(){this.cascadeEvents_("dataDidUpdate",{})},$.prototype.start_=function(){var a=this.file_;if("function"==typeof a&&(a=a()),t.isArrayLike(a))this.rawData_=this.parseArray_(a),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if("object"==typeof a&&"function"==typeof a.getColumnRange)this.parseDataTable_(a),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if("string"==typeof a){var b=t.detectLineDelimiter(a);if(b)this.loadedEvent_(a);else{var c;c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");var d=this;c.onreadystatechange=function(){4==c.readyState&&(200!==c.status&&0!==c.status||d.loadedEvent_(c.responseText))},c.open("GET",a,!0),c.send(null)}}else console.error("Unknown data format: "+typeof a)},$.prototype.updateOptions=function(a,b){void 0===b&&(b=!1);var c=a.file,d=$.copyUserAttrs_(a);"rollPeriod"in d&&(this.rollPeriod_=d.rollPeriod),"dateWindow"in d&&(this.dateWindow_=d.dateWindow);var e=t.isPixelChangingOptionList(this.attr_("labels"),d);t.updateDeep(this.user_attrs_,d),this.attributes_.reparseSeries(),c?(this.cascadeEvents_("dataWillUpdate",{}),this.file_=c,b||this.start_()):b||(e?this.predraw_():this.renderGraph_(!1))},$.copyUserAttrs_=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&"file"!=c&&a.hasOwnProperty(c)&&(b[c]=a[c]);return b},$.prototype.resize=function(a,b){if(!this.resize_lock){this.resize_lock=!0,null===a!=(null===b)&&(console.warn("Dygraph.resize() should be called with zero parameters or two non-NULL parameters. Pretending it was zero."),a=b=null);var c=this.width_,d=this.height_;a?(this.maindiv_.style.width=a+"px",this.maindiv_.style.height=b+"px",this.width_=a,this.height_=b):(this.width_=this.maindiv_.clientWidth,this.height_=this.maindiv_.clientHeight),c==this.width_&&d==this.height_||(this.resizeElements_(),this.predraw_()),this.resize_lock=!1}},$.prototype.adjustRoll=function(a){this.rollPeriod_=a,this.predraw_()},$.prototype.visibility=function(){for(this.getOption("visibility")||(this.attrs_.visibility=[]);this.getOption("visibility").length<this.numColumns()-1;)this.attrs_.visibility.push(!0);return this.getOption("visibility")},$.prototype.setVisibility=function(a,b){var c=this.visibility(),d=!1;if(Array.isArray(a)||(null!==a&&"object"==typeof a?d=!0:a=[a]),d)for(var e in a)a.hasOwnProperty(e)&&(e<0||e>=c.length?console.warn("Invalid series number in setVisibility: "+e):c[e]=a[e]);else for(var e=0;e<a.length;e++)"boolean"==typeof a[e]?e>=c.length?console.warn("Invalid series number in setVisibility: "+e):c[e]=a[e]:a[e]<0||a[e]>=c.length?console.warn("Invalid series number in setVisibility: "+a[e]):c[a[e]]=b;this.predraw_()},$.prototype.size=function(){return{width:this.width_,height:this.height_}},$.prototype.setAnnotations=function(a,b){if(this.annotations_=a,!this.layout_)return void console.warn("Tried to setAnnotations before dygraph was ready. Try setting them in a ready() block. See dygraphs.com/tests/annotation.html");this.layout_.setAnnotations(this.annotations_),b||this.predraw_()},$.prototype.annotations=function(){return this.annotations_},$.prototype.getLabels=function(){var a=this.attr_("labels");return a?a.slice():null},$.prototype.indexFromSetName=function(a){return this.setIndexByName_[a]},$.prototype.getRowForX=function(a){for(var b=0,c=this.numRows()-1;b<=c;){var d=c+b>>1,e=this.getValue(d,0);if(e<a)b=d+1;else if(e>a)c=d-1;else{if(b==d)return d;c=d}}return null},$.prototype.ready=function(a){this.is_initial_draw_?this.readyFns_.push(a):a.call(this,this)},$.prototype.addAndTrackEvent=function(a,b,c){t.addEvent(a,b,c),this.registeredEvents_.push({elem:a,type:b,fn:c})},$.prototype.removeTrackedEvents_=function(){if(this.registeredEvents_)for(var a=0;a<this.registeredEvents_.length;a++){var b=this.registeredEvents_[a];t.removeEvent(b.elem,b.type,b.fn)}this.registeredEvents_=[]},$.PLUGINS=[V.default,P.default,X.default,R.default,N.default,T.default],$.GVizChart=Z.default,$.DASHED_LINE=t.DASHED_LINE,$.DOT_DASH_LINE=t.DOT_DASH_LINE,$.dateAxisLabelFormatter=t.dateAxisLabelFormatter,$.toRGB_=t.toRGB_,$.findPos=t.findPos,$.pageX=t.pageX,$.pageY=t.pageY,$.dateString_=t.dateString_,$.defaultInteractionModel=p.default.defaultModel,$.nonInteractiveModel=$.nonInteractiveModel_=p.default.nonInteractiveModel_,$.Circles=t.Circles,$.Plugins={Legend:V.default,Axes:P.default,Annotations:N.default,ChartLabels:R.default,Grid:T.default,RangeSelector:X.default},$.DataHandlers={DefaultHandler:B.default,BarsHandler:L.default,CustomBarsHandler:F.default,DefaultFractionHandler:H.default,ErrorBarsHandler:D.default,FractionsBarsHandler:J.default},$.startPan=p.default.startPan,$.startZoom=p.default.startZoom,$.movePan=p.default.movePan,$.moveZoom=p.default.moveZoom,$.endPan=p.default.endPan,$.endZoom=p.default.endZoom,$.numericLinearTicks=r.numericLinearTicks,$.numericTicks=r.numericTicks,$.dateTicker=r.dateTicker,$.Granularity=r.Granularity,$.getDateAxis=r.getDateAxis,$.floatFormat=t.floatFormat,c.default=$,b.exports=c.default}).call(this,a("_process"))},{"./datahandler/bars":5,"./datahandler/bars-custom":2,"./datahandler/bars-error":3,"./datahandler/bars-fractions":4,"./datahandler/default":8,"./datahandler/default-fractions":7,"./dygraph-canvas":9,"./dygraph-default-attrs":10,"./dygraph-gviz":11,"./dygraph-interaction-model":12,"./dygraph-layout":13,"./dygraph-options":15,"./dygraph-options-reference":14,"./dygraph-tickers":16,"./dygraph-utils":17,"./iframe-tarp":19,"./plugins/annotations":20,"./plugins/axes":21,"./plugins/chart-labels":22,"./plugins/grid":23,"./plugins/legend":24,"./plugins/range-selector":25,_process:1}],19:[function(a,b,c){"use strict";function d(){this.tarps=[]}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./dygraph-utils"),f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(e);d.prototype.cover=function(){for(var a=document.getElementsByTagName("iframe"),b=0;b<a.length;b++){var c=a[b],d=f.findPos(c),e=d.x,g=d.y,h=c.offsetWidth,i=c.offsetHeight,j=document.createElement("div");j.style.position="absolute",j.style.left=e+"px",j.style.top=g+"px",j.style.width=h+"px",j.style.height=i+"px",j.style.zIndex=999,document.body.appendChild(j),this.tarps.push(j)}},d.prototype.uncover=function(){for(var a=0;a<this.tarps.length;a++)this.tarps[a].parentNode.removeChild(this.tarps[a]);this.tarps=[]},c.default=d,b.exports=c.default},{"./dygraph-utils":17}],20:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(){this.annotations_=[]};d.prototype.toString=function(){return"Annotations Plugin"},d.prototype.activate=function(a){return{clearChart:this.clearChart,didDrawChart:this.didDrawChart}},d.prototype.detachLabels=function(){for(var a=0;a<this.annotations_.length;a++){var b=this.annotations_[a];b.parentNode&&b.parentNode.removeChild(b),this.annotations_[a]=null}this.annotations_=[]},d.prototype.clearChart=function(a){this.detachLabels()},d.prototype.didDrawChart=function(a){var b=a.dygraph,c=b.layout_.annotated_points;if(c&&0!==c.length)for(var d=a.canvas.parentNode,e=function(a,c,d){return function(e){var f=d.annotation;f.hasOwnProperty(a)?f[a](f,d,b,e):b.getOption(c)&&b.getOption(c)(f,d,b,e)}},f=a.dygraph.getArea(),g={},h=0;h<c.length;h++){var i=c[h];if(!(i.canvasx<f.x||i.canvasx>f.x+f.w||i.canvasy<f.y||i.canvasy>f.y+f.h)){var j=i.annotation,k=6;j.hasOwnProperty("tickHeight")&&(k=j.tickHeight);var l=document.createElement("div");l.style.fontSize=b.getOption("axisLabelFontSize")+"px";var m="dygraph-annotation";j.hasOwnProperty("icon")||(m+=" dygraphDefaultAnnotation dygraph-default-annotation"),j.hasOwnProperty("cssClass")&&(m+=" "+j.cssClass),l.className=m;var n=j.hasOwnProperty("width")?j.width:16,o=j.hasOwnProperty("height")?j.height:16;if(j.hasOwnProperty("icon")){var p=document.createElement("img");p.src=j.icon,p.width=n,p.height=o,l.appendChild(p)}else i.annotation.hasOwnProperty("shortText")&&l.appendChild(document.createTextNode(i.annotation.shortText));var q=i.canvasx-n/2;l.style.left=q+"px";var r=0;if(j.attachAtBottom){var s=f.y+f.h-o-k;g[q]?s-=g[q]:g[q]=0,g[q]+=k+o,r=s}else r=i.canvasy-o-k;l.style.top=r+"px",l.style.width=n+"px",l.style.height=o+"px",l.title=i.annotation.text,l.style.color=b.colorsMap_[i.name],l.style.borderColor=b.colorsMap_[i.name],j.div=l,b.addAndTrackEvent(l,"click",e("clickHandler","annotationClickHandler",i)),b.addAndTrackEvent(l,"mouseover",e("mouseOverHandler","annotationMouseOverHandler",i)),b.addAndTrackEvent(l,"mouseout",e("mouseOutHandler","annotationMouseOutHandler",i)),b.addAndTrackEvent(l,"dblclick",e("dblClickHandler","annotationDblClickHandler",i)),d.appendChild(l),this.annotations_.push(l);var t=a.drawingContext;if(t.save(),t.strokeStyle=j.hasOwnProperty("tickColor")?j.tickColor:b.colorsMap_[i.name],t.lineWidth=j.hasOwnProperty("tickWidth")?j.tickWidth:b.getOption("strokeWidth"),t.beginPath(),j.attachAtBottom){var s=r+o;t.moveTo(i.canvasx,s),t.lineTo(i.canvasx,s+k)}else t.moveTo(i.canvasx,i.canvasy),t.lineTo(i.canvasx,i.canvasy-2-k);t.closePath(),t.stroke(),t.restore()}}},d.prototype.destroy=function(){this.detachLabels()},c.default=d,b.exports=c.default},{}],21:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("../dygraph-utils"),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=function(){this.xlabels_=[],this.ylabels_=[]};f.prototype.toString=function(){return"Axes Plugin"},f.prototype.activate=function(a){return{layout:this.layout,clearChart:this.clearChart,willDrawChart:this.willDrawChart}},f.prototype.layout=function(a){var b=a.dygraph;if(b.getOptionForAxis("drawAxis","y")){var c=b.getOptionForAxis("axisLabelWidth","y")+2*b.getOptionForAxis("axisTickSize","y");a.reserveSpaceLeft(c)}if(b.getOptionForAxis("drawAxis","x")){var d;d=b.getOption("xAxisHeight")?b.getOption("xAxisHeight"):b.getOptionForAxis("axisLabelFontSize","x")+2*b.getOptionForAxis("axisTickSize","x"),a.reserveSpaceBottom(d)}if(2==b.numAxes()){if(b.getOptionForAxis("drawAxis","y2")){var c=b.getOptionForAxis("axisLabelWidth","y2")+2*b.getOptionForAxis("axisTickSize","y2");a.reserveSpaceRight(c)}}else b.numAxes()>2&&b.error("Only two y-axes are supported at this time. (Trying to use "+b.numAxes()+")")},f.prototype.detachLabels=function(){function a(a){for(var b=0;b<a.length;b++){var c=a[b];c.parentNode&&c.parentNode.removeChild(c)}}a(this.xlabels_),a(this.ylabels_),this.xlabels_=[],this.ylabels_=[]},f.prototype.clearChart=function(a){this.detachLabels()},f.prototype.willDrawChart=function(a){function b(a){return Math.round(a)+.5}function c(a){return Math.round(a)-.5}var d=this,f=a.dygraph;if(f.getOptionForAxis("drawAxis","x")||f.getOptionForAxis("drawAxis","y")||f.getOptionForAxis("drawAxis","y2")){var g,h,i,j=a.drawingContext,k=a.canvas.parentNode,l=f.width_,m=f.height_,n=function(a){return{position:"absolute",fontSize:f.getOptionForAxis("axisLabelFontSize",a)+"px",width:f.getOptionForAxis("axisLabelWidth",a)+"px"}},o={x:n("x"),y:n("y"),y2:n("y2")},p=function(a,b,c){var d=document.createElement("div"),f=o["y2"==c?"y2":b];e.update(d.style,f);var g=document.createElement("div");return g.className="dygraph-axis-label dygraph-axis-label-"+b+(c?" dygraph-axis-label-"+c:""),g.innerHTML=a,d.appendChild(g),d};j.save();var q=f.layout_,r=a.dygraph.plotter_.area,s=function(a){return function(b){return f.getOptionForAxis(b,a)}};if(f.getOptionForAxis("drawAxis","y")){if(q.yticks&&q.yticks.length>0){var t=f.numAxes(),u=[s("y"),s("y2")];q.yticks.forEach(function(a){if(void 0!==a.label){h=r.x;var b="y1",c=u[0];1==a.axis&&(h=r.x+r.w,-1,b="y2",c=u[1]);var e=c("axisLabelFontSize");i=r.y+a.pos*r.h,g=p(a.label,"y",2==t?b:null);var f=i-e/2;f<0&&(f=0),f+e+3>m?g.style.bottom="0":g.style.top=f+"px",0===a.axis?(g.style.left=r.x-c("axisLabelWidth")-c("axisTickSize")+"px",g.style.textAlign="right"):1==a.axis&&(g.style.left=r.x+r.w+c("axisTickSize")+"px",g.style.textAlign="left"),g.style.width=c("axisLabelWidth")+"px",k.appendChild(g),d.ylabels_.push(g)}});var v=this.ylabels_[0],w=f.getOptionForAxis("axisLabelFontSize","y");parseInt(v.style.top,10)+w>m-w&&(v.style.top=parseInt(v.style.top,10)-w/2+"px")}var x;if(f.getOption("drawAxesAtZero")){var y=f.toPercentXCoord(0);(y>1||y<0||isNaN(y))&&(y=0),x=b(r.x+y*r.w)}else x=b(r.x);j.strokeStyle=f.getOptionForAxis("axisLineColor","y"),j.lineWidth=f.getOptionForAxis("axisLineWidth","y"),j.beginPath(),j.moveTo(x,c(r.y)),j.lineTo(x,c(r.y+r.h)),j.closePath(),j.stroke(),2==f.numAxes()&&(j.strokeStyle=f.getOptionForAxis("axisLineColor","y2"),j.lineWidth=f.getOptionForAxis("axisLineWidth","y2"),j.beginPath(),j.moveTo(c(r.x+r.w),c(r.y)),j.lineTo(c(r.x+r.w),c(r.y+r.h)),j.closePath(),j.stroke())}if(f.getOptionForAxis("drawAxis","x")){if(q.xticks){var z=s("x");q.xticks.forEach(function(a){if(void 0!==a.label){h=r.x+a.pos*r.w,i=r.y+r.h,g=p(a.label,"x"),g.style.textAlign="center",g.style.top=i+z("axisTickSize")+"px";var b=h-z("axisLabelWidth")/2;b+z("axisLabelWidth")>l&&(b=l-z("axisLabelWidth"),g.style.textAlign="right"),b<0&&(b=0,g.style.textAlign="left"),g.style.left=b+"px",g.style.width=z("axisLabelWidth")+"px",k.appendChild(g),d.xlabels_.push(g)}})}j.strokeStyle=f.getOptionForAxis("axisLineColor","x"),j.lineWidth=f.getOptionForAxis("axisLineWidth","x"),j.beginPath();var A;if(f.getOption("drawAxesAtZero")){var y=f.toPercentYCoord(0,0);(y>1||y<0)&&(y=1),A=c(r.y+y*r.h)}else A=c(r.y+r.h);j.moveTo(b(r.x),A),j.lineTo(b(r.x+r.w),A),j.closePath(),j.stroke()}j.restore()}},c.default=f,b.exports=c.default},{"../dygraph-utils":17}],22:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(){this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};d.prototype.toString=function(){return"ChartLabels Plugin"},d.prototype.activate=function(a){return{layout:this.layout,didDrawChart:this.didDrawChart}};var e=function(a){var b=document.createElement("div");return b.style.position="absolute",b.style.left=a.x+"px",b.style.top=a.y+"px",b.style.width=a.w+"px",b.style.height=a.h+"px",b};d.prototype.detachLabels_=function(){for(var a=[this.title_div_,this.xlabel_div_,this.ylabel_div_,this.y2label_div_],b=0;b<a.length;b++){var c=a[b];c&&(c.parentNode&&c.parentNode.removeChild(c))}this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};var f=function(a,b,c,d,e){var f=document.createElement("div");f.style.position="absolute",f.style.left=1==c?"0px":b.x+"px",f.style.top=b.y+"px",f.style.width=b.w+"px",f.style.height=b.h+"px",f.style.fontSize=a.getOption("yLabelWidth")-2+"px";var g=document.createElement("div");g.style.position="absolute",g.style.width=b.h+"px",g.style.height=b.w+"px",g.style.top=b.h/2-b.w/2+"px",g.style.left=b.w/2-b.h/2+"px",g.className="dygraph-label-rotate-"+(1==c?"right":"left");var h=document.createElement("div");return h.className=d,h.innerHTML=e,g.appendChild(h),f.appendChild(g),f};d.prototype.layout=function(a){this.detachLabels_();var b=a.dygraph,c=a.chart_div;if(b.getOption("title")){var d=a.reserveSpaceTop(b.getOption("titleHeight"));this.title_div_=e(d),this.title_div_.style.fontSize=b.getOption("titleHeight")-8+"px";var g=document.createElement("div");g.className="dygraph-label dygraph-title",g.innerHTML=b.getOption("title"),this.title_div_.appendChild(g),c.appendChild(this.title_div_)}if(b.getOption("xlabel")){var h=a.reserveSpaceBottom(b.getOption("xLabelHeight"));this.xlabel_div_=e(h),this.xlabel_div_.style.fontSize=b.getOption("xLabelHeight")-2+"px";var g=document.createElement("div");g.className="dygraph-label dygraph-xlabel",g.innerHTML=b.getOption("xlabel"),this.xlabel_div_.appendChild(g),c.appendChild(this.xlabel_div_)}if(b.getOption("ylabel")){var i=a.reserveSpaceLeft(0);this.ylabel_div_=f(b,i,1,"dygraph-label dygraph-ylabel",b.getOption("ylabel")),c.appendChild(this.ylabel_div_)}if(b.getOption("y2label")&&2==b.numAxes()){var j=a.reserveSpaceRight(0);this.y2label_div_=f(b,j,2,"dygraph-label dygraph-y2label",b.getOption("y2label")),c.appendChild(this.y2label_div_)}},
d.prototype.didDrawChart=function(a){var b=a.dygraph;this.title_div_&&(this.title_div_.children[0].innerHTML=b.getOption("title")),this.xlabel_div_&&(this.xlabel_div_.children[0].innerHTML=b.getOption("xlabel")),this.ylabel_div_&&(this.ylabel_div_.children[0].children[0].innerHTML=b.getOption("ylabel")),this.y2label_div_&&(this.y2label_div_.children[0].children[0].innerHTML=b.getOption("y2label"))},d.prototype.clearChart=function(){},d.prototype.destroy=function(){this.detachLabels_()},c.default=d,b.exports=c.default},{}],23:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(){};d.prototype.toString=function(){return"Gridline Plugin"},d.prototype.activate=function(a){return{willDrawChart:this.willDrawChart}},d.prototype.willDrawChart=function(a){function b(a){return Math.round(a)+.5}function c(a){return Math.round(a)-.5}var d,e,f,g,h=a.dygraph,i=a.drawingContext,j=h.layout_,k=a.dygraph.plotter_.area;if(h.getOptionForAxis("drawGrid","y")){for(var l=["y","y2"],m=[],n=[],o=[],p=[],q=[],f=0;f<l.length;f++)o[f]=h.getOptionForAxis("drawGrid",l[f]),o[f]&&(m[f]=h.getOptionForAxis("gridLineColor",l[f]),n[f]=h.getOptionForAxis("gridLineWidth",l[f]),q[f]=h.getOptionForAxis("gridLinePattern",l[f]),p[f]=q[f]&&q[f].length>=2);g=j.yticks,i.save(),g.forEach(function(a){if(a.has_tick){var f=a.axis;o[f]&&(i.save(),p[f]&&i.setLineDash&&i.setLineDash(q[f]),i.strokeStyle=m[f],i.lineWidth=n[f],d=b(k.x),e=c(k.y+a.pos*k.h),i.beginPath(),i.moveTo(d,e),i.lineTo(d+k.w,e),i.stroke(),i.restore())}}),i.restore()}if(h.getOptionForAxis("drawGrid","x")){g=j.xticks,i.save();var q=h.getOptionForAxis("gridLinePattern","x"),p=q&&q.length>=2;p&&i.setLineDash&&i.setLineDash(q),i.strokeStyle=h.getOptionForAxis("gridLineColor","x"),i.lineWidth=h.getOptionForAxis("gridLineWidth","x"),g.forEach(function(a){a.has_tick&&(d=b(k.x+a.pos*k.w),e=c(k.y+k.h),i.beginPath(),i.moveTo(d,e),i.lineTo(d,k.y),i.closePath(),i.stroke())}),p&&i.setLineDash&&i.setLineDash([]),i.restore()}},d.prototype.destroy=function(){},c.default=d,b.exports=c.default},{}],24:[function(a,b,c){"use strict";function d(a,b,c){if(!a||a.length<=1)return'<div class="dygraph-legend-line" style="border-bottom-color: '+b+';"></div>';var d,e,f,g,h,i=0,j=0,k=[];for(d=0;d<=a.length;d++)i+=a[d%a.length];if((h=Math.floor(c/(i-a[0])))>1){for(d=0;d<a.length;d++)k[d]=a[d]/c;j=k.length}else{for(h=1,d=0;d<a.length;d++)k[d]=a[d]/i;j=k.length+1}var l="";for(e=0;e<h;e++)for(d=0;d<j;d+=2)f=k[d%k.length],g=d<a.length?k[(d+1)%k.length]:0,l+='<div class="dygraph-legend-dash" style="margin-right: '+g+"em; padding-left: "+f+'em;"></div>';return l}Object.defineProperty(c,"__esModule",{value:!0});var e=a("../dygraph-utils"),f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(e),g=function(){this.legend_div_=null,this.is_generated_div_=!1};g.prototype.toString=function(){return"Legend Plugin"},g.prototype.activate=function(a){var b,c=a.getOption("labelsDiv");return c&&null!==c?b="string"==typeof c||c instanceof String?document.getElementById(c):c:(b=document.createElement("div"),b.className="dygraph-legend",a.graphDiv.appendChild(b),this.is_generated_div_=!0),this.legend_div_=b,this.one_em_width_=10,{select:this.select,deselect:this.deselect,predraw:this.predraw,didDrawChart:this.didDrawChart}};var h=function(a){var b=document.createElement("span");b.setAttribute("style","margin: 0; padding: 0 0 0 1em; border: 0;"),a.appendChild(b);var c=b.offsetWidth;return a.removeChild(b),c},i=function(a){return a?a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""};g.prototype.select=function(a){var b=a.selectedX,c=a.selectedPoints,d=a.selectedRow,e=a.dygraph.getOption("legend");if("never"===e)return void(this.legend_div_.style.display="none");if("follow"===e){var f=a.dygraph.plotter_.area,h=this.legend_div_.offsetWidth,i=a.dygraph.getOptionForAxis("axisLabelWidth","y"),j=c[0].x*f.w+50,k=c[0].y*f.h-50;j+h+1>f.w&&(j=j-100-h-(i-f.x)),a.dygraph.graphDiv.appendChild(this.legend_div_),this.legend_div_.style.left=i+j+"px",this.legend_div_.style.top=k+"px"}var l=g.generateLegendHTML(a.dygraph,b,c,this.one_em_width_,d);this.legend_div_.innerHTML=l,this.legend_div_.style.display=""},g.prototype.deselect=function(a){"always"!==a.dygraph.getOption("legend")&&(this.legend_div_.style.display="none");var b=h(this.legend_div_);this.one_em_width_=b;var c=g.generateLegendHTML(a.dygraph,void 0,void 0,b,null);this.legend_div_.innerHTML=c},g.prototype.didDrawChart=function(a){this.deselect(a)},g.prototype.predraw=function(a){if(this.is_generated_div_){a.dygraph.graphDiv.appendChild(this.legend_div_);var b=a.dygraph.getArea(),c=this.legend_div_.offsetWidth;this.legend_div_.style.left=b.x+b.w-c-1+"px",this.legend_div_.style.top=b.y+"px"}},g.prototype.destroy=function(){this.legend_div_=null},g.generateLegendHTML=function(a,b,c,e,h){var j={dygraph:a,x:b,series:[]},k={},l=a.getLabels();if(l)for(var m=1;m<l.length;m++){var n=a.getPropertiesForSeries(l[m]),o=a.getOption("strokePattern",l[m]),p={dashHTML:d(o,n.color,e),label:l[m],labelHTML:i(l[m]),isVisible:n.visible,color:n.color};j.series.push(p),k[l[m]]=p}if(void 0!==b){var q=a.optionsViewForAxis_("x"),r=q("valueFormatter");j.xHTML=r.call(a,b,q,l[0],a,h,0);for(var s=[],t=a.numAxes(),m=0;m<t;m++)s[m]=a.optionsViewForAxis_("y"+(m?1+m:""));var u=a.getOption("labelsShowZeroValues"),v=a.getHighlightSeries();for(m=0;m<c.length;m++){var w=c[m],p=k[w.name];if(p.y=w.yval,0===w.yval&&!u||isNaN(w.canvasy))p.isVisible=!1;else{var n=a.getPropertiesForSeries(w.name),x=s[n.axis-1],y=x("valueFormatter"),z=y.call(a,w.yval,x,w.name,a,h,l.indexOf(w.name));f.update(p,{yHTML:z}),w.name==v&&(p.isHighlighted=!0)}}}return(a.getOption("legendFormatter")||g.defaultFormatter).call(a,j)},g.defaultFormatter=function(a){var b=a.dygraph;if(!0!==b.getOption("showLabelsOnHighlight"))return"";var c,d=b.getOption("labelsSeparateLines");if(void 0===a.x){if("always"!=b.getOption("legend"))return"";c="";for(var e=0;e<a.series.length;e++){var f=a.series[e];f.isVisible&&(""!==c&&(c+=d?"<br/>":" "),c+="<span style='font-weight: bold; color: "+f.color+";'>"+f.dashHTML+" "+f.labelHTML+"</span>")}return c}c=a.xHTML;for(var e=0;e<a.series.length;e++){var f=a.series[e];if(f.isVisible){d&&(c+="<br>");c+="<span"+(f.isHighlighted?' class="highlight"':"")+"> <b><span style='color: "+f.color+";'>"+f.labelHTML+"</span></b>:&#160;"+(void 0!==f.yHTML&&null!=f.yHTML?f.yHTML:"")+"</span>"}}return c},c.default=g,b.exports=c.default},{"../dygraph-utils":17}],25:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("../dygraph-utils"),f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(e),g=a("../dygraph-interaction-model"),h=d(g),i=a("../iframe-tarp"),j=d(i),k=function(){this.hasTouchInterface_="undefined"!=typeof TouchEvent,this.isMobileDevice_=/mobile|android/gi.test(navigator.appVersion),this.interfaceCreated_=!1};k.prototype.toString=function(){return"RangeSelector Plugin"},k.prototype.activate=function(a){return this.dygraph_=a,this.getOption_("showRangeSelector")&&this.createInterface_(),{layout:this.reserveSpace_,predraw:this.renderStaticLayer_,didDrawChart:this.renderInteractiveLayer_}},k.prototype.destroy=function(){this.bgcanvas_=null,this.fgcanvas_=null,this.leftZoomHandle_=null,this.rightZoomHandle_=null},k.prototype.getOption_=function(a,b){return this.dygraph_.getOption(a,b)},k.prototype.setDefaultOption_=function(a,b){this.dygraph_.attrs_[a]=b},k.prototype.createInterface_=function(){this.createCanvases_(),this.createZoomHandles_(),this.initInteraction_(),this.getOption_("animatedZooms")&&(console.warn("Animated zooms and range selector are not compatible; disabling animatedZooms."),this.dygraph_.updateOptions({animatedZooms:!1},!0)),this.interfaceCreated_=!0,this.addToGraph_()},k.prototype.addToGraph_=function(){var a=this.graphDiv_=this.dygraph_.graphDiv;a.appendChild(this.bgcanvas_),a.appendChild(this.fgcanvas_),a.appendChild(this.leftZoomHandle_),a.appendChild(this.rightZoomHandle_)},k.prototype.removeFromGraph_=function(){var a=this.graphDiv_;a.removeChild(this.bgcanvas_),a.removeChild(this.fgcanvas_),a.removeChild(this.leftZoomHandle_),a.removeChild(this.rightZoomHandle_),this.graphDiv_=null},k.prototype.reserveSpace_=function(a){this.getOption_("showRangeSelector")&&a.reserveSpaceBottom(this.getOption_("rangeSelectorHeight")+4)},k.prototype.renderStaticLayer_=function(){this.updateVisibility_()&&(this.resize_(),this.drawStaticLayer_())},k.prototype.renderInteractiveLayer_=function(){this.updateVisibility_()&&!this.isChangingRange_&&(this.placeZoomHandles_(),this.drawInteractiveLayer_())},k.prototype.updateVisibility_=function(){var a=this.getOption_("showRangeSelector");if(a)this.interfaceCreated_?this.graphDiv_&&this.graphDiv_.parentNode||this.addToGraph_():this.createInterface_();else if(this.graphDiv_){this.removeFromGraph_();var b=this.dygraph_;setTimeout(function(){b.width_=0,b.resize()},1)}return a},k.prototype.resize_=function(){function a(a,b,c,d){var e=d||f.getContextPixelRatio(b);a.style.top=c.y+"px",a.style.left=c.x+"px",a.width=c.w*e,a.height=c.h*e,a.style.width=c.w+"px",a.style.height=c.h+"px",1!=e&&b.scale(e,e)}var b=this.dygraph_.layout_.getPlotArea(),c=0;this.dygraph_.getOptionForAxis("drawAxis","x")&&(c=this.getOption_("xAxisHeight")||this.getOption_("axisLabelFontSize")+2*this.getOption_("axisTickSize")),this.canvasRect_={x:b.x,y:b.y+b.h+c+4,w:b.w,h:this.getOption_("rangeSelectorHeight")};var d=this.dygraph_.getNumericOption("pixelRatio");a(this.bgcanvas_,this.bgcanvas_ctx_,this.canvasRect_,d),a(this.fgcanvas_,this.fgcanvas_ctx_,this.canvasRect_,d)},k.prototype.createCanvases_=function(){this.bgcanvas_=f.createCanvas(),this.bgcanvas_.className="dygraph-rangesel-bgcanvas",this.bgcanvas_.style.position="absolute",this.bgcanvas_.style.zIndex=9,this.bgcanvas_ctx_=f.getContext(this.bgcanvas_),this.fgcanvas_=f.createCanvas(),this.fgcanvas_.className="dygraph-rangesel-fgcanvas",this.fgcanvas_.style.position="absolute",this.fgcanvas_.style.zIndex=9,this.fgcanvas_.style.cursor="default",this.fgcanvas_ctx_=f.getContext(this.fgcanvas_)},k.prototype.createZoomHandles_=function(){var a=new Image;a.className="dygraph-rangesel-zoomhandle",a.style.position="absolute",a.style.zIndex=10,a.style.visibility="hidden",a.style.cursor="col-resize",a.width=9,a.height=16,a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAQCAYAAADESFVDAAAAAXNSR0IArs4c6QAAAAZiS0dEANAAzwDP4Z7KegAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sHGw0cMqdt1UwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAaElEQVQoz+3SsRFAQBCF4Z9WJM8KCDVwownl6YXsTmCUsyKGkZzcl7zkz3YLkypgAnreFmDEpHkIwVOMfpdi9CEEN2nGpFdwD03yEqDtOgCaun7sqSTDH32I1pQA2Pb9sZecAxc5r3IAb21d6878xsAAAAAASUVORK5CYII=",this.isMobileDevice_&&(a.width*=2,a.height*=2),this.leftZoomHandle_=a,this.rightZoomHandle_=a.cloneNode(!1)},k.prototype.initInteraction_=function(){var a,b,c,d,e,g,i,k,l,m,n,o,p,q,r=this,s=document,t=0,u=null,v=!1,w=!1,x=!this.isMobileDevice_,y=new j.default;a=function(a){var b=r.dygraph_.xAxisExtremes(),c=(b[1]-b[0])/r.canvasRect_.w;return[b[0]+(a.leftHandlePos-r.canvasRect_.x)*c,b[0]+(a.rightHandlePos-r.canvasRect_.x)*c]},b=function(a){return f.cancelEvent(a),v=!0,t=a.clientX,u=a.target?a.target:a.srcElement,"mousedown"!==a.type&&"dragstart"!==a.type||(f.addEvent(s,"mousemove",c),f.addEvent(s,"mouseup",d)),r.fgcanvas_.style.cursor="col-resize",y.cover(),!0},c=function(a){if(!v)return!1;f.cancelEvent(a);var b=a.clientX-t;if(Math.abs(b)<4)return!0;t=a.clientX;var c,d=r.getZoomHandleStatus_();u==r.leftZoomHandle_?(c=d.leftHandlePos+b,c=Math.min(c,d.rightHandlePos-u.width-3),c=Math.max(c,r.canvasRect_.x)):(c=d.rightHandlePos+b,c=Math.min(c,r.canvasRect_.x+r.canvasRect_.w),c=Math.max(c,d.leftHandlePos+u.width+3));var g=u.width/2;return u.style.left=c-g+"px",r.drawInteractiveLayer_(),x&&e(),!0},d=function(a){return!!v&&(v=!1,y.uncover(),f.removeEvent(s,"mousemove",c),f.removeEvent(s,"mouseup",d),r.fgcanvas_.style.cursor="default",x||e(),!0)},e=function(){try{var b=r.getZoomHandleStatus_();if(r.isChangingRange_=!0,b.isZoomed){var c=a(b);r.dygraph_.doZoomXDates_(c[0],c[1])}else r.dygraph_.resetZoom()}finally{r.isChangingRange_=!1}},g=function(a){var b=r.leftZoomHandle_.getBoundingClientRect(),c=b.left+b.width/2;b=r.rightZoomHandle_.getBoundingClientRect();var d=b.left+b.width/2;return a.clientX>c&&a.clientX<d},i=function(a){return!(w||!g(a)||!r.getZoomHandleStatus_().isZoomed)&&(f.cancelEvent(a),w=!0,t=a.clientX,"mousedown"===a.type&&(f.addEvent(s,"mousemove",k),f.addEvent(s,"mouseup",l)),!0)},k=function(a){if(!w)return!1;f.cancelEvent(a);var b=a.clientX-t;if(Math.abs(b)<4)return!0;t=a.clientX;var c=r.getZoomHandleStatus_(),d=c.leftHandlePos,e=c.rightHandlePos,g=e-d;d+b<=r.canvasRect_.x?(d=r.canvasRect_.x,e=d+g):e+b>=r.canvasRect_.x+r.canvasRect_.w?(e=r.canvasRect_.x+r.canvasRect_.w,d=e-g):(d+=b,e+=b);var h=r.leftZoomHandle_.width/2;return r.leftZoomHandle_.style.left=d-h+"px",r.rightZoomHandle_.style.left=e-h+"px",r.drawInteractiveLayer_(),x&&m(),!0},l=function(a){return!!w&&(w=!1,f.removeEvent(s,"mousemove",k),f.removeEvent(s,"mouseup",l),x||m(),!0)},m=function(){try{r.isChangingRange_=!0,r.dygraph_.dateWindow_=a(r.getZoomHandleStatus_()),r.dygraph_.drawGraph_(!1)}finally{r.isChangingRange_=!1}},n=function(a){if(!v&&!w){var b=g(a)?"move":"default";b!=r.fgcanvas_.style.cursor&&(r.fgcanvas_.style.cursor=b)}},o=function(a){"touchstart"==a.type&&1==a.targetTouches.length?b(a.targetTouches[0])&&f.cancelEvent(a):"touchmove"==a.type&&1==a.targetTouches.length?c(a.targetTouches[0])&&f.cancelEvent(a):d(a)},p=function(a){"touchstart"==a.type&&1==a.targetTouches.length?i(a.targetTouches[0])&&f.cancelEvent(a):"touchmove"==a.type&&1==a.targetTouches.length?k(a.targetTouches[0])&&f.cancelEvent(a):l(a)},q=function(a,b){for(var c=["touchstart","touchend","touchmove","touchcancel"],d=0;d<c.length;d++)r.dygraph_.addAndTrackEvent(a,c[d],b)},this.setDefaultOption_("interactionModel",h.default.dragIsPanInteractionModel),this.setDefaultOption_("panEdgeFraction",1e-4);this.dygraph_.addAndTrackEvent(this.leftZoomHandle_,"mousedown",b),this.dygraph_.addAndTrackEvent(this.rightZoomHandle_,"mousedown",b),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousedown",i),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousemove",n),this.hasTouchInterface_&&(q(this.leftZoomHandle_,o),q(this.rightZoomHandle_,o),q(this.fgcanvas_,p))},k.prototype.drawStaticLayer_=function(){var a=this.bgcanvas_ctx_;a.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);try{this.drawMiniPlot_()}catch(a){console.warn(a)}this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorBackgroundLineWidth"),a.strokeStyle=this.getOption_("rangeSelectorBackgroundStrokeColor"),a.beginPath(),a.moveTo(.5,.5),a.lineTo(.5,this.canvasRect_.h-.5),a.lineTo(this.canvasRect_.w-.5,this.canvasRect_.h-.5),a.lineTo(this.canvasRect_.w-.5,.5),a.stroke()},k.prototype.drawMiniPlot_=function(){var a=this.getOption_("rangeSelectorPlotFillColor"),b=this.getOption_("rangeSelectorPlotFillGradientColor"),c=this.getOption_("rangeSelectorPlotStrokeColor");if(a||c){var d=this.getOption_("stepPlot"),e=this.computeCombinedSeriesAndLimits_(),f=e.yMax-e.yMin,g=this.bgcanvas_ctx_,h=this.dygraph_.xAxisExtremes(),i=Math.max(h[1]-h[0],1e-30),j=(this.canvasRect_.w-.5)/i,k=(this.canvasRect_.h-.5)/f,l=this.canvasRect_.w-.5,m=this.canvasRect_.h-.5,n=null,o=null;g.beginPath(),g.moveTo(.5,m);for(var p=0;p<e.data.length;p++){var q=e.data[p],r=null!==q[0]?(q[0]-h[0])*j:NaN,s=null!==q[1]?m-(q[1]-e.yMin)*k:NaN;(d||null===n||Math.round(r)!=Math.round(n))&&(isFinite(r)&&isFinite(s)?(null===n?g.lineTo(r,m):d&&g.lineTo(r,o),g.lineTo(r,s),n=r,o=s):(null!==n&&(d?(g.lineTo(r,o),g.lineTo(r,m)):g.lineTo(n,m)),n=o=null))}if(g.lineTo(l,m),g.closePath(),a){var t=this.bgcanvas_ctx_.createLinearGradient(0,0,0,m);b&&t.addColorStop(0,b),t.addColorStop(1,a),this.bgcanvas_ctx_.fillStyle=t,g.fill()}c&&(this.bgcanvas_ctx_.strokeStyle=c,this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorPlotLineWidth"),g.stroke())}},k.prototype.computeCombinedSeriesAndLimits_=function(){var a,b=this.dygraph_,c=this.getOption_("logscale"),d=b.numColumns(),e=b.getLabels(),g=new Array(d),h=!1,i=b.visibility(),j=[];for(a=1;a<d;a++){var k=this.getOption_("showInRangeSelector",e[a]);j.push(k),null!==k&&(h=!0)}if(h)for(a=1;a<d;a++)g[a]=j[a-1];else for(a=1;a<d;a++)g[a]=i[a-1];var l=[],m=b.dataHandler_,n=b.attributes_;for(a=1;a<b.numColumns();a++)if(g[a]){var o=m.extractSeries(b.rawData_,a,n);b.rollPeriod()>1&&(o=m.rollingAverage(o,b.rollPeriod(),n)),l.push(o)}var p=[];for(a=0;a<l[0].length;a++){for(var q=0,r=0,s=0;s<l.length;s++){var t=l[s][a][1];null===t||isNaN(t)||(r++,q+=t)}p.push([l[0][a][0],q/r])}var u=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(a=0;a<p.length;a++){var w=p[a][1];null!==w&&isFinite(w)&&(!c||w>0)&&(u=Math.min(u,w),v=Math.max(v,w))}if(c)for(v=f.log10(v),v+=.25*v,u=f.log10(u),a=0;a<p.length;a++)p[a][1]=f.log10(p[a][1]);else{var x,y=v-u;x=y<=Number.MIN_VALUE?.25*v:.25*y,v+=x,u-=x}return{data:p,yMin:u,yMax:v}},k.prototype.placeZoomHandles_=function(){var a=this.dygraph_.xAxisExtremes(),b=this.dygraph_.xAxisRange(),c=a[1]-a[0],d=Math.max(0,(b[0]-a[0])/c),e=Math.max(0,(a[1]-b[1])/c),f=this.canvasRect_.x+this.canvasRect_.w*d,g=this.canvasRect_.x+this.canvasRect_.w*(1-e),h=Math.max(this.canvasRect_.y,this.canvasRect_.y+(this.canvasRect_.h-this.leftZoomHandle_.height)/2),i=this.leftZoomHandle_.width/2;this.leftZoomHandle_.style.left=f-i+"px",this.leftZoomHandle_.style.top=h+"px",this.rightZoomHandle_.style.left=g-i+"px",this.rightZoomHandle_.style.top=this.leftZoomHandle_.style.top,this.leftZoomHandle_.style.visibility="visible",this.rightZoomHandle_.style.visibility="visible"},k.prototype.drawInteractiveLayer_=function(){var a=this.fgcanvas_ctx_;a.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);var b=this.canvasRect_.w-1,c=this.canvasRect_.h-1,d=this.getZoomHandleStatus_();if(a.strokeStyle=this.getOption_("rangeSelectorForegroundStrokeColor"),a.lineWidth=this.getOption_("rangeSelectorForegroundLineWidth"),d.isZoomed){var e=Math.max(1,d.leftHandlePos-this.canvasRect_.x),f=Math.min(b,d.rightHandlePos-this.canvasRect_.x);a.fillStyle="rgba(240, 240, 240, "+this.getOption_("rangeSelectorAlpha").toString()+")",a.fillRect(0,0,e,this.canvasRect_.h),a.fillRect(f,0,this.canvasRect_.w-f,this.canvasRect_.h),a.beginPath(),a.moveTo(1,1),a.lineTo(e,1),a.lineTo(e,c),a.lineTo(f,c),a.lineTo(f,1),a.lineTo(b,1),a.stroke()}else a.beginPath(),a.moveTo(1,1),a.lineTo(1,c),a.lineTo(b,c),a.lineTo(b,1),a.stroke()},k.prototype.getZoomHandleStatus_=function(){var a=this.leftZoomHandle_.width/2,b=parseFloat(this.leftZoomHandle_.style.left)+a,c=parseFloat(this.rightZoomHandle_.style.left)+a;return{leftHandlePos:b,rightHandlePos:c,isZoomed:b-1>this.canvasRect_.x||c+1<this.canvasRect_.x+this.canvasRect_.w}},c.default=k,b.exports=c.default},{"../dygraph-interaction-model":12,"../dygraph-utils":17,"../iframe-tarp":19}]},{},[18])(18)}),angular.module("angular-dygraphs",["ngSanitize"]).directive("ngDygraphs",["$window","$sce",function(a,b){return{restrict:"E",scope:{data:"=",options:"="},template:'<div class="ng-dygraphs"><div class="graph"></div></div>',link:function(a,b,c){var d=(b.parent(),b.children()[0]),e=$(d).children()[0];a.options.showLabelsOnHighlight?(a.options.labelsDiv="legend_"+a.$id,div=document.createElement("div"),div.id="legend_"+a.$id,div.classList.add("dygraphs-legend"),d.appendChild(div),e.classList.add("with-legend")):$("#legend_"+a.$id).hide(),a.options.labelsSeparateLines=!0,a.customGoals=a.options.customGoals,a.customEvents=a.options.customEvents,delete a.options.customGoals,delete a.options.customEvents,delete a.options.legendPosition;var f=new Dygraph(e,a.data,a.options);a.$watch("data",function(){var b=a.options;void 0===b&&(b={}),b.file=a.data,b.underlayCallback=a.underlayCallback,b.zoomCallback=a.zoomCallback},!0),a.$watch("options",function(a){f.updateOptions(a)},!0),a.underlayCallback=function(b,c,d){var e=_.sortBy(angular.copy(a.customGoals),"goal").reverse();_.forEach(e,function(a){var e=moment().valueOf(),f=d.toDomCoords(e,a.goal),g=(f[0],f[1]);b.fillStyle=a.color;var h=g-c.y;if(a.size&&0!=a.size)b.fillRect(c.x,g,c.w,a.size);else{var i=c.h-h;b.fillRect(c.x,g,c.w,i)}});var f=_.sortBy(angular.copy(a.customEvents),"event").reverse();_.forEach(f,function(a){b.fillStyle=a.color;var e=moment(a.event).add(-.25,"days"),f=e.valueOf(),g=moment(a.event).add(.25,"days"),h=g.valueOf(),i=d.toDomXCoord(f),j=d.toDomXCoord(h),k=j-i;a.size&&0!=a.size?b.fillRect(i,c.y,a.size,c.h):b.fillRect(i,c.y,k,c.h)})}}}}]),angular.module("Dygraphs",["angular-dygraphs","ComponentsCommon","DataService"]),angular.module("Dygraphs").component("scriptrDygraphs",{bindings:{onLoad:"&onLoad",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",delta:"<?",icon:"@",dataFailureMessage:"@",stalledDataMessage:"@",invalidData:"@",resize:"<?",data:"<?",legend:"<?",drawX1Axis:"@",drawYAxis:"@",drawY2Axis:"@",colors:"<?",x1AxisLabelFontSize:"@",yAxisLabelFontSize:"@",y2AxisLabelFontSize:"@",yAxisLabelsKmb:"@",y2AxisLabelsKmb:"@",x1AxisLabelWidth:"@",yAxisLabelWidth:"@",y2AxisLabelWidth:"@",x1AxisLineColor:"@",yAxisLineColor:"@",y2AxisLineColor:"@",x1AxisLineWidth:"@",yAxisLineWidth:"@",y2AxisLineWidth:"@",x1AxisTickSize:"@",x1MinGranularity:"@",yAxisTickSize:"@",y2AxisTickSize:"@",yAxisIncludeZero:"@",y2AxisIncludeZero:"@",x1AxisLabel:"@",yAxisLabel:"@",y2AxisLabel:"@",showRangeSelector:"@",rangeSelectorAlpha:"@",rangeSelectorBackgroundLineWidth:"@",rangeSelectorBackgroundStrokeColor:"@",rangeSelectorForegroundLineWidth:"@",rangeSelectorForegroundStrokeColor:"@",rangeSelectorHeight:"@",rangeSelectorPlotFillColor:"@",rangeSelectorPlotFillGradientColor:"@",rangeSelectorPlotLineWidth:"@",rangeSelectorPlotStrokeColor:"@",legendPosition:"@",showLegend:"@",x1DrawGrid:"@",yDrawGrid:"@",y2DrawGrid:"@",x1GridLineColor:"@",yGridLineColor:"@",y2GridLineColor:"@",x1GridLineWidth:"@",yGridLineWidth:"@",y2GridLineWidth:"@",legendLabels:"<?",independentTicks:"@",legendMapping:"<?",customGoals:"<?",customEvents:"<?",colorsMapping:"<?",connectSeparatedPoints:"<?",drawPoints:"<?",pointSize:"<?",strokeWidth:"<?",interaction:"<?",xaxisLabelFormatter:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/dygraphs/dygraphs.html",controller:["$translate","$rootScope","httpClient","wsClient","$scope","$element","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.$onInit=function(){if(a.use(b.lang),this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/dygraphs-line-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=null!=this.datas&&this.datas.length>0,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],void 0===this.api&&void 0===this.msgTag&&(this.data&&0==this.data.length||null==this.data)&&(this.noResults=!0),this.options={},this.options.axes={},this.options.series={},this.drawX1Axis=!this.drawX1Axis||JSON.parse(this.drawX1Axis),this.drawYAxis=!this.drawYAxis||JSON.parse(this.drawYAxis),this.drawY2Axis=!this.drawY2Axis||JSON.parse(this.drawY2Axis),this.colors=this.colors?this.colors:["#CC5464","#FCC717","#38B9D6","#1DBC68","#E90088"],this.colorsMapping&&this.showLegend&&"true"==this.showLegend){this.colors=_.pluck(this.colorsMapping,"colors"),this.legendLabels=["x"],this.legendLabels=this.legendLabels.concat(_.pluck(this.colorsMapping,"labels"));var c=angular.copy(this.legendLabels),d=[];c.forEach(function(b){var c=a.instant(b);d.push(c)}),this.legendLabels=d,this.legendMapping=["X"],this.legendMapping=this.legendMapping.concat(_.pluck(this.colorsMapping,"axisSelection")),this.legendUnitsMapping=_.pluck(this.colorsMapping,"unit");for(var e=1;e<this.legendLabels.length;e++)this.legendUnitsMapping[e-1]&&""!=this.legendUnitsMapping[e-1]&&(this.legendLabels[e]=this.legendLabels[e]+" ("+this.legendUnitsMapping[e-1]+")");this.legendLabels=this.legendLabels?this.legendLabels:["X","Y1","Y2","Y3","Y4"],console.log("labels",this.legendLabels),this.legendMapping=this.legendMapping?this.legendMapping:["x","y","y","y2","y2"];for(var f=0;f<this.legendLabels.length;f++){var g=this.legendLabels[f];0!=f&&"y2"==this.legendMapping[f]&&this.drawY2Axis&&(g?this.options.series[g]={axis:this.legendMapping[f]}:this.options.series["Y"+f]={axis:this.legendMapping[f]})}}this.legendLabels&&""!=this.legendLabels&&(this.options.labels=this.legendLabels),this.options.customGoals=this.customGoals?_.reject(this.customGoals,function(a){return""===a.goal||null==a.goal}):[],this.options.customEvents=this.customEvents?_.reject(this.customEvents,function(a){return""===a.event||null==a.event}):[],this.x1AxisLabelFontSize=this.x1AxisLabelFontSize?JSON.parse(this.x1AxisLabelFontSize):14,this.yAxisLabelFontSize=this.yAxisLabelFontSize?JSON.parse(this.yAxisLabelFontSize):14,this.y2AxisLabelFontSize=this.y2AxisLabelFontSize?JSON.parse(this.y2AxisLabelFontSize):14,this.yAxisLabelsKmb=!!this.yAxisLabelsKmb&&JSON.parse(this.yAxisLabelsKmb),this.y2AxisLabelsKmb=!!this.y2AxisLabelsKmb&&JSON.parse(this.y2AxisLabelsKmb),this.x1AxisLabelWidth=this.x1AxisLabelWidth?JSON.parse(this.x1AxisLabelWidth):60,this.yAxisLabelWidth=this.yAxisLabelWidth?JSON.parse(this.yAxisLabelWidth):250,this.y2AxisLabelWidth=this.y2AxisLabelWidth?JSON.parse(this.y2AxisLabelWidth):50,this.x1AxisLineColor=this.x1AxisLineColor?this.x1AxisLineColor:"#a9a9a9",this.yAxisLineColor=this.yAxisLineColor?this.yAxisLineColor:"#a9a9a9",this.y2AxisLineColor=this.y2AxisLineColor?this.y2AxisLineColor:"#a9a9a9",this.showLegend=!this.showLegend||JSON.parse(this.showLegend),this.x1AxisLabel=this.x1AxisLabel?this.x1AxisLabel:"",this.yAxisLabel=this.yAxisLabel?this.yAxisLabel:"",this.y2AxisLabel=this.y2AxisLabel?this.y2AxisLabel:"",this.x1AxisLineWidth=this.x1AxisLineWidth?JSON.parse(this.x1AxisLineWidth):.3,this.yAxisLineWidth=this.yAxisLineWidth?JSON.parse(this.yAxisLineWidth):.3,this.y2AxisLineWidth=this.y2AxisLineWidth?JSON.parse(this.y2AxisLineWidth):.3,this.x1AxisTickSize=this.x1AxisTickSize?JSON.parse(this.x1AxisTickSize):3,this.yAxisTickSize=this.yAxisTickSize?JSON.parse(this.yAxisTickSize):3,this.y2AxisTickSize=this.y2AxisTickSize?JSON.parse(this.y2AxisTickSize):3,this.yAxisIncludeZero=!!this.yAxisIncludeZero&&JSON.parse(this.yAxisIncludeZero),this.y2AxisIncludeZero=!!this.y2AxisIncludeZero&&JSON.parse(this.y2AxisIncludeZero),this.showRangeSelector=!!this.showRangeSelector&&JSON.parse(this.showRangeSelector),this.rangeSelectorAlpha=this.rangeSelectorAlpha?JSON.parse(this.rangeSelectorAlpha):.6,this.rangeSelectorBackgroundLineWidth=this.rangeSelectorBackgroundLineWidth?JSON.parse(this.rangeSelectorBackgroundLineWidth):1,this.rangeSelectorBackgroundStrokeColor=this.rangeSelectorBackgroundStrokeColor?this.rangeSelectorBackgroundStrokeColor:"#808080",this.rangeSelectorForegroundLineWidth=this.rangeSelectorForegroundLineWidth?JSON.parse(this.rangeSelectorForegroundLineWidth):1,this.rangeSelectorForegroundStrokeColor=this.rangeSelectorForegroundStrokeColor?this.rangeSelectorForegroundStrokeColor:"#000000",this.rangeSelectorHeight=this.rangeSelectorHeight?JSON.parse(this.rangeSelectorHeight):40,this.rangeSelectorPlotFillColor=this.rangeSelectorPlotFillColor?this.rangeSelectorPlotFillColor:"#A7B1C4",this.rangeSelectorPlotFillGradientColor=this.rangeSelectorPlotFillGradientColor?this.rangeSelectorPlotFillGradientColor:"#FFFFFF",this.rangeSelectorPlotLineWidth=this.rangeSelectorPlotLineWidth?JSON.parse(this.rangeSelectorPlotLineWidth):1.5,this.rangeSelectorPlotStrokeColor=this.rangeSelectorPlotStrokeColor?this.rangeSelectorPlotStrokeColor:"#808FAB",this.x1DrawGrid=!this.x1DrawGrid||JSON.parse(this.x1DrawGrid),this.yDrawGrid=!this.yDrawGrid||JSON.parse(this.yDrawGrid),this.y2DrawGrid=!!this.y2DrawGrid&&JSON.parse(this.y2DrawGrid),this.x1GridLineColor=this.x1GridLineColor?this.x1GridLineColor:"#e5e5e5",this.yGridLineColor=this.yGridLineColor?this.yGridLineColor:"#e5e5e5",this.y2GridLineColor=this.y2GridLineColor?this.y2GridLineColor:"#e5e5e5",this.x1GridLineWidth=this.x1GridLineWidth?JSON.parse(this.x1GridLineWidth):.3,this.yGridLineWidth=this.yGridLineWidth?JSON.parse(this.yGridLineWidth):.3,this.y2GridLineWidth=this.y2GridLineWidth?JSON.parse(this.y2GridLineWidth):.3,this.xDrawGrid=!this.xDrawGrid||JSON.parse(this.xDrawGrid),this.independentTicks=this.independentTicks?this.independentTicks:"y-primary",this.x1AxisLabel&&""!=this.x1AxisLabel&&(this.options.xlabel=this.x1AxisLabel),this.yAxisLabel&&""!=this.yAxisLabel&&(this.options.ylabel=this.yAxisLabel),this.y2AxisLabel&&""!=this.y2AxisLabel&&(this.options.y2label=this.y2AxisLabel),this.options.yRangePad="10",this.options.axes.x={},this.options.axes.x.drawAxis=JSON.parse(this.drawX1Axis),this.options.axes.x.axisLabelFontSize=JSON.parse(this.x1AxisLabelFontSize),this.options.axes.x.axisLabelWidth=JSON.parse(this.x1AxisLabelWidth),this.options.axes.x.axisLineColor=this.x1AxisLineColor,this.options.axes.x.axisLineWidth=JSON.parse(this.x1AxisLineWidth),this.options.axes.x.axisTickSize=JSON.parse(this.x1AxisTickSize),this.options.axes.x.independentTicks=!0,this.options.axes.x.ticker=Dygraph.dateTicker,this.options.xValueParser=function(a){return moment(a).format("YYYY-MM-DD kk:mm")},this.options.axes.x.axisLabelFormatter=function(a,b,c){return k.x1MinGranularity&&b<k.x1MinGranularity?Dygraph.dateAxisLabelFormatter(new Date(a),this.x1MinGranularity,c):"function"==typeof k.xaxisLabelFormatter()?k.xaxisLabelFormatter()(a,b,c):Dygraph.dateAxisLabelFormatter(new Date(a),b,c)},this.options.axes.x.valueFormatter=function(a){return moment(a).format("YYYY-MM-DD kk:mm")},this.options.axes.y={},this.options.axes.y.drawAxis=JSON.parse(this.drawYAxis),this.options.axes.y.axisLabelFontSize=JSON.parse(this.yAxisLabelFontSize),$(window).innerWidth()<=480?this.options.axes.y.axisLabelWidth=40:this.options.axes.y.axisLabelWidth=JSON.parse(this.yAxisLabelWidth),this.options.axes.y.axisLineColor=this.yAxisLineColor,this.options.axes.y.axisLineWidth=JSON.parse(this.yAxisLineWidth),this.options.axes.y.axisTickSize=JSON.parse(this.yAxisTickSize),this.options.axes.y.includeZero=JSON.parse(this.yAxisIncludeZero),this.options.axes.y.labelsKMB=JSON.parse(this.yAxisLabelsKmb);this.options.digitsAfterDecimal=4;var h=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c};this.options.axes.y.ticker=Dygraph.numericLinearTicks,this.options.axes.y.axisLabelFormatter=function(a){return h(a,4)},this.options.axes.y2={},this.options.axes.y2.drawAxis=JSON.parse(this.drawY2Axis),this.options.axes.y2.axisLabelFontSize=JSON.parse(this.y2AxisLabelFontSize),$(window).innerWidth()<=480?this.options.axes.y2.axisLabelWidth=40:this.options.axes.y2.axisLabelWidth=JSON.parse(this.yAxisLabelWidth),this.options.axes.y2.axisLineColor=this.y2AxisLineColor,this.options.axes.y2.axisLineWidth=JSON.parse(this.y2AxisLineWidth),this.options.axes.y2.axisTickSize=JSON.parse(this.y2AxisTickSize),this.options.axes.y2.includeZero=JSON.parse(this.y2AxisIncludeZero),this.options.axes.y2.labelsKMB=JSON.parse(this.y2AxisLabelsKmb),this.options.axes.y2.ticker=Dygraph.numericLinearTicks,this.options.axes.y2.axisLabelFormatter=function(a){return h(a,4)},this.options.showRangeSelector=JSON.parse(this.showRangeSelector),this.options.rangeSelectorAlpha=JSON.parse(this.rangeSelectorAlpha),this.options.rangeSelectorBackgroundLineWidth=JSON.parse(this.rangeSelectorBackgroundLineWidth),this.options.rangeSelectorBackgroundStrokeColor=this.rangeSelectorBackgroundStrokeColor,this.options.rangeSelectorForegroundLineWidth=JSON.parse(this.rangeSelectorForegroundLineWidth),
this.options.rangeSelectorForegroundStrokeColor=this.rangeSelectorForegroundStrokeColor,this.options.rangeSelectorHeight=JSON.parse(this.rangeSelectorHeight),this.options.rangeSelectorPlotFillColor=this.rangeSelectorPlotFillColor,this.options.rangeSelectorPlotFillGradientColor=this.rangeSelectorPlotFillGradientColor,this.options.rangeSelectorPlotLineWidth=JSON.parse(this.rangeSelectorPlotLineWidth),this.options.rangeSelectorPlotStrokeColor=this.rangeSelectorPlotStrokeColor,this.options.colors=this.colors,this.showLegend?(this.options.showLabelsOnHighlight=!0,this.options.legend="always"):(this.options.showLabelsOnHighlight=!1,this.options.hideOverlayOnMouseOut=!0),this.options.legendPosition=this.legendPosition?this.legendPosition:"top",this.options.axes.x.drawGrid=JSON.parse(this.x1DrawGrid),this.options.axes.y.drawGrid=JSON.parse(this.yDrawGrid),this.options.axes.y2.drawGrid=JSON.parse(this.y2DrawGrid),this.options.axes.x.gridLineColor=this.x1GridLineColor,this.options.axes.y.gridLineColor=this.yGridLineColor,this.options.axes.y2.gridLineColor=this.y2GridLineColor,this.options.axes.x.gridLineWidth=JSON.parse(this.x1GridLineWidth),this.options.axes.y.gridLineWidth=JSON.parse(this.yGridLineWidth),this.options.axes.y2.gridLineWidth=JSON.parse(this.y2GridLineWidth),"y-primary"==this.independentTicks?(this.options.axes.y.independentTicks=!0,this.options.axes.y2.independentTicks=!1):"y2-primary"==this.independentTicks?(this.options.axes.y.independentTicks=!1,this.options.axes.y2.independentTicks=!0):"independent"==this.independentTicks&&(this.options.axes.y.independentTicks=!0,this.options.axes.y2.independentTicks=!0),this.options.connectSeparatedPoints=null==this.connectSeparatedPoints||this.connectSeparatedPoints,this.options.drawPoints=null==this.drawPoints||this.drawPoints,this.options.strokeWidth=null!=this.strokeWidth?this.strokeWidth:1,this.options.pointSize=null!=this.pointSize?this.pointSize:3,this.options.interactionModel=this.interaction?Dygraph.defaultInteractionModel:Dygraph.nonInteractiveModel,this.transport=this.transport?this.transport:null,this.httpMethod=this.httpMethod?this.httpMethod:"GET",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null},this.$postLink=function(){k.timeoutId=g(k.resize.bind(k),100),angular.element(i).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?e.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(e.$on("update-data",function(a,b){null==b?k.data&&0!=k.data.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),e.$emit("waiting-for-data"))},this.onResize=function(){null!=k.timeoutId&&g.cancel(k.timeoutId),k.timeoutId=g(k.resize.bind(k),100)},this.resize=function(){$(window).innerWidth()<=480?(k.options.axes.y2.axisLabelWidth=40,k.options.axes.y.axisLabelWidth=40):(k.options.axes.y2.axisLabelWidth=JSON.parse(k.y2AxisLabelWidth),k.options.axes.y.axisLabelWidth=JSON.parse(k.yAxisLabelWidth)),this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){f.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$onDestroy=function(){console.log("destory chart",k.msgTag,e.$id),k.msgTag&&d.unsubscribe(k.msgTag,null,e.$id),k.refreshTimer&&h.cancel(k.refreshTimer),null!=k.timeoutId&&g.cancel(k.timeoutId),angular.element(i).off("resize",k.onResize)};var l=function(a){var b={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:e.$id};j.scriptrRequest(b,k.consumeData.bind(k)),null!=k.fetchDataInterval&&null==k.refreshTimer&&(k.refreshTimer=h(function(){l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(b,c){b.status&&"failure"==b.status?(this.noResults=!0,k.dataFailureMessage=a.instant(this.dataFailureMessage),this.datas&&this.datas.length>0&&(this.stalledData=!0,k.stalledDataMessage=a.instant(this.stalledDataMessage))):("function"==typeof k.onFormatData()&&(b=k.onFormatData()(b,k)),null!=b&&"object"==typeof b&&Array.isArray(b)?b.length>0?(this.datas&&this.delta?this.datas=this.datas.concat(b):this.datas=b,k.hasData=!0,k.noResults=!1,k.stalledData=!1):(k.noResults=!0,null!=k.datas&&k.datas.length>0&&(k.stalledData=!0),k.stalledDataMessage=a.instant(this.stalledDataMessage)):(k.noResults=!0,null!=k.datas&&k.datas.length>0&&(k.stalledData=!0),k.invalidData=a.instant(this.invalidData)))}}]}),angular.module("ToggleSwitch",["DataService","toggle-switch","ui.bootstrap","ComponentsCommon","DataService"]),angular.module("ToggleSwitch").component("scriptrToggleSwitch",{bindings:{onLoad:"&onLoad",type:"@",size:"@",class:"@",data:"<?",switchStatus:"<?",onLabel:"@",offLabel:"@",knobLabel:"@",isDisabled:"<?",onSwitchChange:"&",icon:"@",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",actionTransport:"@",actionApi:"@",actionApiParams:"<?",actionUseWindowParams:"@",actionHttpMethod:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/toggleSwitch/toggle_switch.html",controller:["$scope","$element","$window","$timeout","httpClient","wsClient","dataService","$interval",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/toggle-switch-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=!1===this.switchStatus||!0===this.switchStatus,!1!==this.switchStatus&&!0!==this.switchStatus||this.data?!this.data||!1!==this.data.state&&!0!==this.data.state||(this.switchStatus=null):this.data={state:this.switchStatus},this.onLabel=void 0!==this.onLabel?this.onLabel:"on",this.offLabel=void 0!==this.offLabel?this.offLabel:"off",this.knobLabel=void 0!==this.knobLabel?this.knobLabel:"",this.disabled=void 0!==this.isDisabled&&this.isDisabled,this.type=void 0!==this.type?this.type:"switch-success",this.size=void 0!==this.size?this.size:"switch-large",this.actionParams="undefined"!=this.actionParams?this.actionParams:this.apiParams?this.apiParams:{},this.class=this.type+" "+this.size,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.style={}},this.$postLink=function(){i.timeoutId=d(i.resize.bind(i),100),angular.element(c).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?(i.timeout=!0,j(this.transport)):(i.timeout=!1,i.data&&d(function(){0==i.timeout&&i.consumeData(i.data)},2e3),a.$watch(function(a){if(a.$ctrl.data&&1==i.timeout)return a.$ctrl.data},function(a,b){JSON.stringify(a)!=JSON.stringify(b)&&i.consumeData(a)}),a.$on("update-data",function(a,b){null==b?null==i.data&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),a.$emit("waiting-for-data"))},this.$onDestroy=function(){i.msgTag&&f.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&h.cancel(i.refreshTimer),null!=i.timeoutId&&d.cancel(i.timeoutId),angular.element(c).off("resize",i.onResize)},this.onResize=function(){null!=i.timeoutId&&d.cancel(i.timeoutId),i.timeoutId=d(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){b.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1};var j=function(b){var c={api:i.api,transport:b,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:a.$id};g.scriptrRequest(c,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=h(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){if(a&&a.status&&"failure"==a.status)i.noResults=!0,i.dataFailureMessage="Failed to load toggle state.",!1!==i.switchStatus&&!0!==i.switchStatus||(i.stalledData=!0,i.dataFailureMessage="Failed to update toggle state.");else if("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a)if("object"==typeof a&&a.hasOwnProperty("state")){var c=a.state;i.switchStatus=function(a){switch(a){case!0:case"true":case 1:case"1":case"on":case"yes":return!0;default:return!1}}(c),i.hasData=!0,i.noResults=!1,i.stalledData=!1,i.timeout=!0;var d=a.disabled;null!=d&&(i.isDisabled=d)}else i.noResults=!0,!1!==i.switchStatus&&!0!==i.switchStatus||(i.stalledData=!0,i.dataFailureMessage="Toggle state update data is invalid."),i.dataFailureMessage="Toggle state data is invalid.";else i.noResults=!0,i.dataFailureMessage="Failed to load toggle state.",!1!==i.switchStatus&&!0!==i.switchStatus||(i.stalledData=!0,i.dataFailureMessage="Failed to update toggle state.")},this.publishData=function(){if(!i.isDisabled){"function"==typeof i.onSwitchChange()&&i.onSwitchChange()(i.switchStatus),void 0===i.actionApiParams&&(i.actionApiParams={}),i.actionApiParams.value=i.switchStatus;var a={api:i.actionApi?i.actionApi:i.api,transport:i.actionTransport?i.actionTransport:i.transport,apiParams:i.actionApiParams,useWindowParams:i.actionUseWindowParams?i.actionUseWindowParams:i.useWindowParams,httpMethod:i.actionHttpMethod?i.actionHttpMethod:i.httpMehtod};g.scriptrRequest(a,i.consumeActionData.bind(i))}},this.consumeActionData=function(a,b){a.status&&"failure"==a.status?(i.actionSuccess=!1,i.actionMessage=a.errorDetail||"Toggle action failed.",i.consumeData({state:!i.switchStatus})):(i.actionSuccess=!0,i.actionMessage=a.successMessage||"Toggle action succeeded."),d(function(){i.actionSuccess=null,i.actionMessage=null},5e3)}}]}),angular.module("Slider",["rzModule","ui.bootstrap","ComponentsCommon","DataService"]),angular.module("Slider").component("scriptrSlider",{bindings:{onLoad:"&onLoad",theme:"@",id:"@",icon:"@",loadingMessage:"@",min:"<?",max:"<?",floor:"<?",ceil:"<?",step:"<?",precision:"<?",minLimit:"<?",maxLimit:"<?",minRange:"<?",maxRange:"<?",pushRange:"<?",id:"<?",translate:"<?",getLegend:"<?",stepsArray:"<?",bindIndexForStepsArray:"<?",draggableRange:"<?",draggableRangeOnly:"<?",showSelectionBar:"<?",showSelectionBarEnd:"<?",showSelectionBarFromValue:"<?",hidePointerLabels:"<?",hideLimitLabels:"<?",autoHideLimitLabels:"<?",readOnly:"<?",isDisabled:"<?",interval:"<?",showTicks:"<?",showTicksValues:"<?",ticksArray:"<?",ticksTooltip:"<?",ticksValuesTooltip:"<?",vertical:"<?",getSelectionBarColor:"&",getTickColor:"<?",getPointerColor:"<?",keyboardSupport:"<?",scale:"<?",enforceStep:"<?",enforceRange:"<?",noSwitching:"<?",onlyBindHandles:"<?",onStart:"&",onChange:"&",onEnd:"&",rightToLeft:"<?",boundPointerLabels:"<?",mergeRangeLabelsIfSame:"<?",customTemplateScope:"<?",logScale:"<?",customValueToPosition:"<?",customPositionToValue:"<?",selectionBarGradient:"<?",ariaLabel:"<?",ariaLabelledBy:"<?",ariaLabelHigh:"<?",ariaLabelledByHigh:"<?",enableResize:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",actionTransport:"@",actionApi:"@",actionApiParams:"<?",actionUseWindowParams:"@",actionHttpMethod:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/slider/slider.html",controller:["$scope","$element","$window","$timeout","httpClient","wsClient","dataService","$interval",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/slider-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=!(isNaN(parseFloat(this.min))||!isFinite(this.min)),this.min&&!this.data?(this.data=this.min,this.rollBackData=this.min):this.data&&(this.min=null),this.max=this.max?this.max:null,this.theme=this.theme?this.theme:"",this.options={},this.options.id=void 0!==this.id?this.id:null,this.options.floor=void 0!==this.floor?this.floor:0,this.options.ceil=void 0!==this.ceil?this.ceil:10,this.options.step=void 0!==this.step?this.step:1,this.options.precision=void 0!==this.precision?this.precision:0,this.options.minLimit=void 0!==this.minLimit?this.minLimit:null,this.options.maxLimit=void 0!==this.maxLimit?this.maxLimit:null,this.options.minRange=void 0!==this.minRange?this.minRange:null,this.options.maxRange=void 0!==this.maxRange?this.maxRange:null,this.options.pushRange=void 0!==this.pushRange&&this.pushRange,this.options.translate=void 0!==this.translate?this.translate:null,this.options.getLegend=void 0!==this.getLegend?this.getLegend:null,this.options.stepsArray=void 0!==this.stepsArray?this.stepsArray:null,this.options.bindIndexForStepsArray=void 0!==this.bindIndexForStepsArray&&this.bindIndexForStepsArray,this.options.draggableRange=void 0!==this.draggableRange&&this.draggableRange,this.options.draggableRangeOnly=void 0!==this.draggableRangeOnly&&this.draggableRangeOnly,this.options.showSelectionBar=void 0!==this.showSelectionBar&&this.showSelectionBar,this.options.showSelectionBarEnd=void 0!==this.showSelectionBarEnd&&this.showSelectionBarEnd,this.options.showSelectionBarFromValue=void 0!==this.showSelectionBarFromValue?this.showSelectionBarFromValue:null,this.options.hidePointerLabels=void 0!==this.hidePointerLabels&&this.hidePointerLabels,this.options.hideLimitLabels=void 0!==this.hideLimitLabels&&this.hideLimitLabels,this.options.autoHideLimitLabels=void 0===this.autoHideLimitLabels||this.autoHideLimitLabels,this.options.readOnly=void 0!==this.readOnly&&this.readOnly,this.options.disabled=void 0!==this.isDisabled&&this.isDisabled,this.options.interval=void 0!==this.interval?this.interval:350,this.options.showTicks=void 0!==this.showTicks&&this.showTicks,this.options.showTicksValues=void 0!==this.showTicksValues&&this.showTicksValues,this.options.ticksArray=void 0!==this.ticksArray?this.ticksArray:null,this.options.ticksTooltip=void 0!==this.ticksTooltip?this.ticksTooltip:null,this.options.ticksValuesTooltip=void 0!==this.ticksValuesTooltip?this.ticksValuesTooltip:null,this.options.vertical=void 0!==this.vertical&&this.vertical,this.options.getSelectionBarColor="function"==typeof this.getSelectionBarColor()?this.getSelectionBarColor():null,this.options.getTickColor=void 0!==this.getTickColor?this.getTickColor:null,this.options.getPointerColor=void 0!==this.getPointerColor?this.getPointerColor:null,this.options.keyboardSupport=void 0===this.keyboardSupport||this.keyboardSupport,this.options.scale=void 0!==this.scale?this.scale:1,this.options.enforceStep=void 0!==this.enforceStep&&this.enforceStep,this.options.enforceRange=void 0!==this.enforceRange&&this.enforceRange,this.options.noSwitching=void 0!==this.noSwitching&&this.noSwitching,this.options.onlyBindHandles=void 0!==this.onlyBindHandles?this.onlyBindHandles:null,this.options.onStart="function"!=typeof this.onStart()?this.onStart:null,this.options.onChange="function"!=typeof this.onChange()?this.onChange:null,this.options.onEnd=this.publishData,this.options.rightToLeft=void 0!==this.rightToLeft&&this.rightToLeft,this.options.boundPointerLabels=void 0===this.boundPointerLabels||this.boundPointerLabels,this.options.mergeRangeLabelsIfSame=void 0!==this.mergeRangeLabelsIfSame&&this.mergeRangeLabelsIfSame,this.options.customTemplateScope=void 0!==this.customTemplateScope?this.customTemplateScope:null,this.options.logScale=void 0!==this.logScale&&this.logScale,this.options.customValueToPosition=void 0!==this.customValueToPosition?this.customValueToPosition:null,this.options.customPositionToValue=void 0!==this.customPositionToValue?this.customPositionToValue:null,this.options.selectionBarGradient=void 0!==this.selectionBarGradient?this.selectionBarGradient:null,this.options.ariaLabel=void 0!==this.ariaLabel?this.ariaLabel:null,this.options.ariaLabelledBy=void 0!==this.ariaLabelledBy?this.ariaLabelledBy:null,this.options.ariaLabelHigh=void 0!==this.ariaLabelHigh?this.ariaLabelHigh:null,this.options.ariaLabelledByHigh=void 0!==this.ariaLabelledByHigh?this.ariaLabelledByHigh:null,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.enableResize=void 0===this.enableResize||this.enableResize,this.actionParams="undefined"!=this.actionParams?this.actionParams:this.apiParams?this.apiParams:{},this.style={},d(function(){a.$broadcast("reCalcViewDimensions"),a.$broadcast("rzSliderForceRender")},2e3)},this.$postLink=function(){i.timeoutId=d(i.resize.bind(i),100),angular.element(c).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null==i.min&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),a.$emit("waiting-for-data"))},this.onResize=function(){null!=i.timeoutId&&d.cancel(i.timeoutId),i.timeoutId=d(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){b.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1},this.$onDestroy=function(){i.msgTag&&f.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&h.cancel(i.refreshTimer),null!=i.timeoutId&&d.cancel(i.timeoutId),angular.element(c).off("resize",i.onResize)};var j=function(b){var c={api:i.api,transport:b,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:a.$id};g.scriptrRequest(c,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=h(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(i.noResults=!0,i.dataFailureMessage="Failed to fetch data.","number"==typeof i.min&&"NaN"!=i.min.toString()&&(i.stalledData=!0,i.dataFailureMessage="Failed to update data.")):("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(i.min=a,i.rollBackData=a,i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,i.min&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format.")):(i.noResults=!0,i.min&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."))},this.publishData=function(a,b,c,d){"function"==typeof i.onEnd()&&i.onEnd()(a,b,c,d),void 0===i.actionApiParams&&(i.actionApiParams={}),a&&(i.actionApiParams.sliderId=a),b&&(i.actionApiParams.minValue=b),c&&(i.actionApiParams.maxValue=c),d&&(i.actionApiParams.pointerType=d);var e={api:i.actionApi?i.actionApi:i.api,transport:i.actionTransport?i.actionTransport:i.transport,apiParams:i.actionApiParams,useWindowParams:i.actionUseWindowParams?i.actionUseWindowParams:i.useWindowParams,httpMethod:i.actionHttpMethod?i.actionHttpMethod:i.httpMehtod};g.scriptrRequest(e,i.onSlideCallback.bind(i))},i.onSlideCallback=function(a,b){a.status&&"failure"==a.status?(i.actionSuccess=!1,i.min=i.rollBackData,i.actionMessage=a.errorDetail||"Slide action failed."):(i.actionSuccess=!0,i.rollBackData=i.min,i.actionMessage=a.successMessage||"Slide action succeeded."),d(function(){i.actionSuccess=null,i.actionMessage=null},5e3)}}]}),angular.module("Button",["ngAnimate","angularPromiseButtons","ui.bootstrap","ComponentsCommon","DataService"]),angular.module("Button").component("scriptrButton",{bindings:{size:"@",isDisabled:"<?",label:"@",type:"@",onButtonclick:"&",onSuccess:"&",onFailure:"&",icon:"@",loadingMessage:"@",data:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",actionTransport:"@",actionApi:"@",actionApiParams:"<?",actionUseWindowParams:"@",actionHttpMethod:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/button/button.html",controller:["$scope","$q","$element","$window","$timeout","httpClient","wsClient","dataService","$interval",function(a,b,c,d,e,f,g,h,i){var j=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/button-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=null!=this.label&&""!=this.label,this.label&&!this.data?this.data={label:this.label}:this.data&&this.data.label&&(this.label=null),this.transport=this.transport?this.transport:null,this.actionParams="undefined"!=this.actionParams?this.actionParams:this.apiParams?this.apiParams:{},this.msgTag=this.msgTag?this.msgTag:null,this.type=this.type?this.type:"btn-success",this.class=this.type,this.style={}},this.$postLink=function(){j.timeoutId=e(j.resize.bind(j),100),angular.element(d).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null!=j.label&&""!=j.label||(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),a.$emit("waiting-for-data"))},this.onResize=function(){null!=j.timeoutId&&e.cancel(j.timeoutId),j.timeoutId=e(j.resize.bind(j),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){c.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1};var k=function(b){var c={api:j.api,transport:b,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:a.$id};h.scriptrRequest(c,j.consumeData.bind(j)),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=i(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.$onDestroy=function(){j.msgTag&&g.unsubscribe(j.msgTag,null,a.$id),j.refreshTimer&&i.cancel(j.refreshTimer),null!=j.timeoutId&&e.cancel(j.timeoutId),angular.element(d).off("resize",j.onResize)},this.consumeData=function(a,b){a&&a.status&&"failure"==a.status?(j.noResults=!0,j.dataFailureMessage="Failed to load button label.",j.label&&(j.stalledData=!0,j.dataFailureMessage="Failed to update button label.")):("function"==typeof j.onFormatData()&&(a=j.onFormatData()(a,j)),null!=a&&"object"==typeof a&&a.hasOwnProperty("label")?(j.label=a.label,j.hasData=!0,j.noResults=!1,j.stalledData=!1):(j.noResults=!0,null!=j.label&&""!=j.label&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format."))},j.click=function(a){if("function"==typeof this.onButtonclick()&&j.onButtonclick()(j),!j.isDisabled){var b={api:j.actionApi?j.actionApi:j.api,transport:j.actionTransport?j.actionTransport:j.transport,apiParams:j.actionApiParams,useWindowParams:j.actionUseWindowParams?j.actionUseWindowParams:j.useWindowParams,httpMethod:j.actionHttpMethod?j.actionHttpMethod:j.httpMehtod};h.scriptrRequest(b,j.onClickCallback.bind(j))}},j.onClickCallback=function(a,b){a.status&&"failure"==a.status?(j.actionSuccess=!1,j.actionMessage=a.errorDetail||"Click action failed."):(j.actionSuccess=!0,j.actionMessage=a.successMessage||"Click action succeeded."),e(function(){j.actionSuccess=null,j.actionMessage=null},1e4)}}]}),angular.module("IFrame",[]),angular.module("IFrame").component("scriptrIframe",{bindings:{link:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/IFrame/IFrame.html",controller:["$scope","$sce","$q","$element","$window","$timeout",function(a,b,c,d,e,f){this.$onInit=function(){},this.$postLink=function(){},this.trustSrc=function(a){return b.trustAsResourceUrl(a)}}]}),angular.module("Accelerometer",["ComponentsCommon","DataService"]),angular.module("Accelerometer").component("scriptrAccelerometer",{bindings:{data:"<?",icon:"@",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/accelerometer/accelerometer.html",controller:["httpClient","wsClient","$scope","$interval","$window","$element","dataService","$timeout",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/accelerometer-bg.svg",this.hasData=!(isNaN(i.xLine)||!isFinite(i.xLine)||isNaN(i.yLine)||!isFinite(i.yLine)||isNaN(i.zLine)||!isFinite(i.zLine)),this.useWindowParams=this.useWindowParams?this.useWindowParams:"true"},this.$postLink=function(){i.timeoutId=h(i.resize.bind(i),100),angular.element(e).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?c.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(c.$on("update-data",function(a,b){null==b?null==i.xLine&&null==i.yLine&&null==i.zLine&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),c.$emit("waiting-for-data"))},this.onResize=function(){null!=i.timeoutId&&h.cancel(i.timeoutId),i.timeoutId=h(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){f.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1};var j=function(a){var b={api:i.api,transport:a,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:c.$id};g.scriptrRequest(b,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=d(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.$onDestroy=function(){i.msgTag&&b.unsubscribe(i.msgTag,null,c.$id),i.refreshTimer&&d.cancel(i.refreshTimer),null!=i.timeoutId&&h.cancel(i.timeoutId),angular.element(e).off("resize",i.onResize)},this.consumeData=function(a,b){if(a.status&&"failure"==a.status)i.noResults=!0,i.dataFailureMessage="Failure to fetch data.",i.xLine&&this.yLine&&this.angle&&(i.stalledData=!0,i.dataFailureMessage="Failure to update data.");else if("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a){var c=parseFloat(a.x),d=parseFloat(a.y),e=parseFloat(a.z);a&&!isNaN(c)&&isFinite(c)&&!isNaN(d)&&isFinite(d)&&!isNaN(e)&&isFinite(e)?(a.x=a.x>20?20:a.x<-20?-20:a.x,a.y=a.y>20?20:a.y<-20?-20:a.y,i.xLine="scaleX("+Math.round(c)+")",i.yLine="scaleY("+Math.round(d)+")",i.angle="rotateZ("+Math.round(e)+"deg )",i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.xLine&&null!=i.yLine&&null!=i.angle&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format.")}else i.noResults=!0,null!=i.xLine&&null!=i.yLine&&null!=i.angle&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."}}]}),angular.module("Display",["ComponentsCommon","DataService"]),angular.module("Display").component("scriptrDisplaycount",{bindings:{widgetLayout:"@",data:"<?",message:"@",borderSize:"@",borderColor:"@",numberFontFamily:"@",numberFontSize:"@",numberCellSize:"@",numberFontWeight:"@",numberTextColor:"@",numberBackgroundColor:"@",numberBackgroundColors:"<?",numberTextAlignment:"@",messageFontFamily:"@",messageFontSize:"@",messageFontWeight:"@",messageTextColor:"@",messageBackgroundColor:"@",messageTextAlignment:"@",icon:"@",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/displayCount/displayCount.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,e,h){var i=this;i.rerenderVal=null,i.isLoading=!1,this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/display-data-bg.svg",this.hasData=null!=this.value&&""!=this.value,this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.widgetLayout="vertical"==this.widgetLayout?this.widgetLayout:"horizontal",this.borderSize=this.borderSize?this.borderSize:"1",this.numberCellSize=this.numberCellSize?this.numberCellSize:"",this.borderColor=this.borderColor?this.borderColor:"#d7d7d7",this.numberFontFamily=this.numberFontFamily?this.numberFontFamily:"Arial",this.numberFontSize=this.numberFontSize?this.numberFontSize:"42",this.numberFontWeight=this.numberFontWeight?this.numberFontWeight:"600",this.numberTextColor=this.numberTextColor?this.numberTextColor:"#ffffff",this.numberTextAlignment=this.numberTextAlignment?this.numberTextAlignment:"center",this.numberBackgroundColor=this.numberBackgroundColor?this.numberBackgroundColor:"#ff8c00",this.messageFontFamily=this.messageFontFamily?this.messageFontFamily:"Arial",this.messageFontSize=this.messageFontSize?this.messageFontSize:"18",this.messageFontWeight=this.messageFontWeight?this.messageFontWeight:"600",this.messageTextColor=this.messageTextColor?this.messageTextColor:"#686868",this.messageBackgroundColor=this.messageBackgroundColor?this.messageBackgroundColor:"white",this.messageTextAlignment=this.messageTextAlignment?this.messageTextAlignment:"center",this.numberStyle={background:this.numberBackgroundColor,"font-family":this.numberFontFamily,"font-weight":this.numberFontWeight,color:this.numberTextColor,"text-align":this.numberTextAlignment},this.rerender(),this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.style={}},this.findBackgroundColor=function(a){var b=null;"string"==typeof a.value&&a.numberBackgroundColors?b=_.find(a.numberBackgroundColors,function(b){return b.value==a.value}):"number"==typeof a.value&&a.numberBackgroundColors&&(b=_.find(a.numberBackgroundColors.slice().reverse(),function(b){return a.value>=b.value})),null!=b&&(i.numberStyle.background=b.color,i.numberBackgroundColor=b.color)},this.rerender=function(){i.rerenderVal=!1,f(function(){i.findBackgroundColor(i),i.rerenderVal=!0},100)},this.$postLink=function(){i.timeoutId=f(i.resize.bind(i),100),angular.element(e).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null==i.value&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),a.$emit("waiting-for-data"))},this.onResize=function(){null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1},this.$onDestroy=function(){i.msgTag&&c.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&g.cancel(i.refreshTimer),null!=i.timeoutId&&f.cancel(i.timeoutId),angular.element(e).off("resize",i.onResize)};var j=function(b){var c={api:i.api,transport:b,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:a.$id};h.scriptrRequest(c,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=g(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(i.noResults=!0,i.dataFailureMessage="Failed to fetch data.",i.value&&(i.stalledData=!0,i.dataFailureMessage="Failed to update data.")):("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a?"object"==typeof a&&null!=a.value?(i.value=a.value,a.message&&(i.message=a.message),i.rerender(),i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.value&&(i.stalledData=!0),
i.dataFailureMessage="Failed to update data, no data returned."):(i.noResults=!0,null!=i.value&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data."))}}]}),angular.module("angularPlotly",[]).directive("angularPlotly",["$window",function(a,b){return{restrict:"E",template:"<div></div>",scope:{plotlyData:"=",plotlyLayout:"=",plotlyOptions:"=",plotlyEvents:"=",plotlyManualDataUpdate:"="},link:function(b,c){function d(a){b.plotlyEvents(a)}function e(){if(!b.plotlyData)return void(h&&(Plotly.Plots.purge(g),g.innerHTML=""));h=!0,Plotly.newPlot(g,b.plotlyData,b.plotlyLayout,b.plotlyOptions),b.plotlyEvents&&d(g)}function f(){if(h&&b.plotlyData){var a=window.getComputedStyle(g).display;if(a&&"none"!==a&&h&&b.plotlyData)try{Plotly.Plots.resize(g)}catch(a){}}}var g=c[0].children[0],h=!1;b.$watch(function(a){return a.plotlyLayout},function(a,b){angular.equals(a,b)&&h||e()},!0),b.plotlyManualDataUpdate||b.$watch(function(a){return a.plotlyData},function(a,b){angular.equals(a,b)&&h||e()},!1),b.$on("tracesUpdated",function(){e()}),b.$watch(function(){return{h:c[0].offsetHeight,w:c[0].offsetWidth}},function(a,b){angular.equals(a,b)||f()},!0),angular.element(a).bind("resize",f)}}}]),angular.module("Plotly",["angularPlotly","ComponentsCommon","DataService"]),angular.module("Plotly").component("scriptrThreeDSurface",{bindings:{onLoad:"&onLoad",data:"<?",options:"<?",layoutConfig:"<?",tracesConfig:"<?",loadingMessage:"@",transport:"@",api:"@",icon:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/3dsurface.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;k.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/3dsurface-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=null!=this.transformedData&&this.transformedData.length>0,k._apiParams=k.apiParams?angular.copy(k.apiParams):[],k.data=k.data?k.data:[],k.contours=k.contours?k.contours:{},k.options=k.options?k.options:{displayModeBar:!1,modeBarButtonsToRemove:[],displaylogo:!1,scrollZoom:!1,staticPlot:!1},angular.element(c).on("resize",k.onResize),k.style={};var a={autosize:!0,title:"3dSurface's Title",scene:{xaxis:{title:"Temperature"},yaxis:{title:"Humidity"},zaxis:{title:"Pressure"}},margin:{l:5,r:5,b:5,t:5}};this._layout=this.layoutConfig?angular.merge({},a,this.layoutConfig):a,this.defaultTrace={type:"surface",showscale:!0,contours:{},colorscale:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],colorbar:{thickness:20,outlinecolor:"#E2E913",bgcolor:"rgba(0,0,0,0)",ticks:"outside",tickcolor:"#C8CE1B",showticklabels:!0,title:{text:"",font:{family:"Times New Roman",size:15,color:"#C8CE1B"},side:"top"}},hoverinfo:"x+y+z",hoverongaps:!1,hoverlabel:{bgcolor:"#C8CE1B"}},this.tracesConfig=this.tracesConfig?this.tracesConfig:{}},k.resize=function(){k._layout.height=d.parent().height(),k._layout.width=d.parent().width(),k.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},k.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?initDataService(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null!=k.transformedData&&0!=k.transformedData.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},k.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&(console.log("timeout inside destroy"),e.cancel(k.timeoutId)),angular.element(c).off("resize",k.onResize)},this.onResize=function(){return null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,100)},initDataService=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){initDataService(k.transport)},1e3*k.fetchDataInterval))},k.consumeData=function(a,b){if(a.status&&"failure"==a.status)k.noResults=!0,k.dataFailureMessage="Failed to fetch data.",k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0,k.dataFailureMessage="Failed to update data.");else if("function"==typeof k.onFormatData()&&(a=k.onFormatData()(a,k)),null!=a)if(k.transformedData=[],"object"==typeof a&&null!=a.x&&Array.isArray(a.x)&&null!=a.y&&Array.isArray(a.y)&&null!=a.z&&Array.isArray(a.z)){var c=k.tracesConfig?angular.merge({},k.defaultTrace,k.tracesConfig):k.defaultTrace;k.transformedData.push(angular.merge({},c,a)),k.hasData=!0,k.noResults=!1,k.stalledData=!1}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format.";else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned."}}]}),angular.module("Plotly").component("scriptrWindrose",{bindings:{onLoad:"&onLoad",data:"<?",customRanges:"<?",layout:"<?",options:"<?",showLegend:"@",speedUnit:"@",fontSize:"@",icon:"@",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/windrose.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.directions=["N","NNE","ENE","E","ESE","SSE","S","SSW","WSW","W","WNW","NNW"],this.speedUnit=this.speedUnit?this.speedUnit:"m/h",this.noResults=!1,this.showSelectStream=!k.api,this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/wind-rose-bg.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=null!=this.transformedData&&this.transformedData.length>0,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.plotCustomRanges=this.customRanges&&this.customRanges.length>0?this.customRanges:[{color:"#CC5464",lo:0,hi:2},{color:"#FCC717",lo:2,hi:4},{color:"#38B9D6",lo:4,hi:6},{color:"#1DBC68",lo:6,hi:8},{color:"#E90088",lo:8,hi:10},{color:"#ffac47",lo:10,hi:20}],this.showLegend=this.showLegend?this.showLegend:"true",this.fontSize=this.fontSize?this.fontSize:"12",this.layout={title:"",font:{size:this.fontSize},radialaxis:{ticksuffix:"%"},orientation:270,margin:{l:25,r:15,b:10,t:10}},this.maxRange=h.max(h.pluck(this.plotCustomRanges,"hi")),this.listOfMinRanges=h.pluck(this.plotCustomRanges,"lo"),this.listOfMaxRanges=h.pluck(this.plotCustomRanges,"hi"),this.listOfColors=h.pluck(this.plotCustomRanges,"color"),this.listOfColors.push("#10c3e0"),this.speedUnit=this.speedUnit?this.speedUnit:"",this.style={}},this.onResize=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize.bind(k),100)},k.resize=function(){if(k.timeoutId=null,c.matchMedia(a.mobileBreakPoint).matches)k.style.height="300";else if(null==k.showLegend||"true"!=k.showLegend){var b=d.parent().innerHeight(),e=d.parent().innerWidth();e<b?k.style.width=e:k.style.height=b}else{var b=d.parent().innerHeight()-10,e=d.parent().innerWidth()-d.find(".plotly-chart-legend").outerWidth(!0)-10;e<b?(k.style.width=e,k.style.height=e):(k.style.height=b,k.style.width=b)}k.layout={title:"",font:{size:k.fontSize},radialaxis:{ticksuffix:"%"},orientation:270,width:k.style.width,height:k.style.height,margin:{l:25,r:15,b:10,t:10}},k.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null!=k.transformedData&&0!=k.transformedData.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&e.cancel(k.timeoutId),angular.element(c).off("resize",k.onResize)};var l=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(a,b){if(a.status&&"failure"==a.status)k.noResults=!0,k.dataFailureMessage="Failed to fetch data.",k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0,k.dataFailureMessage="Failed to update data.");else if("function"==typeof this.onFormatData()&&(a=this.onFormatData()(a)),null!=a)if("object"==typeof a&&Array.isArray(a))if(a.length>0){if(this.fetchDataInterval&&this.fetchDataInterval>0&&this.data&&this.data.length>0&&this.delta)for(var c=0;c<a.length;c++)this.data[c].speeds=this.data[c].speeds.concat(a[c].speeds),this.data[c].dates=this.data[c].dates.concat(a[c].dates);else this.data=a;a.latestDate&&(this.latestRetrievedDataDate=a.latestDate),this.buildWindRoseData(),k.hasData=!0,k.noResults=!1,k.stalledData=!1}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned.";else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format.";else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned."},this.buildWindRoseData=function(){var a=h.pluck(k.data,"speeds");k.totalSpeeds=0;for(var b=0;b<a.length;b++)k.totalSpeeds+=a[b].length;k.speedRangeDirectionObj={};for(var b=0;b<k.listOfMinRanges.length;b++)k.speedRangeDirectionObj[k.listOfMinRanges[b]+"-"+k.listOfMaxRanges[b]]=[];k.speedRangeDirectionObj[">="+k.maxRange]=[];for(var b=0;k.data&&b<k.data.length;b++){for(var c=k.data[b].direction,d=k.data[b].speeds,f=0;f<k.plotCustomRanges.length;f++){var g=this.plotCustomRanges[f],i=h.filter(d,function(a){return a>=g.lo&&a<g.hi}).length;k.speedRangeDirectionObj[k.plotCustomRanges[f].lo+"-"+k.plotCustomRanges[f].hi].push({direction:c,percentage:i/k.totalSpeeds*100})}var j=k.maxRange,l=h.filter(d,function(a){return a>=j}).length;k.speedRangeDirectionObj[">="+k.maxRange].push({direction:c,percentage:l/k.totalSpeeds*100})}for(var m=Object.keys(k.speedRangeDirectionObj),n=Object.keys(k.speedRangeDirectionObj)[0],o=(k.speedRangeDirectionObj[n],JSON.parse(JSON.stringify(k.speedRangeDirectionObj))[n]),b=0;b<m.length;b++){var p=m[b],q=k.speedRangeDirectionObj[p];if(p!=n){for(var f=0;f<q.length;f++)o[f].percentage=q[f].percentage+o[f].percentage,0!=q[f].percentage&&(q[f].percentage=o[f].percentage);k.speedRangeDirectionObj[p]=q}}k.transformedData=[],m=Object.keys(k.speedRangeDirectionObj);for(var b=m.length-1;b>=0;b--){var r=h.pluck(k.speedRangeDirectionObj[m[b]],"percentage"),s=m[b],t=k.listOfColors[b],u={r:r,t:k.directions,name:s+" "+k.speedUnit,marker:{color:t},type:"area",showlegend:!1};k.transformedData.push(u)}e(k.resize,100)}}]}),angular.module("Plotly").component("scriptrHeatmap",{bindings:{onLoad:"&onLoad",type:"@",data:"<?",options:"<?",title:"@",layoutConfig:"<?",showNumbers:"<",loadingMessage:"@",icon:"@",showNumbersFunc:"&",tracesConfig:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/heatmap.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.noResults=!1,k.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/heatMap.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",k.data=k.data?k.data:[],this.hasData=null!=this.transformedData&&this.transformedData.length>0,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.showNumbers=!!this.showNumbers&&this.showNumbers,k.options=k.options?k.options:{displayModeBar:!1,modeBarButtonsToRemove:[],displaylogo:!1,scrollZoom:!1,editable:!1,staticPlot:!1};var a={autosize:!0,title:"Heatmap's Title",annotations:[],xaxis:{showline:!1,title:"The title of xaxis",linecolor:"rgb(204, 204, 204)",ticks:"outside",dtick:10,tickcolor:"rgb(102, 102, 102)"},yaxis:{showline:!0,title:"The title of yaxis",linecolor:"rgb(204, 204, 204)",ticks:"outside",autotick:!1,dtick:0,tickcolor:"rgb(102, 102, 102)"}};this._layout=this.layoutConfig?angular.merge({},a,this.layoutConfig):a,this.defaultTrace={type:"heatmap",showscale:!0,colorscale:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],colorbar:{outlinecolor:"#E2E913",bgcolor:"rgba(0,0,0,0)",ticks:"outside",tickcolor:"#C8CE1B",showticklabels:!0,title:{text:"",font:{family:"Times New Roman",size:15,color:"#C8CE1B"},side:"top"}},hoverinfo:"x+y+z",hoverongaps:!1,hoverlabel:{bgcolor:"#C8CE1B"}},this.tracesConfig=this.tracesConfig?this.tracesConfig:{}},this.onResize=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize.bind(k),100)},k.resize=function(){k._layout.height=d.parent().height(),k._layout.width=d.parent().width(),k.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null!=k.transformedData&&0!=k.transformedData.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&e.cancel(k.timeoutId),angular.element(c).off("resize",k.onResize)};var l=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k))};k.consumeData=function(a,b){if(a.status&&"failure"==a.status)k.noResults=!0,k.dataFailureMessage="Failed to fetch data.",k.transformedData&&k.transformedData.length>0&&(k.dataFailureMessage="Failed to update data.");else if("function"==typeof this.onFormatData()&&(a=this.onFormatData()(a)),null!=a)if(k.transformedData=[],"object"==typeof a&&null!=a.x&&Array.isArray(a.x)&&null!=a.y&&Array.isArray(a.y)&&null!=a.z&&Array.isArray(a.z)){1==k.showNumbers&&k.showNumbersFunc(a);var c=k.tracesConfig?angular.merge({},k.defaultTrace,k.tracesConfig):k.defaultTrace;k.transformedData.push(angular.merge({},c,a)),k.hasData=!0,k.noResults=!1,k.stalledData=!1}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format.";else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned."},this.showNumbersFunc=function(a){if(null!=a)for(var b=0;b<a.y.length;b++)for(var c=0;c<a.x.length;c++){var d=a.z[b][c];if(0!=d)var e="white";else var e="black";var f={xref:"x1",yref:"y1",x:a.x[c],y:a.y[b],text:a.z[b][c],font:{family:"Arial",size:12,color:"rgb(50, 171, 96)"},showarrow:!1,font:{color:e}};k._layout.annotations.push(f)}}}]}),angular.module("Plotly").component("scriptrBubbleChart",{bindings:{onLoad:"&onLoad",type:"@",data:"<?",options:"<?",layoutConfig:"<?",tracesConfig:"<?",icon:"@",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/bubbleChart.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.noResults=!1,k.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/bubble.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",k.data=k.data?k.data:[],this.hasData=null!=this.transformedData&&this.transformedData.length>0,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],k.options=k.options?k.options:{displayModeBar:!1,modeBarButtonsToRemove:[],displaylogo:!1,scrollZoom:!1,editable:!1,staticPlot:!1},this.defaultTrace={type:"scatter",name:"Name of the trace",mode:"markers",hovertemplate:"x: %{x},y:%{y},weight: %{marker.size}",marker:{color:"hsl(0,100,40)"}},this.tracesConfig=this.tracesConfig?this.tracesConfig:[];var a={title:"The title of the graph",showlegend:!1,margin:{l:140,r:40,b:50,t:80},xaxis:{showgrid:!1,showline:!0,title:"The title of xaxis",titlefont:{font:{color:"rgb(204, 204, 204)"}},tickfont:{font:{color:"rgb(102, 102, 102)"}},ticks:"outside"},yaxis:{showgrid:!1,showline:!0,title:"The title of yaxis",titlefont:{font:{color:"rgb(204, 204, 204)"}},tickfont:{font:{color:"rgb(102, 102, 102)"}}},hovermode:"closest",paper_bgcolor:"rgb(254, 247, 234)",plot_bgcolor:"rgb(254, 247, 234)",legend:{font:{size:10},yanchor:"top",y:.99,xanchor:"left",x:.01,orientation:"v"}};this._layout=this.layoutConfig?angular.merge({},a,this.layoutConfig):a},this.onResize=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize.bind(k),100)},k.resize=function(){k._layout.height=d.parent().height(),k._layout.width=d.parent().width(),k.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null!=k.transformedData&&0!=k.transformedData.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&e.cancel(k.timeoutId),angular.element(c).off("resize",k.onResize)};var l=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k))};k.consumeData=function(a,b){if(a.status&&"failure"==a.status)k.noResults=!0,k.dataFailureMessage="Failed to fetch data.",k.transformedData&&k.transformedData.length>0&&(k.dataFailureMessage="Failed to update data.");else if("function"==typeof this.onFormatData()&&(a=this.onFormatData()(a)),null!=a){k.transformedData=[];for(var c=0;c<a.length;c++)if("object"==typeof a&&null!=a[c].x&&Array.isArray(a[c].x)&&null!=a[c].y&&Array.isArray(a[c].y)&&null!=a[c].w&&Array.isArray(a[c].w)){var d=a[c].w,e=k.tracesConfig[c]?angular.merge({},k.defaultTrace,k.tracesConfig[c]):k.defaultTrace;e.marker.size=d,k.transformedData.push(angular.merge({},e,a[c])),k.hasData=!0,k.noResults=!1,k.stalledData=!1}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format."}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned."}}]}),angular.module("Plotly").component("scriptrScatter",{bindings:{onLoad:"&onLoad",data:"<?",type:"@",options:"<?",layoutConfig:"<?",tracesConfig:"<?",icon:"@",loadingMessage:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/scatter.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.noResults=!1,this.showSelectStream=!k.api,this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/bubble.svg",this.loadingMessage=this.loadingMessage?this.loadingMessage:"Waiting for data",this.hasData=null!=this.transformedData&&this.transformedData.length>0,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],k.options=k.options?k.options:{displayModeBar:!0,modeBarButtonsToRemove:[],displaylogo:!0,scrollZoom:!1,editable:!1,staticPlot:!1},this.defaultTrace={type:"scatter",name:"trace1",mode:"markers",hovertemplate:"x: %{x},y:%{y},weight: %{marker.size}",marker:{color:"hsl(0,100,40)"}},this.tracesConfig=this.tracesConfig?this.tracesConfig:[];var a={title:"The title of the graph",showlegend:!0,margin:{l:140,r:40,b:50,t:80},xaxis:{showgrid:!1,showline:!0,range:[.25,8],title:"The title of xaxis",titlefont:{font:{color:"rgb(204, 204, 204)"}},tickfont:{font:{color:"rgb(102, 102, 102)"}},ticks:"outside"},yaxis:{showgrid:!1,showline:!0,range:[0,10],title:"The title of yaxis",titlefont:{font:{color:"rgb(204, 204, 204)"}},tickfont:{font:{color:"rgb(102, 102, 102)"}}},hovermode:"closest",legend:{font:{size:10},yanchor:"top",xanchor:"right",orientation:"v"}};this._layout=this.layoutConfig?angular.merge({},a,this.layoutConfig):a},this.onResize=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize.bind(k),100)},k.resize=function(){k._layout.height=d.parent().height(),k._layout.width=d.parent().width(),k.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null!=k.transformedData&&0!=k.transformedData.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-datas"))},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&e.cancel(k.timeoutId),angular.element(c).off("resize",k.onResize)};var l=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(a,b){if(a.status&&"failure"==a.status)k.noResults=!0,k.dataFailureMessage="Failed to fetch data.",k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0,k.dataFailureMessage="Failed to update data.");else if("function"==typeof k.onFormatData()&&(a=k.onFormatData()(a,k)),null!=a&&a.length>0){k.transformedData=[];for(var c=0;c<a.length;c++)if("object"==typeof a&&null!=a[c].x&&Array.isArray(a[c].x)&&null!=a[c].y&&Array.isArray(a[c].y)&&null!=a[c].w&&Array.isArray(a[c].w)){var d=a[c].w,e=k.tracesConfig[c]?angular.merge({},k.defaultTrace,k.tracesConfig[c]):k.defaultTrace;e.marker.size=d,k.transformedData.push(angular.merge({},e,a[c])),k.hasData=!0,k.noResults=!1,k.stalledData=!1}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format."}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned."}}]}),angular.module("ComponentsCommon",["ui.bootstrap"]),angular.module("ComponentsCommon").component("scriptrNotifications",{bindings:{hasData:"<?",noResults:"<?",stalledData:"<?",usePopover:"<?",loadingMessage:"@",failureMessage:"<?",actionMessage:"<?",actionSuccess:"<?",icon:"<?"},templateUrl:"/UIComponents/dashboard/frontend/components/common/notifications.html",controller:["$translate","$rootScope","$scope",function(a,b,c){this.$onInit=function(){a.use(b.lang)},this.$postLink=function(){}}]}),angular.module("Layout",["ngRoute","underscore","ngAnimate","ngSanitize","ui.bootstrap"]),angular.module("Layout").constant("defaultLogo","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJoAAAAcCAYAAACZFqbSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4QThGRjcwQzA3MjExRTZCMUQyODkwMjQwNUU3QzAyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4QThGRjcxQzA3MjExRTZCMUQyODkwMjQwNUU3QzAyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MzhBOEZGNkVDMDcyMTFFNkIxRDI4OTAyNDA1RTdDMDIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzhBOEZGNkZDMDcyMTFFNkIxRDI4OTAyNDA1RTdDMDIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4xscdBAAAFRElEQVR42uxb3XXiSgw2Oft+fTtwKlhTQaACnAouVLDwmCfgKY9hK4BbQejApAK8FeCtINwKuFL2M2d2ovkzTgJZ65yJ+TGypNFInzSTzuFwiFpq6a3pC//pdDp/tBFosfXokqufdf50ozRr3+iqNcPZT1JC4/nwi5aXqkfraOdPGY0Yr4cXnTpbikoa8zOVLdbTPGX1TetoF0g0cexos9YS7+xojAvowqOnfMyrqMSk1MEaKV1S8GXa0yiaXJ2Qu4dnsJybuvI2WGSkSlTaQOf9meLBGPZLMT9sv6KxikA1DI38YKctwOkznMfFf0Zj5+C5VHgODTxEUgDz0nDLg0UuG81cC8eg1xa8nx36JhbeQ8fvTbST5oQ+yyz8eM5jtpPhnkc4oBfd399nNHY0Drhmv1WdmOBci2ISVSs0BlC1VUtbejlVopiJhgrPf4TvpzZHpsvOApTHBmebnrhGTXql+C526LuVFhXowfF7EyWGOflm4TeA/caGezK99eOgpWKXBO9/ORpWV53S+cYSgnMYvQnaOCY88nBknU5NCT8aAPkc2bKGZSsD+Y09nDr1jGaJwCtW2xu6smsatx0Qvf6b39NYeSrwIKz2BY2uwvOaxshgGJ1uce/c4XTMawT+ahW5Eu7tKzznoVUnPWIGueYGHRjjTFhPxYaSvkshNdn0XWkyq4PtuxJknSiyrixq7XFPNd/7EMe/u7srhXuLI0YT8IoRQ2gYLjOkTJWsWA74QMUGuQfmE7GYPmGQxTuqhmA0i00qnROLvlsfHGnQt3dKGAUmO/hgMcga9DyKajGNMY0ZrvELlIajpRaAmUOIGUBlDGFTgyJj7fdjD+VVIP8Y6GjPhvRTZxKacrSeqzrWQfwHO9o4ekNiH6v2Ogt6szJgmZ6QXteWVPNVCPUu4tD+U0mxIdT9yBaGhIdcLRuWl+y9VmyafKC8DJHW79ZHo4eNSPmfqPpcirOBeGX0hT5LohnV2TPCPbUapmfmZJdI79LTu9KaiwuaOAbpXQWMrgBI90I18egSPKQH80kodaVywI7MUSl+KvoCxbdVN5hedxGlCglbwLkqfJYIe29PmhHHvtEKzr5vrBv9ccSYM5JSEpwsF6r8iycC/qnQweBAVV5pfZKXKGWqmJCmXE6gG23qApsAxzkmYBsCxM+UKjtWuwRDXHmRbrVe0z6wtRJbbFjtsOxCqu0GiRvDU2XcoOUh7nWygCxogZT5nwLye4KipQB0F4hkx74afTaFkz4pn/+F5+mV1I1iQF4hS4uBTUeEF+gfRUIqf4zcOyBTyKzDglEAeE4dzU7m13fg2EKIloyjfyjzkmrYOMZE3yJo5BbcnRtMuEGhEILhMt1WR7+otgtrerBtMk/ZGThWQoh0tUp66ZSsdJo2kHijua+3NxQZ95Hf9lEBp3XCBLQ/QivTOTeVkR3qbrf1fQ898J6mhtknFM0WVXvjqiYYfel6S05WVZE0ujVaFaVQbtfFa/s3qrIKj++voXspPHsNB+sGYNHbgDkqwX92ov1C/WKg2qByMr290UfY22DlDHBVj7gUeDCnvpVn22JC3vwdvAfglWqKVLjvSUpJ4PEUGB1LE8BGz/A6+v3kakiPbO2hNz9/gnEyQWZeuENlbhJhXl4d62F58dsscJGuA1tHKv/RKx1QHbXdpBNIS52vUutnJy1tzimazTT7tP8z0FIjVBVvpe5keupsqV4kU8/mHSs+dT/yEs/316AK2kxsxmo9pp6TDT1PveatrdrUeQoNPO/rtaZq/6/zFPrXs1WyaE0VRf8LMAAs4IRPCpl8ygAAAABJRU5ErkJggg==").component("headerTop",{bindings:{headerItems:"<headerItems",class:"@",user:"<?",onHeaderItemClick:"&"},templateUrl:"/UIComponents/layout/frontend/components/header/header.html",controller:["$scope","$route","defaultLogo",function(a,b,c){var d=this;this.$onInit=function(){b.current&&b.current.$$route&&(this.currentRoute="#"+b.current.$$route.originalPath),this.logout=this.headerItems&&this.headerItems.logout?this.headerItems.logout:null,this.appname=this.headerItems&&this.headerItems.appname?this.headerItems.appname:"",this.logo=this.headerItems&&this.headerItems.logo?this.headerItems.logo:c,this.user=this.user?this.user:null,this.items=this.headerItems&&this.headerItems.items?this.headerItems.items:null,this.subitems=this.headerItems&&this.headerItems.subitems?this.headerItems.subitems:null,this.caretlabel=this.headerItems&&this.headerItems.caretlabel?this.headerItems.caretlabel:null,a.$on("$routeChangeStart",function(a,b,c){console.log("next",b),b&&b.$$route&&""!=b.$$route.originalPath?(console.log("current",b.$$route),d.currentRoute="#"+b.$$route.originalPath):console.log("Missing route definition")})},this.onItemClick=function(a){"function"==typeof d.onHeaderItemClick(a)&&d.onHeaderItemClick()(a)},d.addSelectedClass=function(a){for(var b=document.getElementsByTagName("a"),c=0;c<b.length;c++)b[c].getAttribute("index")==a?b[c].className=b[c].className="selected":b[c].className=b[c].className=""},this.inGroup=function(a){if(!a||0==a.length)return!0;if(a&&a.length>0&&(!d.user||d.user&&!d.user.groups))return!1;var b=d.user.groups;null==d.user.groups?b=[]:"string"==typeof d.user.groups&&(b=[d.user.groups]);var c=!1;if(a){for(var e=0;e<a.length;e++)if(b.indexOf(a[e])>-1){c=!0;break}}else c=!0;return c},d.checkIfSelected=function(a){for(var b=0;b<a.length;b++)if(a[b].route==d.currentRoute)return!0;return!1}}]}),angular.module("Layout").component("menu",{bindings:{menuItems:"<menuItems",user:"<?",onMenuItemClick:"&"},templateUrl:"/UIComponents/layout/frontend/components/menu/menu.html",controller:["$scope","_","$timeout","$location","$route",function(a,b,c,d,e){var f=this;this.collaspsedCols=[],this.$onInit=function(){this.initializeDefaultMenu(),e.current&&e.current.$$route?this.currentRoute="#"+e.current.$$route.originalPath:this.currentRoute=this.menuItems[this.menuItems.mainMenu][0].route,a.$on("$routeChangeStart",function(a,b,c){console.log("next",b),b&&b.$$route?(console.log("current",b.$$route),f.currentRoute="#"+b.$$route.originalPath):console.log("Missing route definition")})},this.$postLink=function(){a.$watch(function(a){if(a.$ctrl.currentRoute)return a.$ctrl.currentRoute},function(a){a&&("#/"==a&&(f.currentRoute=this.menuItems[this.menuItems.mainMenu][0].route),f.openMenuBasedOnRoute())})},this.openMenuBasedOnRoute=function(){for(menu in this.menuItems)if("mainMenu"!=menu)for(var a=0;a<=this.menuItems[menu].length;a++)for(row in this.menuItems[menu][a])if(this.menuItems[menu][a].route==f.currentRoute)return this.menuItems[menu][a].active="true",void this.route(this.menuItems[menu][a],null,menu,null,null,!0)},this.inGroup=function(a){if(f.user&&f.user.groups){var b=f.user.groups;null==f.user.groups?b=[]:"string"==typeof f.user.groups&&(b=[f.user.groups]);var c=!1;if(a){
for(var d=0;d<a.length;d++)if(b.indexOf(a[d])>-1){c=!0;break}}else c=!0;return c}},this.route=function(a,b,c,d,e,g){"function"==typeof f.onMenuItemClick()&&f.onMenuItemClick()(a);var h=!1;if(g){this.collaspsedCols=[],this.getPreviousCollapsedCols(c),this.collaspsedCols.push(c),this.collaspsedCols.sort(),this.initializeDefaultMenu();for(var i=0;i<this.collaspsedCols.length;i++)this.collaspsedCols[i]!=this.menuItems.mainMenu&&this.collaspsedCols[i]!=this.cols[i].key&&this.cols.push({key:this.collaspsedCols[i],class:"md"});this.modifyColClasses(),this.addActiveClass(this.cols.length-1,this.getSelectedRowInCol(this.cols[this.cols.length-1].key))}else if(void 0!=typeof a.sub&&null!=a.sub){this.cols=this.cols.splice(0,d+1);for(var j=0;j<this.cols.length;j++)this.cols[j].key==a.sub&&(h=!0);h||this.cols.push({key:a.sub,class:"md"}),this.modifyColClasses(),this.addActiveClass(d,e)}else this.cols=this.cols.splice(0,d+1),this.modifyColClasses(),this.addActiveClass(d,e)},this.initializeDefaultMenu=function(){this.cols=[],this.cols.push({key:this.menuItems.mainMenu,class:"md"})},this.getSelectedRowInCol=function(a){for(var b=0;b<this.menuItems[a].length;b++)if(this.menuItems[a][b].route==f.currentRoute)return b},this.getPreviousCollapsedCols=function(a){for(menu in this.menuItems)if("mainMenu"!=menu)for(var b=0;b<=this.menuItems[menu].length;b++)for(row in this.menuItems[menu][b])if(this.menuItems[menu][b].sub==a){menu!=this.menuItems.mainMenu&&this.collaspsedCols.push(menu),this.getPreviousCollapsedCols(menu);break}},this.modifyColClasses=function(){for(var a=0;a<this.cols.length;a++)a==this.cols.length-1?this.cols[a].class="md":this.cols[a].class="sm"},this.addActiveClass=function(a,b){var c=document.getElementById(a);if(c)for(var d=c.getElementsByTagName("li"),e=0;e<d.length;e++)d[e].getAttribute("index")==b.toString()?d[e].className="active":d[e].className=""}}]}),angular.module("DateTimePicker",["ui.bootstrap.datetimepicker","ui.dateTimeInput"]),angular.module("DateTimePicker").component("scriptrDateTimePicker",{bindings:{type:"@",config:"<?",dateHelper:"<?",date:"<?",startDateConfig:"<?",endDateConfig:"<?",startDateLabel:"@",endDateLabel:"@",onSetTime:"&",startDateClass:"@",icon:"@",endDateClass:"@",startDateOnSetTime:"&",endDateOnSetTime:"&",widgetLayout:"@",dateRangeEnd:"<?",dateRangeStart:"<?"},templateUrl:"/UIComponents/dashboard/frontend/components/datetimepicker/datetimepicker.html",controller:["$scope","$log",function(a,b){function c(){"function"==typeof j.onSetTime()&&(data=j.onSetTime()(j.date))}function d(){return moment.locale()}function e(a){moment.locale(a)}function f(){a.$broadcast("start-date-changed"),"function"==typeof j.startDateOnSetTime()&&(data=j.startDateOnSetTime()(j.dateRangeStart))}function g(){a.$broadcast("end-date-changed"),"function"==typeof j.endDateOnSetTime()&&(data=j.endDateOnSetTime()(j.dateRangeEnd))}function h(a){if(j.dateRangeEnd){var b=moment(j.dateRangeEnd);a.filter(function(a){return a.localDateValue()>=b.valueOf()}).forEach(function(a){a.selectable=!1})}}function i(a,b){if(j.dateRangeStart){var c=moment(j.dateRangeStart).subtract(1,a).add(1,"minute");b.filter(function(a){return a.localDateValue()<=c.valueOf()}).forEach(function(a){a.selectable=!1})}}var j=this;this.configuration={};var k;a.controllerName="demoController",a.endDateBeforeRender=i,a.endDateOnSetTime=g,a.onSetTime=c,a.getLocale=d,a.setLocale=e,a.startDateBeforeRender=h,a.startDateOnSetTime=f,this.$onInit=function(){this.configuration=this.config?this.config:{dropdownSelector:"#dropdown",startView:"day",minView:"day"},this._layout=this.widgetLayout?this.widgetLayout:"vertical","range"!=this.type?void 0!==this.config&&(this.configuration.dropdownSelector="#dropdown"):(this.startConfig=this.startDateConfig?this.startDateConfig:{dropdownSelector:"#dropdownStart",renderOn:"end-date-changed",startView:"day",minView:"day"},this.endConfig=this.endDateConfig?this.endDateConfig:{dropdownSelector:"#dropdownEnd",renderOn:"start-date-changed",startView:"day",minView:"day"},void 0!==this.startDateConfig&&(this.startConfig.dropdownSelector="#dropdownStart",this.startConfig.renderOn="end-date-changed"),void 0!==this.endDateConfig&&(this.endConfig.dropdownSelector="#dropdownEnd",this.endConfig.renderOn="start-date-changed")),null!=this.dateHelper&&angular.isObject(this.dateHelper)&&(k=this.dateHelper,k.getDate=j.getDate,k.getDateRangeStart=j.getDateRangeStart,k.getDateRangeEnd=j.getDateRangeEnd)},moment.locale("en"),j.getDate=function(){return console.log(j.date),j.date},j.getDateRangeStart=function(){return console.log(j.dateRangeStart),j.dateRangeStart},j.getDateRangeEnd=function(){return console.log(j.dateRangeEnd),j.dateRangeEnd}}]}),function(a,b){"use strict";if("undefined"!=typeof module&&module.exports){b("undefined"==typeof angular?require("angular"):angular,"undefined"==typeof moment?require("moment"):moment),module.exports="ui.bootstrap.datetimepicker"}else"function"==typeof define&&define.amd?define(["angular","moment"],b):b(a.angular,a.moment)}(this,function(a,b){"use strict";function c(){return function(c,d,e){function f(b){return function(c){return a.isUndefined(c)||""===c||null===c?null:b(c)}}function g(a){return h(a).toDate()}function h(a){return b(a,d,b.locale(),e)}function i(a){return b.utc(a,d,b.locale(),e).valueOf()}var j;switch(c){case"Date":j=f(g);break;case"moment":j=f(h);break;case"milliseconds":j=f(i);break;default:j=f(function(a){return function(b){return h(b).format(a)}}(c))}return j}}function d(c){function d(d,e,f,g){function h(a,b,c){return-1===["Date","moment","milliseconds",void 0].indexOf(a)&&c.indexOf(a)===b}function i(c,d){return!(!a.isUndefined(d)&&""!==d&&null!==d)||b(d,o,b.locale(),m).isValid()}function j(c){return a.isUndefined(c)||""===c||null===c?null:a.isDate(c)?b(c).format(l):a.isNumber(c)?b.utc(c).format(l):b(c,p,b.locale(),m).format(l)}function k(){function a(){return!0}function b(a,b){return b(a)}g.$viewValue=g.$formatters.filter(a).reverse().reduce(b,g.$modelValue),g.$render()}if(a.isDefined(d.dateFormats)&&!a.isString(d.dateFormats)&&!a.isArray(d.dateFormats))throw new Error("date-formats must be a single string or an array of strings i.e. date-formats=\"['YYYY-MM-DD']\" ");if(a.isDefined(f.modelType)&&(!a.isString(f.modelType)||0===f.modelType.length))throw new Error('model-type must be "Date", "moment", "milliseconds", or a moment format string');var l=f.dateTimeInput||b.defaultFormat,m=void 0===f.dateParseStrict||"true"===f.dateParseStrict,n=f.modelType||"Date",o=[f.dateTimeInput,n].concat(d.dateFormats).concat([b.ISO_8601]).filter(h),p=[n].concat(o).filter(h);g.$parsers.unshift(c(n,o,m)),g.$formatters.push(j),g.$validators.dateTimeInput=i,e.bind("blur",k)}return{require:"ngModel",restrict:"A",scope:{dateFormats:"="},link:d}}a.module("ui.dateTimeInput",[]).service("dateTimeParserFactory",c).directive("dateTimeInput",d),c.$inject=[],d.$inject=["dateTimeParserFactory"]}),angular.module("Imagemap",["ui-leaflet","ComponentsCommon","DataService","schemaForm","angular-underscore/filters","pascalprecht.translate"]),angular.module("Imagemap").constant("zoneDetails",{form:[{type:"section",htmlClass:"col-xs-12",items:[{key:"identifier",validationMessage:{unique:"Identifier already taken"},$validators:{unique:function(a,b,c,d){return-1==c.inUseIdentifiers.indexOf(a)}}}]}],schema:{type:"object",title:"Schema",properties:{identifier:{title:"Identifier",type:"string"}},required:[]}}).component("scriptrImagemap",{bindings:{onLoad:"&onLoad",msgTag:"@",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",heatmap:"<?",data:"<?",width:"@",height:"@",loadingMessage:"@",minZoom:"@",maxZoom:"@",imageUrl:"@",imageRatio:"@",heatmapOptions:"<?",markersData:"<?",volatileMarkers:"@",showMarkers:"<?",markersConfig:"<?",enableDrag:"<?",dragConfig:"<?",enableDraw:"<?",drawConfig:"<?"},templateUrl:"/UIComponents/dashboard/frontend/components/imagemap/imagemap.html",controller:["$scope","httpClient","wsClient","$interval","dataService","$timeout","$window","$element","leafletData","leafletBoundsHelpers","leafletLayerHelpers","leafletControlHelpers","$uibModal","zoneDetails",function(a,b,c,d,f,g,h,i,j,k,l,m,n,o){var p=this;p.$onInit=function(){if(p.msgTag=p.msgTag?p.msgTag:null,p.useWindowParams=p.useWindowParams?p.useWindowParams:"true",p.icon=p.icon?p.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/imagemap-bg.svg",p.loadingMessage=p.loadingMessage?p.loadingMessage:"Waiting for data",p.heatmap=!!p.heatmap&&p.heatmap,p.cw=i.parent().width(),p.ch=i.parent().height(),p.minZoom=p.minZoom?parseInt(p.minZoom):0,p.maxZoom=p.maxZoom?parseInt(p.maxZoom):3,p.imageRatio=p.imageRatio?parseFloat(p.imageRatio):1,p.width=p.width?parseInt(p.width)*p.imageRatio:500,p.height=p.height?parseInt(p.height)*p.imageRatio:500,p.zonesList=[],p.zonesIncrement=0,p.editedZoneId="",p.id="imagemap-"+a.$id,p.markersData){p.markers={};for(var b=0;b<p.markersData.length;b++){var c=p.markersData[b],d=p.data[c.key]?p.data[c.key]:null,c=p.markersData[b],e={lat:c.lat*p.imageRatio,lng:c.lng*p.imageRatio,icon:{className:"custom-div-icon",type:"div",html:"<div class='marker-pin'><div class='marker-content'><span class='indicator-value'>"+(d||"?")+"</span></div></div>",iconAnchor:[0,0],popupAnchor:[15,-30]}};!c.draggable||"true"!=c.draggable&&1!=c.draggable||(e.draggable=!0),c.group&&(e.group=c.group),c.icon&&c.icon.url&&(e.icon.iconUrl=c.icon.url),c.icon&&c.icon.unit&&(e.icon.unit=c.icon.unit),c.class&&(e.class=c.class),e.icon.html=p.buildMarkerHtml(e,d),p.markers[c.key]=e}}if(setTimeout(function(){j.getMap(p.id).then(function(a){a.invalidateSize(!1)})},1e3),a.$on("leafletDirectiveMarker."+p.id+".dragend",function(a,b){console.log(b.leafletObject._latlng)}),p.defaults={crs:L.CRS.Simple,maxZoom:p.maxZoom},p.center={lat:0,lng:0,zoom:p.minZoom},p.imageUrl=p.imageUrl?p.imageUrl:"//s3.amazonaws.com/scriptr-cdn/compagno/HVAC-system-7.png",p.layers={baselayers:{myLayer:{name:"Base Layer",type:"imageOverlay",url:p.imageUrl,bounds:[[p.height,0],[0,p.width]],layerParams:{showOnSelector:!1,noWrap:!0}}}},p.layers.overlays={},p.heatmap){var f={minOpacity:.05,maxZoom:0,radius:30,blur:15,max:1,gradient:{.1:"blue",.6:"lime",1:"red"}},g=p.heatmapOptions?_.extend(f,p.heatmapOptions):f;p.heatLayerInfo={name:"Heat Map",type:"heat",layerOptions:g,visible:!0}}p.maxBounds=k.createBoundsFromArray([[p.height,0],[0,p.width]])},p.$postLink=function(){p.timeoutId=g(p.resize.bind(p),100),angular.element(h).on("resize",p.onResize),p.enableDraw&&p.initDrawDataService(),p.showMarkers?p.initDataService():null!=p.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&p.consumeData(a)},!0):(a.$on("update-data",function(a,b){null==b||(b[p.serviceTag]?p.consumeData(b[p.serviceTag]):p.consumeData(b))}),a.$emit("waiting-for-data"))},p.saveAllZones=function(a){for(var b=p.drawnItems.getLayers(),c=[],d=0;d<b.length;d++){var e=b[d],f=e.toGeoJSON(),g={type:f.geometry.type,coordinates:f.geometry.coordinates};c[e.getElement().getAttribute("identifier")]=g}p.updateDrawDataService(c)},p.onResize=function(){null!=p.timeoutId&&g.cancel(p.timeoutId),p.timeoutId=g(p.resize.bind(p),100)},p.resize=function(){p.cw=i.parent().width(),p.ch=i.parent().height(),p.calculateNotificationsDisplay()},p.calculateNotificationsDisplay=function(){i.parent()&&i.parent().innerWidth()<240?p.usePopover=!0:p.usePopover=!1},p.$onDestroy=function(){p.msgTag&&c.unsubscribe(p.msgTag,null,a.$id),p.refreshTimer&&d.cancel(p.refreshTimer),null!=p.timeoutId&&g.cancel(p.timeoutId),angular.element(h).off("resize",p.onResize)},p.updateMarker=function(b,c,d){if(p.enableDrag){var e={api:p.dragConfig.dragApi,transport:p.dragConfig.dragApiTransport,msgTag:p.msgTag,apiParams:angular.merge({xAxis:c,yAxis:d,id:b},p.dragConfig.dragApiParams),useWindowParams:p.useWindowParams,httpMethod:p.dragConfig.dragApiHttpMethod,widgetId:a.$id};f.scriptrRequest(e)}},p.updateDrawDataService=function(b){var c={api:p.drawConfig.updateZonesApi,transport:p.drawConfig.updateZonesApiTransport,msgTag:p.msgTag,apiParams:angular.merge(b,p.drawConfig.updateZonesApiParams),useWindowParams:p.useWindowParams,httpMethod:p.drawConfig.updateZonesApiHttpMethod,widgetId:a.$id};f.scriptrRequest(c,p.consumeUpdateDrawData.bind(p))},p.initDrawDataService=function(){var b={api:p.drawConfig.getZonesApi,transport:p.drawConfig.getZonesApiTransport,msgTag:p.msgTag,apiParams:p.drawConfig.getZonesApiParams,useWindowParams:p.useWindowParams,httpMethod:p.drawConfig.getZonesApiHttpMethod,widgetId:a.$id};f.scriptrRequest(b,p.consumeDrawData.bind(p))},p.buildMarkerHtml=function(a,b){var c="<div class='"+(a.class?a.class:"")+" marker-pin'><div class='marker-content'>";return a.icon&&a.icon.iconUrl&&(c+="<img class='markerImg' src='"+a.icon.iconUrl+"'/>"),c+="<span class='indicator-value'>"+(b||"?")+(a.icon&&a.icon.unit?"<br/>("+a.icon.unit+")":"")+"</span>",c+="</div></div>"},p.initDataService=function(){var b={api:p.markersConfig.markersApi,transport:p.markersConfig.markersApiTransport,msgTag:p.msgTag,apiParams:p.markersConfig.markersApiParams,useWindowParams:p.useWindowParams,httpMethod:p.markersConfig.markersApiHttpMethod,widgetId:a.$id};f.scriptrRequest(b,p.consumeData.bind(p)),p.fetchDataInterval&&!p.refreshTimer&&(p.refreshTimer=d(function(){p.initDataService()},1e3*p.fetchDataInterval))},p.consumeUpdateDrawData=function(a){},p.openModal=function(b){n.open({animation:!0,component:"mapModalComponent",size:"md",scope:a,resolve:{widget:function(){return{label:"Zone Properties",model:b,schema:angular.copy(o.schema),form:angular.copy(o.form)}}}}).result.then(function(a){if("cancel"!=a)for(var b=0;b<p.zonesList.length;b++)if(p.zonesList[b].id==p.editedZoneId){var c=p.zonesList[b].id;p.zonesList[b].id=a.identifier;for(var d=p.drawnItems.getLayers(),e=0;e<d.length;e++)if(null==d[e]._layers&&d[e].getElement().getAttribute("identifier")==c){d[e].getElement().setAttribute("identifier",a.identifier);break}break}},function(){console.info("modal-component for widget update dismissed at: "+new Date)})},p.consumeDrawData=function(a){p.enableDraw&&j.getMap(p.id).then(function(b){p.drawnItems=new L.FeatureGroup;for(var c in a){var d=JSON.parse(a[c]),e=new L.GeoJSON(d);d.id=c,p.zonesList.push(d),l.safeAddLayer(b,e),e.getLayers()[0].getElement().setAttribute("identifier",c),e.addEventListener("contextmenu",function(a){var b=a.target.getLayers()[0].getElement().getAttribute("identifier");p.editedZoneId=b;var c={},d=_.pluck(p.zonesList,"id");c.identifier=b,c.inUseIdentifiers=d,p.openModal(c)}),p.drawnItems.addLayer(e.getLayers()[0])}b.addLayer(p.drawnItems);var f=new L.Control.Draw({position:"topright",draw:{polyline:{metric:!0},polygon:{allowIntersection:!1,showArea:!0,drawError:{color:"#b00b00",timeout:1e3},shapeOptions:{color:"#bada55"}},circle:{shapeOptions:{color:"#662d91"}},marker:!1},edit:{featureGroup:p.drawnItems,remove:!0}});b.addControl(f),b.on("draw:deletestop",function(a){}),b.on("draw:deleted",function(a){a.layers.eachLayer(function(a){p.drawnItems.removeLayer(a);var b=a.getElement().getAttribute("identifier");if(null!=b)for(var c=0;c<p.zonesList.length;c++)if(p.zonesList[c].id==b){p.zonesList.splice(c,1);break}})}),b.on("draw:created",function(a){var b=a.layerType,c=a.layer;c.addEventListener("contextmenu",function(a){var b=a.target.getElement().getAttribute("identifier");p.editedZoneId=b;var c={},d=_.pluck(p.zonesList,"id");c.identifier=b,c.inUseIdentifiers=d,p.openModal(c)}),"marker"===b&&c.bindPopup("A popup!"),p.drawnItems.addLayer(c),console.log(".... "+JSON.stringify(c.toGeoJSON()));var d=c.toGeoJSON(),e=_.pluck(p.zonesList,"id");do{p.zonesIncrement++;var f="Zone_"+p.zonesIncrement}while(e.indexOf(f)>-1);d.id=f,p.zonesList.push(d),p.editedZoneId=f,c.getElement().setAttribute("identifier",f);var g={};g.identifier=f,g.inUseIdentifiers=e,p.openModal(g)})})},p.consumeData=function(a,b){if(a.status&&"failure"==a.status)p.noResults=!0,p.dataFailureMessage="Failed to fetch data.";else if("function"==typeof p.onFormatData()&&(a=p.onFormatData()(a,p)),a)if(p.hasData=!0,p.noResults=!1,p.stalledData=!1,p.heatmap)j.getMap(p.id).then(function(b){p.heatLayer&&l.safeRemoveLayer(b,p.heatLayer),_data=_.map(a,function(a){return[a[0]*p.imageRatio,a[1]*p.imageRatio,a[2]]}),p.heatLayerInfo.data=_data,p.heatLayer=l.createLayer(p.heatLayerInfo);try{l.safeAddLayer(b,p.heatLayer)}catch(a){console.error(a),setTimeout(function(){l.safeAddLayer(b,p.heatLayer)},1e3)}});else{var c={};p.markersData=a;for(var d=0;d<p.markersData.length;d++){var f=p.markersData[d],g=f.key,h=f.value,i=Boolean(f.volatile),k=f.draggable,m=f.icon&&f.icon.url?f.icon.url:"",n=f.icon&&f.icon.unit?f.icon.unit:"",o=f.class?f.class:"",q=(f.group,f.lat),r=f.lng,s={};!i&&(i||p.markers&&p.markers[g])?null!=(s=p.markers[g])&&(s.icon.html=p.buildMarkerHtml(s,h)):(null!=q&&null!=r&&(s={lat:q,lng:r,icon:{className:"custom-div-icon",type:"div",html:"<div class='marker-pin'><div class='marker-content'><span class='indicator-value'>"+h+"</span></div></div>",iconSize:[90,90],iconAnchor:[0,0],popupAnchor:[15,-30]}}),!k||"true"!=k&&1!=k||(s.draggable=!0),s.icon.iconUrl=m,s.icon.unit=n,s.icon.class=o,s.icon.html=p.buildMarkerHtml(s,h)),c[f.key]=s}p.markers=c}else p.noResults=!0,p.dataFailureMessage="Failed to update data, invalid data format.",console.log(e)}}]}).component("mapModalComponent",{bindings:{resolve:"<",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/imagemap/modalContent.html",controller:["$scope",function(a){this.$onInit=function(){this.widget=this.resolve.widget,a.$broadcast("schemaFormRedraw"),this.frmGlobalOptions={destroyStrategy:"remove",formDefaults:{feedback:!1}},this.widget&&(this.widget.schema&&(this.schema=angular.copy(this.widget.schema)),this.widget.form&&(this.form=angular.copy(this.widget.form)),this.model=this.widget.model?angular.copy(this.widget.model):{})},this.onSubmit=function(b){a.$broadcast("schemaFormValidate"),b.$valid&&this.close({$value:this.model})},this.onCancel=function(a){this.schema={},this.form={},this.dismiss({$value:"cancel"}),console.log("Dissmissed")}}]});